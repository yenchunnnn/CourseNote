<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Supervised Learning: Classification | Data Scientist with R</title>
  <meta name="description" content="This is a notebook about the data science courses took from the datacamp." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Supervised Learning: Classification | Data Scientist with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a notebook about the data science courses took from the datacamp." />
  <meta name="github-repo" content="yenchunnnn/CourseNote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Supervised Learning: Classification | Data Scientist with R" />
  
  <meta name="twitter:description" content="This is a notebook about the data science courses took from the datacamp." />
  

<meta name="author" content="Yen Chun Chen" />


<meta name="date" content="2024-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="experimental-design.html"/>
<link rel="next" href="supervised-learning-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Scientist with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-arithmetic"><i class="fa fa-check"></i><b>1.1</b> Basic arithmetic</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-data-types"><i class="fa fa-check"></i><b>1.2</b> Basic data types</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vector"><i class="fa fa-check"></i><b>1.3</b> Vector</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#useful-function"><i class="fa fa-check"></i><b>1.3.1</b> Useful function</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---by-brackets-or-names"><i class="fa fa-check"></i><b>1.3.2</b> Selection - by brackets or names</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---by-comparison---operators"><i class="fa fa-check"></i><b>1.3.3</b> Selection - by comparison - operators</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---by-comparison---values"><i class="fa fa-check"></i><b>1.3.4</b> Selection - by comparison - values</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrix"><i class="fa fa-check"></i><b>1.4</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#construct-function"><i class="fa fa-check"></i><b>1.4.1</b> Construct function</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#construct-by-vector"><i class="fa fa-check"></i><b>1.4.2</b> Construct by vector</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#naming-a-matrix"><i class="fa fa-check"></i><b>1.4.3</b> Naming a matrix</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#manipulating---sum-of-each-row-column"><i class="fa fa-check"></i><b>1.4.4</b> Manipulating - sum of each row &amp; column</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#manipulating---add-columns"><i class="fa fa-check"></i><b>1.4.5</b> Manipulating - add columns</a></li>
<li class="chapter" data-level="1.4.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#manipulating---add-rows"><i class="fa fa-check"></i><b>1.4.6</b> Manipulating - add rows</a></li>
<li class="chapter" data-level="1.4.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection-of-matrix-elements"><i class="fa fa-check"></i><b>1.4.7</b> Selection of matrix elements</a></li>
<li class="chapter" data-level="1.4.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#arithmetic---1"><i class="fa fa-check"></i><b>1.4.8</b> Arithmetic - 1</a></li>
<li class="chapter" data-level="1.4.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#arithmetic---2"><i class="fa fa-check"></i><b>1.4.9</b> Arithmetic - 2</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factor"><i class="fa fa-check"></i><b>1.5</b> Factor</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#useful-function-1"><i class="fa fa-check"></i><b>1.5.1</b> Useful function</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#nominal-ordinal-categorical-variable"><i class="fa fa-check"></i><b>1.5.2</b> Nominal &amp; Ordinal categorical variable</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factor-levels"><i class="fa fa-check"></i><b>1.5.3</b> Factor levels</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#summarizing-a-factor"><i class="fa fa-check"></i><b>1.5.4</b> Summarizing a factor</a></li>
<li class="chapter" data-level="1.5.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#ordered-factors"><i class="fa fa-check"></i><b>1.5.5</b> Ordered factors</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frame"><i class="fa fa-check"></i><b>1.6</b> Data Frame</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#quick-look-at-dataset"><i class="fa fa-check"></i><b>1.6.1</b> Quick look at dataset</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-data-frame"><i class="fa fa-check"></i><b>1.6.2</b> Creating a data frame</a></li>
<li class="chapter" data-level="1.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---brackets"><i class="fa fa-check"></i><b>1.6.3</b> Selection - brackets</a></li>
<li class="chapter" data-level="1.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---names"><i class="fa fa-check"></i><b>1.6.4</b> Selection - names</a></li>
<li class="chapter" data-level="1.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection--"><i class="fa fa-check"></i><b>1.6.5</b> Selection - $</a></li>
<li class="chapter" data-level="1.6.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---subset"><i class="fa fa-check"></i><b>1.6.6</b> Selection - subset</a></li>
<li class="chapter" data-level="1.6.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#sorting"><i class="fa fa-check"></i><b>1.6.7</b> Sorting</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#list"><i class="fa fa-check"></i><b>1.7</b> List</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-list"><i class="fa fa-check"></i><b>1.7.1</b> Creating a list</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-named-list"><i class="fa fa-check"></i><b>1.7.2</b> Creating a named list</a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection"><i class="fa fa-check"></i><b>1.7.3</b> Selection</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#bring-it-all-together"><i class="fa fa-check"></i><b>1.8</b> Bring it all together</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intermediate-r.html"><a href="intermediate-r.html"><i class="fa fa-check"></i><b>2</b> Intermediate R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intermediate-r.html"><a href="intermediate-r.html#conditionals-and-control-flow"><i class="fa fa-check"></i><b>2.1</b> Conditionals and Control Flow</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intermediate-r.html"><a href="intermediate-r.html#relational-operators"><i class="fa fa-check"></i><b>2.1.1</b> Relational operators</a></li>
<li class="chapter" data-level="2.1.2" data-path="intermediate-r.html"><a href="intermediate-r.html#conditional-statements"><i class="fa fa-check"></i><b>2.1.2</b> Conditional statements</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intermediate-r.html"><a href="intermediate-r.html#loops"><i class="fa fa-check"></i><b>2.2</b> Loops</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intermediate-r.html"><a href="intermediate-r.html#while-loop"><i class="fa fa-check"></i><b>2.2.1</b> While loop</a></li>
<li class="chapter" data-level="2.2.2" data-path="intermediate-r.html"><a href="intermediate-r.html#for-loop"><i class="fa fa-check"></i><b>2.2.2</b> For loop</a></li>
<li class="chapter" data-level="2.2.3" data-path="intermediate-r.html"><a href="intermediate-r.html#bring-it-all-together-1"><i class="fa fa-check"></i><b>2.2.3</b> Bring it all together</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intermediate-r.html"><a href="intermediate-r.html#function"><i class="fa fa-check"></i><b>2.3</b> Function</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intermediate-r.html"><a href="intermediate-r.html#introduction-to-function"><i class="fa fa-check"></i><b>2.3.1</b> Introduction to function</a></li>
<li class="chapter" data-level="2.3.2" data-path="intermediate-r.html"><a href="intermediate-r.html#writing-functions"><i class="fa fa-check"></i><b>2.3.2</b> Writing functions</a></li>
<li class="chapter" data-level="2.3.3" data-path="intermediate-r.html"><a href="intermediate-r.html#packages"><i class="fa fa-check"></i><b>2.3.3</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intermediate-r.html"><a href="intermediate-r.html#the-apply-family"><i class="fa fa-check"></i><b>2.4</b> The apply family</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intermediate-r.html"><a href="intermediate-r.html#lapply"><i class="fa fa-check"></i><b>2.4.1</b> lapply</a></li>
<li class="chapter" data-level="2.4.2" data-path="intermediate-r.html"><a href="intermediate-r.html#sapply"><i class="fa fa-check"></i><b>2.4.2</b> sapply</a></li>
<li class="chapter" data-level="2.4.3" data-path="intermediate-r.html"><a href="intermediate-r.html#vapply"><i class="fa fa-check"></i><b>2.4.3</b> vapply</a></li>
<li class="chapter" data-level="2.4.4" data-path="intermediate-r.html"><a href="intermediate-r.html#lapply-vs-sapply-vs-vapply"><i class="fa fa-check"></i><b>2.4.4</b> lapply vs sapply vs vapply</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intermediate-r.html"><a href="intermediate-r.html#utilities"><i class="fa fa-check"></i><b>2.5</b> Utilities</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intermediate-r.html"><a href="intermediate-r.html#mathematical-utilities"><i class="fa fa-check"></i><b>2.5.1</b> Mathematical utilities</a></li>
<li class="chapter" data-level="2.5.2" data-path="intermediate-r.html"><a href="intermediate-r.html#data-structures-utilities"><i class="fa fa-check"></i><b>2.5.2</b> Data structures utilities</a></li>
<li class="chapter" data-level="2.5.3" data-path="intermediate-r.html"><a href="intermediate-r.html#regular-expressions"><i class="fa fa-check"></i><b>2.5.3</b> Regular Expressions</a></li>
<li class="chapter" data-level="2.5.4" data-path="intermediate-r.html"><a href="intermediate-r.html#dates-times"><i class="fa fa-check"></i><b>2.5.4</b> Dates &amp; Times</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-wrangling"><i class="fa fa-check"></i><b>3.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#load-dataset"><i class="fa fa-check"></i><b>3.1.1</b> Load dataset</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#filtering"><i class="fa fa-check"></i><b>3.1.2</b> Filtering</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#arrange"><i class="fa fa-check"></i><b>3.1.3</b> Arrange</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#mutate"><i class="fa fa-check"></i><b>3.1.4</b> Mutate</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#subset-df-variable"><i class="fa fa-check"></i><b>3.2.1</b> Subset df variable</a></li>
<li class="chapter" data-level="3.2.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#ggplot-aesthetics"><i class="fa fa-check"></i><b>3.2.2</b> ggplot aesthetics</a></li>
<li class="chapter" data-level="3.2.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#faceting"><i class="fa fa-check"></i><b>3.2.3</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#grouping-summarizing"><i class="fa fa-check"></i><b>3.3</b> Grouping &amp; summarizing</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#summarize"><i class="fa fa-check"></i><b>3.3.1</b> Summarize</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#group-by"><i class="fa fa-check"></i><b>3.3.2</b> Group by</a></li>
<li class="chapter" data-level="3.3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#visualizing-summarized-data"><i class="fa fa-check"></i><b>3.3.3</b> Visualizing summarized data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#types-of-visualizations"><i class="fa fa-check"></i><b>3.4</b> Types of visualizations</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#line-plots"><i class="fa fa-check"></i><b>3.4.1</b> Line plots</a></li>
<li class="chapter" data-level="3.4.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#bar-plots"><i class="fa fa-check"></i><b>3.4.2</b> Bar plots</a></li>
<li class="chapter" data-level="3.4.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#histograms"><i class="fa fa-check"></i><b>3.4.3</b> Histograms</a></li>
<li class="chapter" data-level="3.4.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#box-plots"><i class="fa fa-check"></i><b>3.4.4</b> Box plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#transforming-data"><i class="fa fa-check"></i><b>4.1</b> Transforming Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-manipulation.html"><a href="data-manipulation.html#exploring-data"><i class="fa fa-check"></i><b>4.1.1</b> Exploring data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#aggregating-data"><i class="fa fa-check"></i><b>4.2</b> Aggregating Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-manipulation.html"><a href="data-manipulation.html#count"><i class="fa fa-check"></i><b>4.2.1</b> Count</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manipulation.html"><a href="data-manipulation.html#group_by-summarize-ungroup"><i class="fa fa-check"></i><b>4.2.2</b> group_by, summarize, ungroup</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-manipulation.html"><a href="data-manipulation.html#slice_min-slice_max"><i class="fa fa-check"></i><b>4.2.3</b> slice_min, slice_max</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#selecting-and-transforming-data"><i class="fa fa-check"></i><b>4.3</b> Selecting and Transforming Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-manipulation.html"><a href="data-manipulation.html#select"><i class="fa fa-check"></i><b>4.3.1</b> Select</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-manipulation.html"><a href="data-manipulation.html#rename"><i class="fa fa-check"></i><b>4.3.2</b> Rename</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-manipulation.html"><a href="data-manipulation.html#transmute"><i class="fa fa-check"></i><b>4.3.3</b> Transmute</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#case-study-the-babynames-dataset"><i class="fa fa-check"></i><b>4.4</b> Case Study: The babynames Dataset</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#load-dataset-1"><i class="fa fa-check"></i><b>4.4.1</b> Load dataset</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#exploring-data-1"><i class="fa fa-check"></i><b>4.4.2</b> Exploring data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="joining-data.html"><a href="joining-data.html"><i class="fa fa-check"></i><b>5</b> Joining Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="joining-data.html"><a href="joining-data.html#inner-join"><i class="fa fa-check"></i><b>5.1</b> Inner join</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="joining-data.html"><a href="joining-data.html#join-by-keys"><i class="fa fa-check"></i><b>5.1.1</b> Join by keys</a></li>
<li class="chapter" data-level="5.1.2" data-path="joining-data.html"><a href="joining-data.html#join-with-a-one-to-many-relationship"><i class="fa fa-check"></i><b>5.1.2</b> Join with a one-to-many relationship</a></li>
<li class="chapter" data-level="5.1.3" data-path="joining-data.html"><a href="joining-data.html#join-in-either-direction"><i class="fa fa-check"></i><b>5.1.3</b> Join in either direction</a></li>
<li class="chapter" data-level="5.1.4" data-path="joining-data.html"><a href="joining-data.html#join-three-or-more-tables"><i class="fa fa-check"></i><b>5.1.4</b> Join three or more tables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="joining-data.html"><a href="joining-data.html#left-right-joins"><i class="fa fa-check"></i><b>5.2</b> Left &amp; Right Joins</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="joining-data.html"><a href="joining-data.html#left-join"><i class="fa fa-check"></i><b>5.2.1</b> Left join</a></li>
<li class="chapter" data-level="5.2.2" data-path="joining-data.html"><a href="joining-data.html#right-join"><i class="fa fa-check"></i><b>5.2.2</b> Right join</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="joining-data.html"><a href="joining-data.html#full-semi-anti-joins"><i class="fa fa-check"></i><b>5.3</b> Full, Semi &amp; Anti Joins</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="joining-data.html"><a href="joining-data.html#full-join"><i class="fa fa-check"></i><b>5.3.1</b> Full join</a></li>
<li class="chapter" data-level="5.3.2" data-path="joining-data.html"><a href="joining-data.html#semi-anti-joins"><i class="fa fa-check"></i><b>5.3.2</b> Semi &amp; Anti joins</a></li>
<li class="chapter" data-level="5.3.3" data-path="joining-data.html"><a href="joining-data.html#visualizing-set-differences"><i class="fa fa-check"></i><b>5.3.3</b> Visualizing set differences</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="joining-data.html"><a href="joining-data.html#case-study-joins-on-stack-overflow-data"><i class="fa fa-check"></i><b>5.4</b> Case study: Joins on Stack Overflow Data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="joining-data.html"><a href="joining-data.html#load-dataset-2"><i class="fa fa-check"></i><b>5.4.1</b> Load dataset</a></li>
<li class="chapter" data-level="5.4.2" data-path="joining-data.html"><a href="joining-data.html#stack-overflow-questions"><i class="fa fa-check"></i><b>5.4.2</b> Stack Overflow questions</a></li>
<li class="chapter" data-level="5.4.3" data-path="joining-data.html"><a href="joining-data.html#joining-questions-and-answers"><i class="fa fa-check"></i><b>5.4.3</b> Joining questions and answers</a></li>
<li class="chapter" data-level="5.4.4" data-path="joining-data.html"><a href="joining-data.html#the-bind_rows-verb"><i class="fa fa-check"></i><b>5.4.4</b> The bind_rows verb</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>6</b> Introduction to Statistics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#summary-statistics"><i class="fa fa-check"></i><b>6.1</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-center"><i class="fa fa-check"></i><b>6.1.1</b> Measures of center</a></li>
<li class="chapter" data-level="6.1.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-spread"><i class="fa fa-check"></i><b>6.1.2</b> Measures of spread</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#random-numbers-and-probability"><i class="fa fa-check"></i><b>6.2</b> Random Numbers and Probability</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chances"><i class="fa fa-check"></i><b>6.2.1</b> Chances</a></li>
<li class="chapter" data-level="6.2.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#discrete-distributions"><i class="fa fa-check"></i><b>6.2.2</b> Discrete distributions</a></li>
<li class="chapter" data-level="6.2.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#continuous-distributions"><i class="fa fa-check"></i><b>6.2.3</b> Continuous distributions</a></li>
<li class="chapter" data-level="6.2.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#binomial-distribution"><i class="fa fa-check"></i><b>6.2.4</b> Binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#more-distributions-central-limit-theorem"><i class="fa fa-check"></i><b>6.3</b> More Distributions &amp; Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#normal-distribution"><i class="fa fa-check"></i><b>6.3.1</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>6.3.2</b> Central limit theorem</a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#poisson-distribution"><i class="fa fa-check"></i><b>6.3.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="6.3.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#exponential-distribution"><i class="fa fa-check"></i><b>6.3.4</b> Exponential distribution</a></li>
<li class="chapter" data-level="6.3.5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#students-t-distribution"><i class="fa fa-check"></i><b>6.3.5</b> (Student’s) t-distribution</a></li>
<li class="chapter" data-level="6.3.6" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#log-normal-distribution"><i class="fa fa-check"></i><b>6.3.6</b> Log-normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation-and-experimental-design"><i class="fa fa-check"></i><b>6.4</b> Correlation and Experimental Design</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation"><i class="fa fa-check"></i><b>6.4.1</b> Correlation</a></li>
<li class="chapter" data-level="6.4.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation-caveats"><i class="fa fa-check"></i><b>6.4.2</b> Correlation caveats</a></li>
<li class="chapter" data-level="6.4.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#design-of-experiments"><i class="fa fa-check"></i><b>6.4.3</b> Design of experiments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Introduction to Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#data-columns-types-affect-plot-types"><i class="fa fa-check"></i><b>7.1.1</b> Data columns types affect plot types</a></li>
<li class="chapter" data-level="7.1.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>7.1.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="7.1.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#ggplot2-layers"><i class="fa fa-check"></i><b>7.1.3</b> ggplot2 layers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#aesthetics"><i class="fa fa-check"></i><b>7.2</b> Aesthetics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#visible-aesthetics"><i class="fa fa-check"></i><b>7.2.1</b> Visible aesthetics</a></li>
<li class="chapter" data-level="7.2.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#using-attributes"><i class="fa fa-check"></i><b>7.2.2</b> Using attributes</a></li>
<li class="chapter" data-level="7.2.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#modifying-aesthetics"><i class="fa fa-check"></i><b>7.2.3</b> Modifying aesthetics</a></li>
<li class="chapter" data-level="7.2.4" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#aesthetics-best-practices"><i class="fa fa-check"></i><b>7.2.4</b> Aesthetics best practices</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#geometries"><i class="fa fa-check"></i><b>7.3</b> Geometries</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>7.3.1</b> Scatter plots</a></li>
<li class="chapter" data-level="7.3.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#histograms-1"><i class="fa fa-check"></i><b>7.3.2</b> Histograms</a></li>
<li class="chapter" data-level="7.3.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#bar-plots-1"><i class="fa fa-check"></i><b>7.3.3</b> Bar plots</a></li>
<li class="chapter" data-level="7.3.4" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#line-plots-1"><i class="fa fa-check"></i><b>7.3.4</b> Line plots</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>7.4</b> Themes</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#themes-from-scratch"><i class="fa fa-check"></i><b>7.4.1</b> Themes from scratch</a></li>
<li class="chapter" data-level="7.4.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#theme-flexibility"><i class="fa fa-check"></i><b>7.4.2</b> Theme flexibility</a></li>
<li class="chapter" data-level="7.4.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#effective-explanatory-plots"><i class="fa fa-check"></i><b>7.4.3</b> Effective explanatory plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>8</b> Intermediate Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#statistics"><i class="fa fa-check"></i><b>8.1</b> Statistics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#stats-with-geoms"><i class="fa fa-check"></i><b>8.1.1</b> Stats with geoms</a></li>
<li class="chapter" data-level="8.1.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#stats-sum-quantile"><i class="fa fa-check"></i><b>8.1.2</b> Stats: sum &amp; quantile</a></li>
<li class="chapter" data-level="8.1.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#stats-outside-geoms"><i class="fa fa-check"></i><b>8.1.3</b> Stats outside geoms</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#coordinates"><i class="fa fa-check"></i><b>8.2</b> Coordinates</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#coordinates-layer"><i class="fa fa-check"></i><b>8.2.1</b> Coordinates layer</a></li>
<li class="chapter" data-level="8.2.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#coordinates-vs.-scales"><i class="fa fa-check"></i><b>8.2.2</b> Coordinates vs. scales</a></li>
<li class="chapter" data-level="8.2.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#double-flipped-axes"><i class="fa fa-check"></i><b>8.2.3</b> Double &amp; flipped axes</a></li>
<li class="chapter" data-level="8.2.4" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#polar-coordinates"><i class="fa fa-check"></i><b>8.2.4</b> Polar coordinates</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>8.3</b> Facets</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#the-facets-layer"><i class="fa fa-check"></i><b>8.3.1</b> The facets layer</a></li>
<li class="chapter" data-level="8.3.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facet-labels-order"><i class="fa fa-check"></i><b>8.3.2</b> Facet labels &amp; order</a></li>
<li class="chapter" data-level="8.3.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facet-plotting-spaces"><i class="fa fa-check"></i><b>8.3.3</b> Facet plotting spaces</a></li>
<li class="chapter" data-level="8.3.4" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facet-wrap-margins"><i class="fa fa-check"></i><b>8.3.4</b> Facet wrap &amp; margins</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#best-practices"><i class="fa fa-check"></i><b>8.4</b> Best Practices</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#bar-plots-2"><i class="fa fa-check"></i><b>8.4.1</b> Bar plots</a></li>
<li class="chapter" data-level="8.4.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#heatmaps-use-case-scenario"><i class="fa fa-check"></i><b>8.4.2</b> Heatmaps use case scenario</a></li>
<li class="chapter" data-level="8.4.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#when-good-data-makes-bad-plots"><i class="fa fa-check"></i><b>8.4.3</b> When good data makes bad plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html"><i class="fa fa-check"></i><b>9</b> Introduction to Importing Data in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#flat-files-with-utils"><i class="fa fa-check"></i><b>9.1</b> Flat files with utils</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#read.csv"><i class="fa fa-check"></i><b>9.1.1</b> read.csv</a></li>
<li class="chapter" data-level="9.1.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#read.delim"><i class="fa fa-check"></i><b>9.1.2</b> read.delim</a></li>
<li class="chapter" data-level="9.1.3" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#read.table"><i class="fa fa-check"></i><b>9.1.3</b> read.table</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#readr-data.table"><i class="fa fa-check"></i><b>9.2</b> readr &amp; data.table</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#readr"><i class="fa fa-check"></i><b>9.2.1</b> readr</a></li>
<li class="chapter" data-level="9.2.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#data.table"><i class="fa fa-check"></i><b>9.2.2</b> data.table</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#excel-data"><i class="fa fa-check"></i><b>9.3</b> Excel data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#list-the-sheets-of-xls-file"><i class="fa fa-check"></i><b>9.3.1</b> List the sheets of xls file</a></li>
<li class="chapter" data-level="9.3.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#import-an-excel-sheet"><i class="fa fa-check"></i><b>9.3.2</b> Import an Excel sheet</a></li>
<li class="chapter" data-level="9.3.3" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#col_names-skip-argument"><i class="fa fa-check"></i><b>9.3.3</b> col_names &amp; skip argument</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#reproducible-excel-work---xlconnect"><i class="fa fa-check"></i><b>9.4</b> Reproducible Excel work - XLConnect</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#adapting-sheets"><i class="fa fa-check"></i><b>9.4.1</b> Adapting sheets</a></li>
<li class="chapter" data-level="9.4.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#adapting-sheets-1"><i class="fa fa-check"></i><b>9.4.2</b> Adapting sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html"><i class="fa fa-check"></i><b>10</b> Cleaning Data in R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#common-data-problems"><i class="fa fa-check"></i><b>10.1</b> Common Data Problems</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#data-type-constraints"><i class="fa fa-check"></i><b>10.1.1</b> Data type constraints</a></li>
<li class="chapter" data-level="10.1.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#range-constraints"><i class="fa fa-check"></i><b>10.1.2</b> Range constraints</a></li>
<li class="chapter" data-level="10.1.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#uniqueness-constraints"><i class="fa fa-check"></i><b>10.1.3</b> Uniqueness constraints</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#categorical-and-text-data"><i class="fa fa-check"></i><b>10.2</b> Categorical and Text Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#checking-membership"><i class="fa fa-check"></i><b>10.2.1</b> Checking membership</a></li>
<li class="chapter" data-level="10.2.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#categorical-data-problems"><i class="fa fa-check"></i><b>10.2.2</b> Categorical data problems</a></li>
<li class="chapter" data-level="10.2.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#cleaning-text-data"><i class="fa fa-check"></i><b>10.2.3</b> Cleaning text data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#advanced-data-problems"><i class="fa fa-check"></i><b>10.3</b> Advanced Data Problems</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#uniformity"><i class="fa fa-check"></i><b>10.3.1</b> Uniformity</a></li>
<li class="chapter" data-level="10.3.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#cross-field-validation"><i class="fa fa-check"></i><b>10.3.2</b> Cross field validation</a></li>
<li class="chapter" data-level="10.3.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#completeness"><i class="fa fa-check"></i><b>10.3.3</b> Completeness</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#record-linkage"><i class="fa fa-check"></i><b>10.4</b> Record Linkage</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#comparing-strings"><i class="fa fa-check"></i><b>10.4.1</b> Comparing strings</a></li>
<li class="chapter" data-level="10.4.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#generating-and-comparing-pairs"><i class="fa fa-check"></i><b>10.4.2</b> Generating and comparing pairs</a></li>
<li class="chapter" data-level="10.4.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#scoring-and-linking"><i class="fa fa-check"></i><b>10.4.3</b> Scoring and linking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html"><i class="fa fa-check"></i><b>11</b> Working with Dates and Times in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#dates-and-times-in-r"><i class="fa fa-check"></i><b>11.1</b> Dates and Times in R</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#introduction-to-dates"><i class="fa fa-check"></i><b>11.1.1</b> Introduction to dates</a></li>
<li class="chapter" data-level="11.1.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#why-use-dates"><i class="fa fa-check"></i><b>11.1.2</b> Why use dates?</a></li>
<li class="chapter" data-level="11.1.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#what-about-times"><i class="fa fa-check"></i><b>11.1.3</b> What about times?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#parsing-manipulating-with-lubridate"><i class="fa fa-check"></i><b>11.2</b> Parsing &amp; Manipulating with lubridate</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#parsing-dates"><i class="fa fa-check"></i><b>11.2.1</b> Parsing dates</a></li>
<li class="chapter" data-level="11.2.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#manipulating-dates"><i class="fa fa-check"></i><b>11.2.2</b> Manipulating dates</a></li>
<li class="chapter" data-level="11.2.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#extracting-parts-of-a-datetime"><i class="fa fa-check"></i><b>11.2.3</b> Extracting parts of a datetime</a></li>
<li class="chapter" data-level="11.2.4" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#rounding-datetimes"><i class="fa fa-check"></i><b>11.2.4</b> Rounding datetimes</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#arithmetic-with-dates-and-times"><i class="fa fa-check"></i><b>11.3</b> Arithmetic with Dates and Times</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#taking-differences-of-datetimes"><i class="fa fa-check"></i><b>11.3.1</b> Taking differences of datetimes</a></li>
<li class="chapter" data-level="11.3.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#time-spans"><i class="fa fa-check"></i><b>11.3.2</b> Time spans</a></li>
<li class="chapter" data-level="11.3.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#intervals"><i class="fa fa-check"></i><b>11.3.3</b> Intervals</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#problems-in-practice"><i class="fa fa-check"></i><b>11.4</b> Problems in practice</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#time-zones"><i class="fa fa-check"></i><b>11.4.1</b> Time zones</a></li>
<li class="chapter" data-level="11.4.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#more-on-import-and-export-datetimes"><i class="fa fa-check"></i><b>11.4.2</b> More on import and export datetimes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html"><i class="fa fa-check"></i><b>12</b> Introduction to Writing Functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#write-a-function"><i class="fa fa-check"></i><b>12.1</b> Write a Function</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#why-write-function"><i class="fa fa-check"></i><b>12.1.1</b> Why write function?</a></li>
<li class="chapter" data-level="12.1.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#convert-scripts-into-functions"><i class="fa fa-check"></i><b>12.1.2</b> Convert scripts into functions</a></li>
<li class="chapter" data-level="12.1.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#readable-code"><i class="fa fa-check"></i><b>12.1.3</b> Readable code</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#all-about-arguments"><i class="fa fa-check"></i><b>12.2</b> All About Arguments</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#default-arguments"><i class="fa fa-check"></i><b>12.2.1</b> Default arguments</a></li>
<li class="chapter" data-level="12.2.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#pass-arguments-between-functions"><i class="fa fa-check"></i><b>12.2.2</b> Pass arguments between functions</a></li>
<li class="chapter" data-level="12.2.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#checking-arguments"><i class="fa fa-check"></i><b>12.2.3</b> Checking arguments</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#return-values-and-scope"><i class="fa fa-check"></i><b>12.3</b> Return Values and Scope</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#returning-values"><i class="fa fa-check"></i><b>12.3.1</b> Returning values</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#return-multiple-values"><i class="fa fa-check"></i><b>12.3.2</b> Return multiple values</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#environments"><i class="fa fa-check"></i><b>12.3.3</b> Environments</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#scope-and-precedence"><i class="fa fa-check"></i><b>12.3.4</b> Scope and precedence</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#case-study-on-grain-yields"><i class="fa fa-check"></i><b>12.4</b> Case Study on Grain Yields</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#grain-yields-unit-conversion"><i class="fa fa-check"></i><b>12.4.1</b> Grain yields &amp; unit conversion</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#visualizing-grain-yields"><i class="fa fa-check"></i><b>12.4.2</b> Visualizing grain yields</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#modeling-grain-yields"><i class="fa fa-check"></i><b>12.4.3</b> Modeling grain yields</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html"><i class="fa fa-check"></i><b>13</b> Exploratory Data Analysis in R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#exploring-categorical-data"><i class="fa fa-check"></i><b>13.1</b> Exploring Categorical Data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#categorical-data"><i class="fa fa-check"></i><b>13.1.1</b> Categorical data</a></li>
<li class="chapter" data-level="13.1.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#counts-vs.-proportions"><i class="fa fa-check"></i><b>13.1.2</b> Counts vs. proportions</a></li>
<li class="chapter" data-level="13.1.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#distribution-of-one-variable"><i class="fa fa-check"></i><b>13.1.3</b> Distribution of one variable</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#exploring-numerical-data"><i class="fa fa-check"></i><b>13.2</b> Exploring numerical data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#numerical-data"><i class="fa fa-check"></i><b>13.2.1</b> Numerical Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#distribution-of-one-variable-1"><i class="fa fa-check"></i><b>13.2.2</b> Distribution of one variable</a></li>
<li class="chapter" data-level="13.2.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#box-plots-1"><i class="fa fa-check"></i><b>13.2.3</b> Box plots</a></li>
<li class="chapter" data-level="13.2.4" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#visual-in-higher-dimensions"><i class="fa fa-check"></i><b>13.2.4</b> Visual in higher dimensions</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#numerical-summaries"><i class="fa fa-check"></i><b>13.3</b> Numerical Summaries</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#measures-of-center-1"><i class="fa fa-check"></i><b>13.3.1</b> Measures of center</a></li>
<li class="chapter" data-level="13.3.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#measures-of-variability"><i class="fa fa-check"></i><b>13.3.2</b> Measures of variability</a></li>
<li class="chapter" data-level="13.3.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#shape-transformations"><i class="fa fa-check"></i><b>13.3.3</b> Shape &amp; transformations</a></li>
<li class="chapter" data-level="13.3.4" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#outliers"><i class="fa fa-check"></i><b>13.3.4</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#case-study"><i class="fa fa-check"></i><b>13.4</b> Case Study</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#new-data"><i class="fa fa-check"></i><b>13.4.1</b> New data</a></li>
<li class="chapter" data-level="13.4.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#check-in-1"><i class="fa fa-check"></i><b>13.4.2</b> Check-in 1</a></li>
<li class="chapter" data-level="13.4.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#check-in-2"><i class="fa fa-check"></i><b>13.4.3</b> Check-in 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html"><i class="fa fa-check"></i><b>14</b> Introduction to Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>14.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#tale-of-two-variables"><i class="fa fa-check"></i><b>14.1.1</b> Tale of two variables</a></li>
<li class="chapter" data-level="14.1.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#fitting-a-linear-regression"><i class="fa fa-check"></i><b>14.1.2</b> Fitting a linear regression</a></li>
<li class="chapter" data-level="14.1.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#categorical-explanatory-variables"><i class="fa fa-check"></i><b>14.1.3</b> Categorical explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#predictions-model-objects"><i class="fa fa-check"></i><b>14.2</b> Predictions &amp; model objects</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#making-predictions"><i class="fa fa-check"></i><b>14.2.1</b> Making predictions</a></li>
<li class="chapter" data-level="14.2.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#working-with-model-objects"><i class="fa fa-check"></i><b>14.2.2</b> Working with model objects</a></li>
<li class="chapter" data-level="14.2.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>14.2.3</b> Regression to the mean</a></li>
<li class="chapter" data-level="14.2.4" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#transforming-variables"><i class="fa fa-check"></i><b>14.2.4</b> Transforming variables</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#assessing-model-fit"><i class="fa fa-check"></i><b>14.3</b> Assessing model fit</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#quantifying-model-fit"><i class="fa fa-check"></i><b>14.3.1</b> Quantifying model fit</a></li>
<li class="chapter" data-level="14.3.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#visualizing-model-fit"><i class="fa fa-check"></i><b>14.3.2</b> Visualizing model fit</a></li>
<li class="chapter" data-level="14.3.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#outliers-leverage-influence"><i class="fa fa-check"></i><b>14.3.3</b> Outliers, leverage, influence</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#simple-logistic-regression"><i class="fa fa-check"></i><b>14.4</b> Simple logistic regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#why-need-logistic-regression"><i class="fa fa-check"></i><b>14.4.1</b> Why need logistic regression</a></li>
<li class="chapter" data-level="14.4.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#predictions-odds-ratios"><i class="fa fa-check"></i><b>14.4.2</b> Predictions &amp; odds ratios</a></li>
<li class="chapter" data-level="14.4.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#quantify-logistic-regression-fit"><i class="fa fa-check"></i><b>14.4.3</b> Quantify logistic regression fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intermediate-regression.html"><a href="intermediate-regression.html"><i class="fa fa-check"></i><b>15</b> Intermediate Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#parallel-slopes"><i class="fa fa-check"></i><b>15.1</b> Parallel Slopes</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#parallel-slopes-linear-regression"><i class="fa fa-check"></i><b>15.1.1</b> Parallel slopes linear regression</a></li>
<li class="chapter" data-level="15.1.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#predicting-parallel-slopes"><i class="fa fa-check"></i><b>15.1.2</b> Predicting parallel slopes</a></li>
<li class="chapter" data-level="15.1.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#assessing-model-performance"><i class="fa fa-check"></i><b>15.1.3</b> Assessing model performance</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#interactions"><i class="fa fa-check"></i><b>15.2</b> Interactions</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#models-for-each-category"><i class="fa fa-check"></i><b>15.2.1</b> Models for each category</a></li>
<li class="chapter" data-level="15.2.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#one-model-with-an-interaction"><i class="fa fa-check"></i><b>15.2.2</b> One model with an interaction</a></li>
<li class="chapter" data-level="15.2.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#predict-with-interactions"><i class="fa fa-check"></i><b>15.2.3</b> Predict with interactions</a></li>
<li class="chapter" data-level="15.2.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#simpsons-paradox"><i class="fa fa-check"></i><b>15.2.4</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>15.3</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#two-numeric-ivs"><i class="fa fa-check"></i><b>15.3.1</b> Two numeric IVs</a></li>
<li class="chapter" data-level="15.3.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#more-than-2-ivs"><i class="fa fa-check"></i><b>15.3.2</b> More than 2 IVs</a></li>
<li class="chapter" data-level="15.3.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#model-performance"><i class="fa fa-check"></i><b>15.3.3</b> Model performance</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>15.4</b> Multiple Logistic Regression</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-logistic-regression-1"><i class="fa fa-check"></i><b>15.4.1</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="15.4.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#logistic-distribution"><i class="fa fa-check"></i><b>15.4.2</b> Logistic distribution</a></li>
<li class="chapter" data-level="15.4.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#model-performance-1"><i class="fa fa-check"></i><b>15.4.3</b> Model performance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sampling-in-r.html"><a href="sampling-in-r.html"><i class="fa fa-check"></i><b>16</b> Sampling in R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#introduction-to-sampling"><i class="fa fa-check"></i><b>16.1</b> Introduction to Sampling</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-point-estimates"><i class="fa fa-check"></i><b>16.1.1</b> Sampling &amp; point estimates</a></li>
<li class="chapter" data-level="16.1.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#convenience-sampling"><i class="fa fa-check"></i><b>16.1.2</b> Convenience sampling</a></li>
<li class="chapter" data-level="16.1.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#pseudo-random-number-generation"><i class="fa fa-check"></i><b>16.1.3</b> Pseudo-random number generation</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-methods"><i class="fa fa-check"></i><b>16.2</b> Sampling Methods</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#simple-random-systematic-sampling"><i class="fa fa-check"></i><b>16.2.1</b> Simple random &amp; systematic sampling</a></li>
<li class="chapter" data-level="16.2.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#stratified-weighted-random-sampling"><i class="fa fa-check"></i><b>16.2.2</b> Stratified &amp; weighted random sampling</a></li>
<li class="chapter" data-level="16.2.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#cluster-sampling"><i class="fa fa-check"></i><b>16.2.3</b> Cluster sampling</a></li>
<li class="chapter" data-level="16.2.4" data-path="sampling-in-r.html"><a href="sampling-in-r.html#comparing-sampling-methods"><i class="fa fa-check"></i><b>16.2.4</b> Comparing sampling methods</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-distributions"><i class="fa fa-check"></i><b>16.3</b> Sampling Distributions</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#relative-error-of-point-estimates"><i class="fa fa-check"></i><b>16.3.1</b> Relative error of point estimates</a></li>
<li class="chapter" data-level="16.3.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#creating-a-sampling-distribution"><i class="fa fa-check"></i><b>16.3.2</b> Creating a sampling distribution</a></li>
<li class="chapter" data-level="16.3.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#approximate-sampling-distributions"><i class="fa fa-check"></i><b>16.3.3</b> Approximate sampling distributions</a></li>
<li class="chapter" data-level="16.3.4" data-path="sampling-in-r.html"><a href="sampling-in-r.html#standard-errors-clt"><i class="fa fa-check"></i><b>16.3.4</b> Standard errors &amp; CLT</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="sampling-in-r.html"><a href="sampling-in-r.html#bootstrap-distributions"><i class="fa fa-check"></i><b>16.4</b> Bootstrap Distributions</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#introduction-to-bootstrapping"><i class="fa fa-check"></i><b>16.4.1</b> Introduction to bootstrapping</a></li>
<li class="chapter" data-level="16.4.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#comparing-sampling-bootstrap-distributions"><i class="fa fa-check"></i><b>16.4.2</b> Comparing sampling &amp; bootstrap distributions</a></li>
<li class="chapter" data-level="16.4.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#confidence-intervals"><i class="fa fa-check"></i><b>16.4.3</b> Confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>17</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-to-hypothesis-testing"><i class="fa fa-check"></i><b>17.1</b> Introduction to Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-tests-z-scores"><i class="fa fa-check"></i><b>17.1.1</b> Hypothesis tests &amp; z-scores</a></li>
<li class="chapter" data-level="17.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#p-values"><i class="fa fa-check"></i><b>17.1.2</b> p-values</a></li>
<li class="chapter" data-level="17.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-significance"><i class="fa fa-check"></i><b>17.1.3</b> Statistical significance</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-sample-anova-tests"><i class="fa fa-check"></i><b>17.2</b> Two-Sample &amp; ANOVA Tests</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#performing-t-tests"><i class="fa fa-check"></i><b>17.2.1</b> Performing t-tests</a></li>
<li class="chapter" data-level="17.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#calculating-p-values-from-t-statistics"><i class="fa fa-check"></i><b>17.2.2</b> Calculating p-values from t-statistics</a></li>
<li class="chapter" data-level="17.2.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#paired-t-tests"><i class="fa fa-check"></i><b>17.2.3</b> Paired t-tests</a></li>
<li class="chapter" data-level="17.2.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#anova-tests"><i class="fa fa-check"></i><b>17.2.4</b> ANOVA tests</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#proportion-tests"><i class="fa fa-check"></i><b>17.3</b> Proportion Tests</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-proportion-tests"><i class="fa fa-check"></i><b>17.3.1</b> One-sample proportion tests</a></li>
<li class="chapter" data-level="17.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-sample-proportion-tests"><i class="fa fa-check"></i><b>17.3.2</b> Two-sample proportion tests</a></li>
<li class="chapter" data-level="17.3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-test-of-independence"><i class="fa fa-check"></i><b>17.3.3</b> Chi-square test of independence</a></li>
<li class="chapter" data-level="17.3.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-goodness-of-fit-tests"><i class="fa fa-check"></i><b>17.3.4</b> Chi-square goodness of fit tests</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-tests"><i class="fa fa-check"></i><b>17.4</b> Non-Parametric Tests</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#assumptions-in-hypothesis-testing"><i class="fa fa-check"></i><b>17.4.1</b> Assumptions in hypothesis testing</a></li>
<li class="chapter" data-level="17.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#simulation-based-infer-pipeline"><i class="fa fa-check"></i><b>17.4.2</b> Simulation-based infer pipeline</a></li>
<li class="chapter" data-level="17.4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-anova-unpaired-t-tests"><i class="fa fa-check"></i><b>17.4.3</b> Non-parametric ANOVA &amp; unpaired t-tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>18</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="18.1" data-path="experimental-design.html"><a href="experimental-design.html#introduction-to-experimental-design"><i class="fa fa-check"></i><b>18.1</b> Introduction to experimental design</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="experimental-design.html"><a href="experimental-design.html#introduction-1"><i class="fa fa-check"></i><b>18.1.1</b> Introduction</a></li>
<li class="chapter" data-level="18.1.2" data-path="experimental-design.html"><a href="experimental-design.html#replication-blocking"><i class="fa fa-check"></i><b>18.1.2</b> Replication &amp; blocking</a></li>
<li class="chapter" data-level="18.1.3" data-path="experimental-design.html"><a href="experimental-design.html#hypothesis-testing-1"><i class="fa fa-check"></i><b>18.1.3</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="experimental-design.html"><a href="experimental-design.html#basic-experiments"><i class="fa fa-check"></i><b>18.2</b> Basic Experiments</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="experimental-design.html"><a href="experimental-design.html#anova-factor-experiments"><i class="fa fa-check"></i><b>18.2.1</b> ANOVA &amp; factor experiments</a></li>
<li class="chapter" data-level="18.2.2" data-path="experimental-design.html"><a href="experimental-design.html#model-validation"><i class="fa fa-check"></i><b>18.2.2</b> Model validation</a></li>
<li class="chapter" data-level="18.2.3" data-path="experimental-design.html"><a href="experimental-design.html#ab-testing"><i class="fa fa-check"></i><b>18.2.3</b> A/B testing</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="experimental-design.html"><a href="experimental-design.html#block-designs"><i class="fa fa-check"></i><b>18.3</b> Block Designs</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="experimental-design.html"><a href="experimental-design.html#intro-to-sampling"><i class="fa fa-check"></i><b>18.3.1</b> Intro to sampling</a></li>
<li class="chapter" data-level="18.3.2" data-path="experimental-design.html"><a href="experimental-design.html#randomized-complete-block-designs-rcbd"><i class="fa fa-check"></i><b>18.3.2</b> Randomized Complete Block Designs (RCBD)</a></li>
<li class="chapter" data-level="18.3.3" data-path="experimental-design.html"><a href="experimental-design.html#balanced-incomplete-block-designs-bibd"><i class="fa fa-check"></i><b>18.3.3</b> Balanced Incomplete Block Designs (BIBD)</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="experimental-design.html"><a href="experimental-design.html#squares-factorial-experiments"><i class="fa fa-check"></i><b>18.4</b> Squares &amp; Factorial Experiments</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="experimental-design.html"><a href="experimental-design.html#latin-squares"><i class="fa fa-check"></i><b>18.4.1</b> Latin squares</a></li>
<li class="chapter" data-level="18.4.2" data-path="experimental-design.html"><a href="experimental-design.html#graeco-latin-squares"><i class="fa fa-check"></i><b>18.4.2</b> Graeco-Latin squares</a></li>
<li class="chapter" data-level="18.4.3" data-path="experimental-design.html"><a href="experimental-design.html#factorial-experiments"><i class="fa fa-check"></i><b>18.4.3</b> Factorial experiments</a></li>
<li class="chapter" data-level="18.4.4" data-path="experimental-design.html"><a href="experimental-design.html#other-experimental-designs"><i class="fa fa-check"></i><b>18.4.4</b> Other experimental designs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html"><i class="fa fa-check"></i><b>19</b> Supervised Learning: Classification</a>
<ul>
<li class="chapter" data-level="19.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#k-nearest-neighbors-knn"><i class="fa fa-check"></i><b>19.1</b> k-Nearest Neighbors (kNN)</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#classification-with-nearest-neighbors"><i class="fa fa-check"></i><b>19.1.1</b> Classification with Nearest Neighbors</a></li>
<li class="chapter" data-level="19.1.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#k-in-knn"><i class="fa fa-check"></i><b>19.1.2</b> ‘k’ in kNN</a></li>
<li class="chapter" data-level="19.1.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#data-preparation-for-knn"><i class="fa fa-check"></i><b>19.1.3</b> 1-3.Data preparation for kNN</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#naive-bayes"><i class="fa fa-check"></i><b>19.2</b> Naive Bayes</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#understanding-bayesian-methods"><i class="fa fa-check"></i><b>19.2.1</b> Understanding Bayesian methods</a></li>
<li class="chapter" data-level="19.2.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#understanding-nbs-naivety"><i class="fa fa-check"></i><b>19.2.2</b> Understanding NB’s “naivety”</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#logistic-regression"><i class="fa fa-check"></i><b>19.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#making-binary-predictions-with-regression"><i class="fa fa-check"></i><b>19.3.1</b> Making binary predictions with regression</a></li>
<li class="chapter" data-level="19.3.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#model-performance-tradeoffs"><i class="fa fa-check"></i><b>19.3.2</b> Model performance tradeoffs</a></li>
<li class="chapter" data-level="19.3.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#dummy-variables-missing-data-and-interactions"><i class="fa fa-check"></i><b>19.3.3</b> Dummy variables, missing data, and interactions</a></li>
<li class="chapter" data-level="19.3.4" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#automatic-feature-selection"><i class="fa fa-check"></i><b>19.3.4</b> Automatic feature selection</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#classification-trees"><i class="fa fa-check"></i><b>19.4</b> Classification Trees</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#making-decisions-with-trees"><i class="fa fa-check"></i><b>19.4.1</b> Making decisions with trees</a></li>
<li class="chapter" data-level="19.4.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#growing-larger-classification-trees"><i class="fa fa-check"></i><b>19.4.2</b> Growing larger classification trees</a></li>
<li class="chapter" data-level="19.4.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#tending-to-classification-trees"><i class="fa fa-check"></i><b>19.4.3</b> Tending to classification trees</a></li>
<li class="chapter" data-level="19.4.4" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#seeing-the-forest-from-the-trees"><i class="fa fa-check"></i><b>19.4.4</b> Seeing the forest from the trees</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html"><i class="fa fa-check"></i><b>20</b> Supervised Learning: Regression</a>
<ul>
<li class="chapter" data-level="20.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#what-is-regression"><i class="fa fa-check"></i><b>20.1</b> What is Regression?</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#introduction-2"><i class="fa fa-check"></i><b>20.1.1</b> Introduction</a></li>
<li class="chapter" data-level="20.1.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#linear-regression"><i class="fa fa-check"></i><b>20.1.2</b> Linear regression</a></li>
<li class="chapter" data-level="20.1.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#predicting-model"><i class="fa fa-check"></i><b>20.1.3</b> Predicting model</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#training-and-evaluating-models"><i class="fa fa-check"></i><b>20.2</b> Training and Evaluating Models</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#graphically"><i class="fa fa-check"></i><b>20.2.1</b> Graphically</a></li>
<li class="chapter" data-level="20.2.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#root-mean-squared-error"><i class="fa fa-check"></i><b>20.2.2</b> Root Mean Squared Error</a></li>
<li class="chapter" data-level="20.2.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#r-squared"><i class="fa fa-check"></i><b>20.2.3</b> R-squared</a></li>
<li class="chapter" data-level="20.2.4" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#training-a-model"><i class="fa fa-check"></i><b>20.2.4</b> Training a Model</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#issues-to-consider"><i class="fa fa-check"></i><b>20.3</b> Issues to Consider</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#categorical-iv"><i class="fa fa-check"></i><b>20.3.1</b> Categorical IV</a></li>
<li class="chapter" data-level="20.3.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#interactions-1"><i class="fa fa-check"></i><b>20.3.2</b> Interactions</a></li>
<li class="chapter" data-level="20.3.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#transforming-dv-before-modeling"><i class="fa fa-check"></i><b>20.3.3</b> Transforming DV before modeling</a></li>
<li class="chapter" data-level="20.3.4" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#transforming-iv-before-modeling"><i class="fa fa-check"></i><b>20.3.4</b> Transforming IV before modeling</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#dealing-with-non-linear-responses"><i class="fa fa-check"></i><b>20.4</b> Dealing with Non-Linear Responses</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#logistic-regression-to-predict-probabilities"><i class="fa fa-check"></i><b>20.4.1</b> Logistic regression to predict probabilities</a></li>
<li class="chapter" data-level="20.4.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#poisson-and-quasipoisson-regression-to-predict-counts"><i class="fa fa-check"></i><b>20.4.2</b> Poisson and quasipoisson regression to predict counts</a></li>
<li class="chapter" data-level="20.4.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#gam-to-learn-non-linear-transforms"><i class="fa fa-check"></i><b>20.4.3</b> GAM to learn non-linear transforms</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#tree-based-methods"><i class="fa fa-check"></i><b>20.5</b> Tree-Based Methods</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#random-forests"><i class="fa fa-check"></i><b>20.5.1</b> Random forests</a></li>
<li class="chapter" data-level="20.5.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#one-hot-encoding"><i class="fa fa-check"></i><b>20.5.2</b> One-Hot-Encoding</a></li>
<li class="chapter" data-level="20.5.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#gradient-boosting"><i class="fa fa-check"></i><b>20.5.3</b> Gradient boosting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>21</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="21.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>21.1</b> k-means clustering</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#types-of-machine-learning"><i class="fa fa-check"></i><b>21.1.1</b> Types of machine learning</a></li>
<li class="chapter" data-level="21.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-to-k-means"><i class="fa fa-check"></i><b>21.1.2</b> Introduction to k-means</a></li>
<li class="chapter" data-level="21.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#model-selection"><i class="fa fa-check"></i><b>21.1.3</b> Model selection</a></li>
<li class="chapter" data-level="21.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#pokemon-data"><i class="fa fa-check"></i><b>21.1.4</b> Pokemon data</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#hierarchical-clustering"><i class="fa fa-check"></i><b>21.2</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-3"><i class="fa fa-check"></i><b>21.2.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#selecting-number-of-clusters-1"><i class="fa fa-check"></i><b>21.2.2</b> Selecting number of clusters</a></li>
<li class="chapter" data-level="21.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-linkage"><i class="fa fa-check"></i><b>21.2.3</b> Clustering linkage</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#dimensionality-reduction---pca"><i class="fa fa-check"></i><b>21.3</b> Dimensionality reduction - PCA</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-4"><i class="fa fa-check"></i><b>21.3.1</b> Introduction</a></li>
<li class="chapter" data-level="21.3.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#visualizing-and-interpreting-1"><i class="fa fa-check"></i><b>21.3.2</b> Visualizing and interpreting</a></li>
<li class="chapter" data-level="21.3.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#practical-issues"><i class="fa fa-check"></i><b>21.3.3</b> Practical issues</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#case-study-1"><i class="fa fa-check"></i><b>21.4</b> Case study</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-5"><i class="fa fa-check"></i><b>21.4.1</b> Introduction</a></li>
<li class="chapter" data-level="21.4.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#next-steps"><i class="fa fa-check"></i><b>21.4.2</b> Next steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html"><i class="fa fa-check"></i><b>22</b> Intermediate Importing Data in R</a>
<ul>
<li class="chapter" data-level="22.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-databases-1"><i class="fa fa-check"></i><b>22.1</b> Import from databases-1</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#connect-to-a-database"><i class="fa fa-check"></i><b>22.1.1</b> Connect to a database</a></li>
<li class="chapter" data-level="22.1.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-table-data"><i class="fa fa-check"></i><b>22.1.2</b> Import table data</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-databases-2"><i class="fa fa-check"></i><b>22.2</b> Import from databases-2</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#sql-queries-from-inside-r"><i class="fa fa-check"></i><b>22.2.1</b> SQL Queries from inside R</a></li>
<li class="chapter" data-level="22.2.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#dbi-internals"><i class="fa fa-check"></i><b>22.2.2</b> DBI internals</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-the-web-1"><i class="fa fa-check"></i><b>22.3</b> Import from the web-1</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#http"><i class="fa fa-check"></i><b>22.3.1</b> HTTP</a></li>
<li class="chapter" data-level="22.3.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#downloading-files"><i class="fa fa-check"></i><b>22.3.2</b> Downloading files</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-the-web-2"><i class="fa fa-check"></i><b>22.4</b> Import from the web-2</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#apis-json"><i class="fa fa-check"></i><b>22.4.1</b> APIs &amp; JSON</a></li>
<li class="chapter" data-level="22.4.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#json-jsonlite"><i class="fa fa-check"></i><b>22.4.2</b> JSON &amp; jsonlite</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-statistical-software"><i class="fa fa-check"></i><b>22.5</b> Import from statistical software</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#haven-package"><i class="fa fa-check"></i><b>22.5.1</b> haven package</a></li>
<li class="chapter" data-level="22.5.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#foreign-package"><i class="fa fa-check"></i><b>22.5.2</b> foreign package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html"><i class="fa fa-check"></i><b>23</b> Introduction to SQL</a>
<ul>
<li class="chapter" data-level="23.1" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#relational-databases"><i class="fa fa-check"></i><b>23.1</b> Relational Databases</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#databases"><i class="fa fa-check"></i><b>23.1.1</b> Databases</a></li>
<li class="chapter" data-level="23.1.2" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#tables"><i class="fa fa-check"></i><b>23.1.2</b> Tables</a></li>
<li class="chapter" data-level="23.1.3" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#data"><i class="fa fa-check"></i><b>23.1.3</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#querying"><i class="fa fa-check"></i><b>23.2</b> Querying</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#introducing"><i class="fa fa-check"></i><b>23.2.1</b> Introducing</a></li>
<li class="chapter" data-level="23.2.2" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#writing-queries"><i class="fa fa-check"></i><b>23.2.2</b> Writing queries</a></li>
<li class="chapter" data-level="23.2.3" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#sql-flavors"><i class="fa fa-check"></i><b>23.2.3</b> SQL flavors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="intermediate-sql.html"><a href="intermediate-sql.html"><i class="fa fa-check"></i><b>24</b> Intermediate SQL</a>
<ul>
<li class="chapter" data-level="24.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#selecting-data"><i class="fa fa-check"></i><b>24.1</b> Selecting Data</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#querying-a-database"><i class="fa fa-check"></i><b>24.1.1</b> Querying a database</a></li>
<li class="chapter" data-level="24.1.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#query-execution"><i class="fa fa-check"></i><b>24.1.2</b> Query execution</a></li>
<li class="chapter" data-level="24.1.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#sql-style"><i class="fa fa-check"></i><b>24.1.3</b> SQL style</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-records"><i class="fa fa-check"></i><b>24.2</b> Filtering Records</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-numbers"><i class="fa fa-check"></i><b>24.2.1</b> Filtering numbers</a></li>
<li class="chapter" data-level="24.2.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#multiple-criteria"><i class="fa fa-check"></i><b>24.2.2</b> Multiple criteria</a></li>
<li class="chapter" data-level="24.2.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-text"><i class="fa fa-check"></i><b>24.2.3</b> Filtering text</a></li>
<li class="chapter" data-level="24.2.4" data-path="intermediate-sql.html"><a href="intermediate-sql.html#null-values"><i class="fa fa-check"></i><b>24.2.4</b> NULL values</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#aggregate-functions"><i class="fa fa-check"></i><b>24.3</b> Aggregate Functions</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#summarizing-data"><i class="fa fa-check"></i><b>24.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="24.3.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#summarizing-subsets"><i class="fa fa-check"></i><b>24.3.2</b> Summarizing subsets</a></li>
<li class="chapter" data-level="24.3.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#aliasing-and-arithmetic"><i class="fa fa-check"></i><b>24.3.3</b> Aliasing and arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="intermediate-sql.html"><a href="intermediate-sql.html#sorting-and-grouping"><i class="fa fa-check"></i><b>24.4</b> Sorting and Grouping</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#sorting-results"><i class="fa fa-check"></i><b>24.4.1</b> Sorting results</a></li>
<li class="chapter" data-level="24.4.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#grouping-data"><i class="fa fa-check"></i><b>24.4.2</b> Grouping data</a></li>
<li class="chapter" data-level="24.4.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-grouped-data"><i class="fa fa-check"></i><b>24.4.3</b> Filtering grouped data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html"><i class="fa fa-check"></i><b>25</b> Joining Data in SQL</a>
<ul>
<li class="chapter" data-level="25.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#inner-joins"><i class="fa fa-check"></i><b>25.1</b> Inner Joins</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#ins-outs-of-inner-join"><i class="fa fa-check"></i><b>25.1.1</b> ins &amp; outs of INNER JOIN</a></li>
<li class="chapter" data-level="25.1.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#defining-relationships"><i class="fa fa-check"></i><b>25.1.2</b> Defining relationships</a></li>
<li class="chapter" data-level="25.1.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#multiple-joins"><i class="fa fa-check"></i><b>25.1.3</b> Multiple joins</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#outer-cross-self-joins"><i class="fa fa-check"></i><b>25.2</b> Outer, Cross &amp; Self Joins</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#left-right-joins-1"><i class="fa fa-check"></i><b>25.2.1</b> LEFT &amp; RIGHT JOINs</a></li>
<li class="chapter" data-level="25.2.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#full-join-1"><i class="fa fa-check"></i><b>25.2.2</b> FULL JOIN</a></li>
<li class="chapter" data-level="25.2.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#cross-join"><i class="fa fa-check"></i><b>25.2.3</b> CROSS JOIN</a></li>
<li class="chapter" data-level="25.2.4" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#self-joins"><i class="fa fa-check"></i><b>25.2.4</b> Self joins</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#set-theory-for-sql-joins"><i class="fa fa-check"></i><b>25.3</b> Set Theory for SQL Joins</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#union-vs.-union-all"><i class="fa fa-check"></i><b>25.3.1</b> UNION vs. UNION ALL</a></li>
<li class="chapter" data-level="25.3.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#intersect"><i class="fa fa-check"></i><b>25.3.2</b> INTERSECT</a></li>
<li class="chapter" data-level="25.3.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#except"><i class="fa fa-check"></i><b>25.3.3</b> EXCEPT</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#subqueries"><i class="fa fa-check"></i><b>25.4</b> Subqueries</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#with-semi-joins-anti-joins"><i class="fa fa-check"></i><b>25.4.1</b> With semi joins &amp; anti joins</a></li>
<li class="chapter" data-level="25.4.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#inside-where-select"><i class="fa fa-check"></i><b>25.4.2</b> Inside WHERE &amp; SELECT</a></li>
<li class="chapter" data-level="25.4.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#inside-from"><i class="fa fa-check"></i><b>25.4.3</b> Inside FROM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="introduction-to-git.html"><a href="introduction-to-git.html"><i class="fa fa-check"></i><b>26</b> Introduction to Git</a>
<ul>
<li class="chapter" data-level="26.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#introduction-6"><i class="fa fa-check"></i><b>26.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#useful-shell-commands"><i class="fa fa-check"></i><b>26.1.1</b> Useful shell commands</a></li>
<li class="chapter" data-level="26.1.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#saving-files"><i class="fa fa-check"></i><b>26.1.2</b> Saving files</a></li>
<li class="chapter" data-level="26.1.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#comparing-files"><i class="fa fa-check"></i><b>26.1.3</b> Comparing files</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#making-changes"><i class="fa fa-check"></i><b>26.2</b> Making changes</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#storing-data-with-git"><i class="fa fa-check"></i><b>26.2.1</b> Storing data with Git</a></li>
<li class="chapter" data-level="26.2.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#viewing-changes"><i class="fa fa-check"></i><b>26.2.2</b> Viewing changes</a></li>
<li class="chapter" data-level="26.2.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#undoing-changes-before-committing"><i class="fa fa-check"></i><b>26.2.3</b> Undoing changes before committing</a></li>
<li class="chapter" data-level="26.2.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#restoring-and-reverting"><i class="fa fa-check"></i><b>26.2.4</b> Restoring and reverting</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#git-workflows"><i class="fa fa-check"></i><b>26.3</b> Git workflows</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#configuring-git"><i class="fa fa-check"></i><b>26.3.1</b> Configuring Git</a></li>
<li class="chapter" data-level="26.3.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#branches"><i class="fa fa-check"></i><b>26.3.2</b> Branches</a></li>
<li class="chapter" data-level="26.3.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#working-with-branches"><i class="fa fa-check"></i><b>26.3.3</b> Working with branches</a></li>
<li class="chapter" data-level="26.3.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#handling-conflict"><i class="fa fa-check"></i><b>26.3.4</b> Handling conflict</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#collaborating-with-git"><i class="fa fa-check"></i><b>26.4</b> Collaborating with Git</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#creating-repos"><i class="fa fa-check"></i><b>26.4.1</b> Creating repos</a></li>
<li class="chapter" data-level="26.4.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#working-with-remotes"><i class="fa fa-check"></i><b>26.4.2</b> Working with remotes</a></li>
<li class="chapter" data-level="26.4.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#pulling-from-a-remote"><i class="fa fa-check"></i><b>26.4.3</b> Pulling from a remote</a></li>
<li class="chapter" data-level="26.4.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#pushing-to-a-remote"><i class="fa fa-check"></i><b>26.4.4</b> Pushing to a remote</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Scientist with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supervised-learning-classification" class="section level1 hasAnchor" number="19">
<h1><span class="header-section-number">Chapter 19</span> Supervised Learning: Classification<a href="supervised-learning-classification.html#supervised-learning-classification" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="k-nearest-neighbors-knn" class="section level2 hasAnchor" number="19.1">
<h2><span class="header-section-number">19.1</span> k-Nearest Neighbors (kNN)<a href="supervised-learning-classification.html#k-nearest-neighbors-knn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="classification-with-nearest-neighbors" class="section level3 hasAnchor" number="19.1.1">
<h3><span class="header-section-number">19.1.1</span> Classification with Nearest Neighbors<a href="supervised-learning-classification.html#classification-with-nearest-neighbors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Measuring similarity with distance</strong></p>
<p>Many nearest neighbor learners use the Euclidean distance formula here, which measures the straight-line distance between two points.</p>
<p><span class="math inline">\(dist(p, q) = \sqrt{(p_1 - q_1)^2 + (p_2 - q_2)^2 + ... + (p_n - q_n)^2}\)</span></p>
<p><strong>Applying nearest neighbors in R</strong></p>
<div class="sourceCode" id="cb2549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2549-1"><a href="supervised-learning-classification.html#cb2549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb2549-2"><a href="supervised-learning-classification.html#cb2549-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(training_data, testing_data, training_labels)</span></code></pre></div>
<div id="recognizing-a-road-sign-with-knn" class="section level4 hasAnchor" number="19.1.1.1">
<h4><span class="header-section-number">19.1.1.1</span> Recognizing a road sign with kNN<a href="supervised-learning-classification.html#recognizing-a-road-sign-with-knn" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After several trips with a human behind the wheel, it is time for the self-driving car to attempt the test course alone.</p>
<p>As it begins to drive away, its camera captures the following image:</p>
<div class="figure">
<img src="https://assets.datacamp.com/production/course_2906/datasets/knn_stop_99.gif" alt="Stop Sign" />
<p class="caption">Stop Sign</p>
</div>
<p>Apply a kNN classifier to help the car recognize this sign.</p>
<p>The dataset <code>signs</code> is loaded in your workspace along with the data frame <code>next_sign</code>, which holds the observation you want to classify.</p>
<div class="sourceCode" id="cb2550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2550-1"><a href="supervised-learning-classification.html#cb2550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2550-2"><a href="supervised-learning-classification.html#cb2550-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2550-3"><a href="supervised-learning-classification.html#cb2550-3" aria-hidden="true" tabindex="-1"></a>signs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/knn_traffic_signs.csv&quot;</span>)</span>
<span id="cb2550-4"><a href="supervised-learning-classification.html#cb2550-4" aria-hidden="true" tabindex="-1"></a>signs</span></code></pre></div>
<pre><code>## # A tibble: 206 × 51
##       id sample sign_type     r1    g1    b1    r2    g2    b2    r3    g3    b3
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1 train  pedestrian   155   228   251   135   188   101   156   227   245
##  2     2 train  pedestrian   142   217   242   166   204    44   142   217   242
##  3     3 train  pedestrian    57    54    50   187   201    68    51    51    45
##  4     4 train  pedestrian    22    35    41   171   178    26    19    27    29
##  5     5 train  pedestrian   169   179   170   231   254    27    97   107    99
##  6     6 train  pedestrian    75    67    60   131    89    53   214   144    75
##  7     7 train  pedestrian   136   149   157   200   203   107   150   167   134
##  8     8 test   pedestrian   118   105    69   244   245    67   132   123    12
##  9     9 train  pedestrian   149   225   241    34    45     1   155   226   238
## 10    10 train  pedestrian    13    34    28     5    21    11   123   154   140
## # ℹ 196 more rows
## # ℹ 39 more variables: r4 &lt;dbl&gt;, g4 &lt;dbl&gt;, b4 &lt;dbl&gt;, r5 &lt;dbl&gt;, g5 &lt;dbl&gt;,
## #   b5 &lt;dbl&gt;, r6 &lt;dbl&gt;, g6 &lt;dbl&gt;, b6 &lt;dbl&gt;, r7 &lt;dbl&gt;, g7 &lt;dbl&gt;, b7 &lt;dbl&gt;,
## #   r8 &lt;dbl&gt;, g8 &lt;dbl&gt;, b8 &lt;dbl&gt;, r9 &lt;dbl&gt;, g9 &lt;dbl&gt;, b9 &lt;dbl&gt;, r10 &lt;dbl&gt;,
## #   g10 &lt;dbl&gt;, b10 &lt;dbl&gt;, r11 &lt;dbl&gt;, g11 &lt;dbl&gt;, b11 &lt;dbl&gt;, r12 &lt;dbl&gt;,
## #   g12 &lt;dbl&gt;, b12 &lt;dbl&gt;, r13 &lt;dbl&gt;, g13 &lt;dbl&gt;, b13 &lt;dbl&gt;, r14 &lt;dbl&gt;,
## #   g14 &lt;dbl&gt;, b14 &lt;dbl&gt;, r15 &lt;dbl&gt;, g15 &lt;dbl&gt;, b15 &lt;dbl&gt;, r16 &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb2552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2552-1"><a href="supervised-learning-classification.html#cb2552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing data</span></span>
<span id="cb2552-2"><a href="supervised-learning-classification.html#cb2552-2" aria-hidden="true" tabindex="-1"></a>next_sign <span class="ot">&lt;-</span> signs <span class="sc">%&gt;%</span> </span>
<span id="cb2552-3"><a href="supervised-learning-classification.html#cb2552-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">&quot;example&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2552-4"><a href="supervised-learning-classification.html#cb2552-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb2552-5"><a href="supervised-learning-classification.html#cb2552-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2552-6"><a href="supervised-learning-classification.html#cb2552-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(next_sign)</span></code></pre></div>
<pre><code>## tibble [1 × 48] (S3: tbl_df/tbl/data.frame)
##  $ r1 : num 204
##  $ g1 : num 227
##  $ b1 : num 220
##  $ r2 : num 196
##  $ g2 : num 59
##  $ b2 : num 51
##  $ r3 : num 202
##  $ g3 : num 67
##  $ b3 : num 59
##  $ r4 : num 204
##  $ g4 : num 227
##  $ b4 : num 220
##  $ r5 : num 236
##  $ g5 : num 250
##  $ b5 : num 234
##  $ r6 : num 242
##  $ g6 : num 252
##  $ b6 : num 235
##  $ r7 : num 205
##  $ g7 : num 148
##  $ b7 : num 131
##  $ r8 : num 190
##  $ g8 : num 50
##  $ b8 : num 43
##  $ r9 : num 179
##  $ g9 : num 70
##  $ b9 : num 57
##  $ r10: num 242
##  $ g10: num 229
##  $ b10: num 212
##  $ r11: num 190
##  $ g11: num 50
##  $ b11: num 43
##  $ r12: num 193
##  $ g12: num 51
##  $ b12: num 44
##  $ r13: num 170
##  $ g13: num 197
##  $ b13: num 196
##  $ r14: num 190
##  $ g14: num 50
##  $ b14: num 43
##  $ r15: num 190
##  $ g15: num 47
##  $ b15: num 41
##  $ r16: num 165
##  $ g16: num 195
##  $ b16: num 196</code></pre>
<div class="sourceCode" id="cb2554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2554-1"><a href="supervised-learning-classification.html#cb2554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training data</span></span>
<span id="cb2554-2"><a href="supervised-learning-classification.html#cb2554-2" aria-hidden="true" tabindex="-1"></a>signs <span class="ot">&lt;-</span> signs <span class="sc">%&gt;%</span></span>
<span id="cb2554-3"><a href="supervised-learning-classification.html#cb2554-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">&quot;train&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2554-4"><a href="supervised-learning-classification.html#cb2554-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb2554-5"><a href="supervised-learning-classification.html#cb2554-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2554-6"><a href="supervised-learning-classification.html#cb2554-6" aria-hidden="true" tabindex="-1"></a>signs</span></code></pre></div>
<pre><code>## # A tibble: 146 × 49
##    sign_type     r1    g1    b1    r2    g2    b2    r3    g3    b3    r4    g4
##    &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 pedestrian   155   228   251   135   188   101   156   227   245   145   211
##  2 pedestrian   142   217   242   166   204    44   142   217   242   147   219
##  3 pedestrian    57    54    50   187   201    68    51    51    45    59    62
##  4 pedestrian    22    35    41   171   178    26    19    27    29    19    27
##  5 pedestrian   169   179   170   231   254    27    97   107    99   123   147
##  6 pedestrian    75    67    60   131    89    53   214   144    75   156   169
##  7 pedestrian   136   149   157   200   203   107   150   167   134   171   218
##  8 pedestrian   149   225   241    34    45     1   155   226   238   147   222
##  9 pedestrian    13    34    28     5    21    11   123   154   140    21    46
## 10 pedestrian   123   124   107    83    61    26   116   124   115    67    67
## # ℹ 136 more rows
## # ℹ 37 more variables: b4 &lt;dbl&gt;, r5 &lt;dbl&gt;, g5 &lt;dbl&gt;, b5 &lt;dbl&gt;, r6 &lt;dbl&gt;,
## #   g6 &lt;dbl&gt;, b6 &lt;dbl&gt;, r7 &lt;dbl&gt;, g7 &lt;dbl&gt;, b7 &lt;dbl&gt;, r8 &lt;dbl&gt;, g8 &lt;dbl&gt;,
## #   b8 &lt;dbl&gt;, r9 &lt;dbl&gt;, g9 &lt;dbl&gt;, b9 &lt;dbl&gt;, r10 &lt;dbl&gt;, g10 &lt;dbl&gt;, b10 &lt;dbl&gt;,
## #   r11 &lt;dbl&gt;, g11 &lt;dbl&gt;, b11 &lt;dbl&gt;, r12 &lt;dbl&gt;, g12 &lt;dbl&gt;, b12 &lt;dbl&gt;,
## #   r13 &lt;dbl&gt;, g13 &lt;dbl&gt;, b13 &lt;dbl&gt;, r14 &lt;dbl&gt;, g14 &lt;dbl&gt;, b14 &lt;dbl&gt;,
## #   r15 &lt;dbl&gt;, g15 &lt;dbl&gt;, b15 &lt;dbl&gt;, r16 &lt;dbl&gt;, g16 &lt;dbl&gt;, b16 &lt;dbl&gt;</code></pre>
<ul>
<li><p>Create a vector of sign labels to use with kNN by extracting the column <code>sign_type</code> from <code>signs</code>.</p></li>
<li><p>Identify the <code>next_sign</code> using the <code>knn()</code> function.</p>
<ul>
<li><p>Set the <code>train</code> argument equal to the <code>signs</code> data frame <em>without</em> the first column.</p></li>
<li><p>Set the <code>test</code> argument equal to the data frame <code>next_sign</code>.</p></li>
<li><p>Use the vector of labels you created as the <code>cl</code> argument.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2556-1"><a href="supervised-learning-classification.html#cb2556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb2556-2"><a href="supervised-learning-classification.html#cb2556-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2556-3"><a href="supervised-learning-classification.html#cb2556-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of labels</span></span>
<span id="cb2556-4"><a href="supervised-learning-classification.html#cb2556-4" aria-hidden="true" tabindex="-1"></a>sign_types <span class="ot">&lt;-</span> signs<span class="sc">$</span>sign_type</span>
<span id="cb2556-5"><a href="supervised-learning-classification.html#cb2556-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2556-6"><a href="supervised-learning-classification.html#cb2556-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify the next sign observed</span></span>
<span id="cb2556-7"><a href="supervised-learning-classification.html#cb2556-7" aria-hidden="true" tabindex="-1"></a><span class="fu">knn</span>(<span class="at">train =</span> signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">test =</span> next_sign, <span class="at">cl =</span> sign_types)</span></code></pre></div>
<pre><code>## [1] stop
## Levels: pedestrian speed stop</code></pre>
<p>knn simply looks for the most similar example.</p>
</div>
<div id="exploring-the-traffic-sign-dataset" class="section level4 hasAnchor" number="19.1.1.2">
<h4><span class="header-section-number">19.1.1.2</span> Exploring the traffic sign dataset<a href="supervised-learning-classification.html#exploring-the-traffic-sign-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To better understand how the <code>knn()</code> function was able to classify the stop sign, it may help to examine the training dataset it used.</p>
<p>Each previously observed street sign was divided into a 4x4 grid, and the red, green, and blue level for each of the 16 center pixels is recorded as illustrated here.</p>
<div class="figure">
<img src="https://assets.datacamp.com/production/course_2906/datasets/knn_sign_data.png" alt="Stop Sign Data Encoding" width="256" />
<p class="caption">Stop Sign Data Encoding</p>
</div>
<p>The result is a dataset that records the <code>sign_type</code> as well as 16 x 3 = 48 color properties of each sign.</p>
<div class="sourceCode" id="cb2558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2558-1"><a href="supervised-learning-classification.html#cb2558-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the structure of the signs dataset</span></span>
<span id="cb2558-2"><a href="supervised-learning-classification.html#cb2558-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(signs)</span></code></pre></div>
<pre><code>## tibble [146 × 49] (S3: tbl_df/tbl/data.frame)
##  $ sign_type: chr [1:146] &quot;pedestrian&quot; &quot;pedestrian&quot; &quot;pedestrian&quot; &quot;pedestrian&quot; ...
##  $ r1       : num [1:146] 155 142 57 22 169 75 136 149 13 123 ...
##  $ g1       : num [1:146] 228 217 54 35 179 67 149 225 34 124 ...
##  $ b1       : num [1:146] 251 242 50 41 170 60 157 241 28 107 ...
##  $ r2       : num [1:146] 135 166 187 171 231 131 200 34 5 83 ...
##  $ g2       : num [1:146] 188 204 201 178 254 89 203 45 21 61 ...
##  $ b2       : num [1:146] 101 44 68 26 27 53 107 1 11 26 ...
##  $ r3       : num [1:146] 156 142 51 19 97 214 150 155 123 116 ...
##  $ g3       : num [1:146] 227 217 51 27 107 144 167 226 154 124 ...
##  $ b3       : num [1:146] 245 242 45 29 99 75 134 238 140 115 ...
##  $ r4       : num [1:146] 145 147 59 19 123 156 171 147 21 67 ...
##  $ g4       : num [1:146] 211 219 62 27 147 169 218 222 46 67 ...
##  $ b4       : num [1:146] 228 242 65 29 152 190 252 242 41 52 ...
##  $ r5       : num [1:146] 166 164 156 42 221 67 171 170 36 70 ...
##  $ g5       : num [1:146] 233 228 171 37 236 50 158 191 60 53 ...
##  $ b5       : num [1:146] 245 229 50 3 117 36 108 113 26 26 ...
##  $ r6       : num [1:146] 212 84 254 217 205 37 157 26 75 26 ...
##  $ g6       : num [1:146] 254 116 255 228 225 36 186 37 108 26 ...
##  $ b6       : num [1:146] 52 17 36 19 80 42 11 12 44 21 ...
##  $ r7       : num [1:146] 212 217 211 221 235 44 26 34 13 52 ...
##  $ g7       : num [1:146] 254 254 226 235 254 42 35 45 27 45 ...
##  $ b7       : num [1:146] 11 26 70 20 60 44 10 19 25 27 ...
##  $ r8       : num [1:146] 188 155 78 181 90 192 180 221 133 117 ...
##  $ g8       : num [1:146] 229 203 73 183 110 131 211 249 163 109 ...
##  $ b8       : num [1:146] 117 128 64 73 9 73 236 184 126 83 ...
##  $ r9       : num [1:146] 170 213 220 237 216 123 129 226 83 110 ...
##  $ g9       : num [1:146] 216 253 234 234 236 74 109 246 125 74 ...
##  $ b9       : num [1:146] 120 51 59 44 66 22 73 59 19 12 ...
##  $ r10      : num [1:146] 211 217 254 251 229 36 161 30 13 98 ...
##  $ g10      : num [1:146] 254 255 255 254 255 34 190 40 27 70 ...
##  $ b10      : num [1:146] 3 21 51 2 12 37 10 34 25 26 ...
##  $ r11      : num [1:146] 212 217 253 235 235 44 161 34 9 20 ...
##  $ g11      : num [1:146] 254 255 255 243 254 42 190 44 23 21 ...
##  $ b11      : num [1:146] 19 21 44 12 60 44 6 35 18 20 ...
##  $ r12      : num [1:146] 172 158 66 19 163 197 187 241 85 113 ...
##  $ g12      : num [1:146] 235 225 68 27 168 114 215 255 128 76 ...
##  $ b12      : num [1:146] 244 237 68 29 152 21 236 54 21 14 ...
##  $ r13      : num [1:146] 172 164 69 20 124 171 141 205 83 106 ...
##  $ g13      : num [1:146] 235 227 65 29 117 102 142 229 125 69 ...
##  $ b13      : num [1:146] 244 237 59 34 91 26 140 46 19 9 ...
##  $ r14      : num [1:146] 172 182 76 64 188 197 189 226 85 102 ...
##  $ g14      : num [1:146] 228 228 84 61 205 114 171 246 128 67 ...
##  $ b14      : num [1:146] 235 143 22 4 78 21 140 59 21 6 ...
##  $ r15      : num [1:146] 177 171 82 211 125 123 214 235 85 106 ...
##  $ g15      : num [1:146] 235 228 93 222 147 74 221 252 128 69 ...
##  $ b15      : num [1:146] 244 196 17 78 20 22 201 67 21 9 ...
##  $ r16      : num [1:146] 22 164 58 19 160 180 188 237 83 43 ...
##  $ g16      : num [1:146] 52 227 60 27 183 107 211 254 125 29 ...
##  $ b16      : num [1:146] 53 237 60 29 187 26 227 53 19 11 ...</code></pre>
<p>Use <code>table()</code> to count the number of observations of each sign type by passing it the column containing the labels.</p>
<div class="sourceCode" id="cb2560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2560-1"><a href="supervised-learning-classification.html#cb2560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of signs of each type</span></span>
<span id="cb2560-2"><a href="supervised-learning-classification.html#cb2560-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(signs<span class="sc">$</span>sign_type)</span></code></pre></div>
<pre><code>## 
## pedestrian      speed       stop 
##         46         49         51</code></pre>
<p>Run the provided <code>aggregate()</code> command to see whether the average red level might vary by sign type.</p>
<div class="sourceCode" id="cb2562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2562-1"><a href="supervised-learning-classification.html#cb2562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check r10&#39;s average red level by sign type</span></span>
<span id="cb2562-2"><a href="supervised-learning-classification.html#cb2562-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(r10 <span class="sc">~</span> sign_type, <span class="at">data =</span> signs, mean)</span></code></pre></div>
<pre><code>##    sign_type   r10
## 1 pedestrian 113.7
## 2      speed  80.6
## 3       stop 132.4</code></pre>
<p>As you might have expected, stop signs tend to have a higher average red value. This is how kNN identifies similar signs.</p>
</div>
<div id="classifying-a-collection-of-road-signs" class="section level4 hasAnchor" number="19.1.1.3">
<h4><span class="header-section-number">19.1.1.3</span> Classifying a collection of road signs<a href="supervised-learning-classification.html#classifying-a-collection-of-road-signs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now that the autonomous vehicle has successfully stopped on its own, your team feels confident allowing the car to continue the test course.</p>
<p>The test course includes 59 additional road signs divided into three types:</p>
<p><img src="https://assets.datacamp.com/production/course_2906/datasets/knn_stop_28.gif" alt="Stop Sign" /> <img src="https://assets.datacamp.com/production/course_2906/datasets/knn_speed_55.gif" alt="Speed Limit Sign" /> <img src="https://assets.datacamp.com/production/course_2906/datasets/knn_peds_47.gif" alt="Pedestrian Sign" /></p>
<p>At the conclusion of the trial, you are asked to measure the car’s overall performance at recognizing these signs.</p>
<p>So is the data frame <code>test_signs</code>, which holds a set of observations you’ll test your model on.</p>
<div class="sourceCode" id="cb2564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2564-1"><a href="supervised-learning-classification.html#cb2564-1" aria-hidden="true" tabindex="-1"></a><span class="co"># whole testing data</span></span>
<span id="cb2564-2"><a href="supervised-learning-classification.html#cb2564-2" aria-hidden="true" tabindex="-1"></a>test_signs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/knn_traffic_signs.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2564-3"><a href="supervised-learning-classification.html#cb2564-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">&quot;test&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2564-4"><a href="supervised-learning-classification.html#cb2564-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb2564-5"><a href="supervised-learning-classification.html#cb2564-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2564-6"><a href="supervised-learning-classification.html#cb2564-6" aria-hidden="true" tabindex="-1"></a>test_signs</span></code></pre></div>
<pre><code>## # A tibble: 59 × 49
##    sign_type     r1    g1    b1    r2    g2    b2    r3    g3    b3    r4    g4
##    &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 pedestrian   118   105    69   244   245    67   132   123    12   138   123
##  2 pedestrian   221   244   237    52    45    26   205   233   229   203   230
##  3 pedestrian    44    50    43    98    69    25   170   182   172   170   182
##  4 pedestrian    78   106   102    98   125    82    65    91    75   100   122
##  5 pedestrian   163   181   172    53    51    36   170   181   171    44    51
##  6 pedestrian   117   137   132   116   105    67    58    53    27    37    49
##  7 pedestrian   204   227   224    27    44    11   140   163   140    69    83
##  8 pedestrian    69    74    60    35    52     4    62    68    58   148   156
##  9 pedestrian   186   213   210    30    51    18   181   212   187   146   170
## 10 pedestrian    77    94    89   147   180   100   125   156    84    51    59
## # ℹ 49 more rows
## # ℹ 37 more variables: b4 &lt;dbl&gt;, r5 &lt;dbl&gt;, g5 &lt;dbl&gt;, b5 &lt;dbl&gt;, r6 &lt;dbl&gt;,
## #   g6 &lt;dbl&gt;, b6 &lt;dbl&gt;, r7 &lt;dbl&gt;, g7 &lt;dbl&gt;, b7 &lt;dbl&gt;, r8 &lt;dbl&gt;, g8 &lt;dbl&gt;,
## #   b8 &lt;dbl&gt;, r9 &lt;dbl&gt;, g9 &lt;dbl&gt;, b9 &lt;dbl&gt;, r10 &lt;dbl&gt;, g10 &lt;dbl&gt;, b10 &lt;dbl&gt;,
## #   r11 &lt;dbl&gt;, g11 &lt;dbl&gt;, b11 &lt;dbl&gt;, r12 &lt;dbl&gt;, g12 &lt;dbl&gt;, b12 &lt;dbl&gt;,
## #   r13 &lt;dbl&gt;, g13 &lt;dbl&gt;, b13 &lt;dbl&gt;, r14 &lt;dbl&gt;, g14 &lt;dbl&gt;, b14 &lt;dbl&gt;,
## #   r15 &lt;dbl&gt;, g15 &lt;dbl&gt;, b15 &lt;dbl&gt;, r16 &lt;dbl&gt;, g16 &lt;dbl&gt;, b16 &lt;dbl&gt;</code></pre>
<ul>
<li><p>Classify the <code>test_signs</code> data using <code>knn()</code>.</p>
<ul>
<li><p>Set <code>train</code> equal to the observations in <code>signs</code> <em>without</em> labels.</p></li>
<li><p>Use <code>test_signs</code> for the <code>test</code> argument, again without labels.</p></li>
<li><p>For the <code>cl</code> argument, use the vector of labels provided for you.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2566-1"><a href="supervised-learning-classification.html#cb2566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use kNN to identify the test road signs</span></span>
<span id="cb2566-2"><a href="supervised-learning-classification.html#cb2566-2" aria-hidden="true" tabindex="-1"></a>sign_types <span class="ot">&lt;-</span> signs<span class="sc">$</span>sign_type</span>
<span id="cb2566-3"><a href="supervised-learning-classification.html#cb2566-3" aria-hidden="true" tabindex="-1"></a>signs_pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">test =</span> test_signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">cl =</span> sign_types)</span></code></pre></div>
<ul>
<li><p>Use <code>table()</code> to explore the classifier’s performance at identifying the three sign types (the confusion matrix).</p>
<ul>
<li><p>Create the vector <code>signs_actual</code> by extracting the labels from <code>test_signs</code>.</p></li>
<li><p>Pass the vector of predictions and the vector of actual signs to <code>table()</code> to cross tabulate them.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2567-1"><a href="supervised-learning-classification.html#cb2567-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix of the predicted versus actual values</span></span>
<span id="cb2567-2"><a href="supervised-learning-classification.html#cb2567-2" aria-hidden="true" tabindex="-1"></a>signs_actual <span class="ot">&lt;-</span> test_signs<span class="sc">$</span>sign_type</span>
<span id="cb2567-3"><a href="supervised-learning-classification.html#cb2567-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2567-4"><a href="supervised-learning-classification.html#cb2567-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(signs_pred, signs_actual)</span></code></pre></div>
<pre><code>##             signs_actual
## signs_pred   pedestrian speed stop
##   pedestrian         19     2    0
##   speed               0    17    0
##   stop                0     2   19</code></pre>
<ul>
<li>Compute the overall accuracy of the kNN learner using the <code>mean()</code> function.</li>
</ul>
<div class="sourceCode" id="cb2569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2569-1"><a href="supervised-learning-classification.html#cb2569-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the accuracy</span></span>
<span id="cb2569-2"><a href="supervised-learning-classification.html#cb2569-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(signs_pred <span class="sc">==</span> signs_actual)</span></code></pre></div>
<pre><code>## [1] 0.932</code></pre>
<p>The confusion matrix lets you look for patterns in the classifier’s errors.</p>
</div>
</div>
<div id="k-in-knn" class="section level3 hasAnchor" number="19.1.2">
<h3><span class="header-section-number">19.1.2</span> ‘k’ in kNN<a href="supervised-learning-classification.html#k-in-knn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The letter k is a variable that specifies the number of neighbors to consider when making the classification. You can imagine it as determining the size of the neighborhoods.</p>
<p><strong>Bigger ‘k’ is not always better</strong></p>
<p><img src="image/knn_k%20.png" width="337" /></p>
<p>A <em>small k creates very small neighborhoods</em>; the classifier is able to discover very subtle patterns. As this image illustrates, you might imagine it as being able to distinguish between groups even when their boundary is somewhat “fuzzy.”</p>
<p>On the other hand, sometimes a “fuzzy” boundary is not a true pattern, but rather due to some other factor that adds randomness into the data. This is called <em>noise</em>.</p>
<p>Setting <em>k larger</em>, as this image shows, ignores some potentially-noisy points in an effort to discover a broader, <em>more general pattern</em>.</p>
<p><strong>Choosing ‘k’</strong></p>
<p>In practice, the optimal value depends on the complexity of the pattern to be learned, as well as the impact of noisy data.</p>
<p>Some suggest a rule of thumb starting with k equal to the square root of the number of observations in the training data.</p>
<div id="testing-other-k-values" class="section level4 hasAnchor" number="19.1.2.1">
<h4><span class="header-section-number">19.1.2.1</span> Testing other ‘k’ values<a href="supervised-learning-classification.html#testing-other-k-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>By default, the <code>knn()</code> function in the <code>class</code> package uses only the single nearest neighbor.</p>
<p>Setting a <code>k</code> parameter allows the algorithm to consider additional nearby neighbors. This enlarges the collection of neighbors which will vote on the predicted class.</p>
<p>Compare <code>k</code> values of 1, 7, and 15 to examine the impact on traffic sign classification accuracy.</p>
<p>Modify the <code>knn()</code> function call by setting <code>k = number</code> and again find accuracy value.</p>
<div class="sourceCode" id="cb2571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2571-1"><a href="supervised-learning-classification.html#cb2571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the accuracy of the baseline model (default k = 1)</span></span>
<span id="cb2571-2"><a href="supervised-learning-classification.html#cb2571-2" aria-hidden="true" tabindex="-1"></a>k_1 <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">test =</span> test_signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">cl =</span> sign_types)</span>
<span id="cb2571-3"><a href="supervised-learning-classification.html#cb2571-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(k_1 <span class="sc">==</span> signs_actual)</span></code></pre></div>
<pre><code>## [1] 0.932</code></pre>
<div class="sourceCode" id="cb2573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2573-1"><a href="supervised-learning-classification.html#cb2573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the above to set k = 7</span></span>
<span id="cb2573-2"><a href="supervised-learning-classification.html#cb2573-2" aria-hidden="true" tabindex="-1"></a>k_7 <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">test =</span> test_signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">cl =</span> sign_types, <span class="at">k =</span> <span class="dv">7</span>)</span>
<span id="cb2573-3"><a href="supervised-learning-classification.html#cb2573-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(k_7 <span class="sc">==</span> signs_actual)</span></code></pre></div>
<pre><code>## [1] 0.966</code></pre>
<div class="sourceCode" id="cb2575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2575-1"><a href="supervised-learning-classification.html#cb2575-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set k = 15 and compare to the above</span></span>
<span id="cb2575-2"><a href="supervised-learning-classification.html#cb2575-2" aria-hidden="true" tabindex="-1"></a>k_15 <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">test =</span> test_signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">cl =</span> sign_types, <span class="at">k =</span> <span class="dv">15</span>)</span>
<span id="cb2575-3"><a href="supervised-learning-classification.html#cb2575-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(k_15 <span class="sc">==</span> signs_actual)</span></code></pre></div>
<pre><code>## [1] 0.915</code></pre>
<p>k = 7 has the higest accurancy.</p>
</div>
<div id="seeing-how-the-neighbors-voted" class="section level4 hasAnchor" number="19.1.2.2">
<h4><span class="header-section-number">19.1.2.2</span> Seeing how the neighbors voted<a href="supervised-learning-classification.html#seeing-how-the-neighbors-voted" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When multiple nearest neighbors hold a vote, it can sometimes be useful to examine whether the voters were unanimous or widely separated.</p>
<p>For example, knowing more about the voters’ confidence in the classification could allow an autonomous vehicle to use caution in the case there is any chance at all that a stop sign is ahead.</p>
<p>Build a kNN model with the <code>prob = TRUE</code> parameter to compute the vote proportions.</p>
<div class="sourceCode" id="cb2577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2577-1"><a href="supervised-learning-classification.html#cb2577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the prob parameter to get the proportion of votes for the winning class</span></span>
<span id="cb2577-2"><a href="supervised-learning-classification.html#cb2577-2" aria-hidden="true" tabindex="-1"></a>sign_pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">test =</span> test_signs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">cl =</span> sign_types, <span class="at">k =</span> <span class="dv">7</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Use the <code>attr()</code> function to obtain the vote proportions for the predicted class. These are stored in the attribute <code>"prob"</code>.</p>
<div class="sourceCode" id="cb2578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2578-1"><a href="supervised-learning-classification.html#cb2578-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the &quot;prob&quot; attribute from the predicted classes</span></span>
<span id="cb2578-2"><a href="supervised-learning-classification.html#cb2578-2" aria-hidden="true" tabindex="-1"></a>sign_prob <span class="ot">&lt;-</span> <span class="fu">attr</span>(sign_pred, <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb2578-3"><a href="supervised-learning-classification.html#cb2578-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2578-4"><a href="supervised-learning-classification.html#cb2578-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the first several predictions</span></span>
<span id="cb2578-5"><a href="supervised-learning-classification.html#cb2578-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sign_pred)</span></code></pre></div>
<pre><code>## [1] pedestrian pedestrian pedestrian stop       pedestrian pedestrian
## Levels: pedestrian speed stop</code></pre>
<div class="sourceCode" id="cb2580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2580-1"><a href="supervised-learning-classification.html#cb2580-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the proportion of votes for the winning class</span></span>
<span id="cb2580-2"><a href="supervised-learning-classification.html#cb2580-2" aria-hidden="true" tabindex="-1"></a><span class="co"># see how the confidence varies from sign to sign</span></span>
<span id="cb2580-3"><a href="supervised-learning-classification.html#cb2580-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sign_prob)</span></code></pre></div>
<pre><code>## [1] 0.571 0.571 0.857 0.571 0.857 0.571</code></pre>
<p>Now you can get an idea of how certain your kNN learner is about its classifications.</p>
</div>
</div>
<div id="data-preparation-for-knn" class="section level3 hasAnchor" number="19.1.3">
<h3><span class="header-section-number">19.1.3</span> 1-3.Data preparation for kNN<a href="supervised-learning-classification.html#data-preparation-for-knn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>1/0 dummy variables</p></li>
<li><p>Variables with different scale: allows the features with a wider range to have more influence over the distance calculation</p>
<ul>
<li>Normalizing data: Rescaling reduces the influence of extreme values on kNN’s distance function.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2582-1"><a href="supervised-learning-classification.html#cb2582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a min-max normalize() function</span></span>
<span id="cb2582-2"><a href="supervised-learning-classification.html#cb2582-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2582-3"><a href="supervised-learning-classification.html#cb2582-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb2582-4"><a href="supervised-learning-classification.html#cb2582-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="naive-bayes" class="section level2 hasAnchor" number="19.2">
<h2><span class="header-section-number">19.2</span> Naive Bayes<a href="supervised-learning-classification.html#naive-bayes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="understanding-bayesian-methods" class="section level3 hasAnchor" number="19.2.1">
<h3><span class="header-section-number">19.2.1</span> Understanding Bayesian methods<a href="supervised-learning-classification.html#understanding-bayesian-methods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Joint probability and independent events</p>
<ul>
<li><p>The joint probability of events A and B is denoted P(A and B)</p></li>
<li><p>One event is independent of another if knowing one doesn’t give you information about how likely the other is.</p></li>
</ul></li>
<li><p>Conditional probability and dependent events</p>
<ul>
<li><p>The conditional probability of events A and B is denoted P(A | B)</p></li>
<li><p>Knowing that one occurred tells you much about the status of the other.</p></li>
<li><p><span class="math inline">\(P(A|B) = \frac{P(A\ and\ B)}{P(B)}\)</span></p></li>
</ul></li>
<li><p>Making predictions with Naive Bayes</p>
<div class="sourceCode" id="cb2583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2583-1"><a href="supervised-learning-classification.html#cb2583-1" aria-hidden="true" tabindex="-1"></a><span class="co"># building a Naive Bayes model</span></span>
<span id="cb2583-2"><a href="supervised-learning-classification.html#cb2583-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naivebayes)</span>
<span id="cb2583-3"><a href="supervised-learning-classification.html#cb2583-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">naive_bayes</span>(y <span class="sc">~</span> x, data)</span>
<span id="cb2583-4"><a href="supervised-learning-classification.html#cb2583-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2583-5"><a href="supervised-learning-classification.html#cb2583-5" aria-hidden="true" tabindex="-1"></a><span class="co"># making predictions with Naive Bayes</span></span>
<span id="cb2583-6"><a href="supervised-learning-classification.html#cb2583-6" aria-hidden="true" tabindex="-1"></a>future_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, future_conditions)</span></code></pre></div></li>
</ul>
<div id="computing-probabilities" class="section level4 hasAnchor" number="19.2.1.1">
<h4><span class="header-section-number">19.2.1.1</span> Computing probabilities<a href="supervised-learning-classification.html#computing-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Calculations like these are the basis of the Naive Bayes destination prediction model you’ll develop in later exercises.</p>
<div class="sourceCode" id="cb2584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2584-1"><a href="supervised-learning-classification.html#cb2584-1" aria-hidden="true" tabindex="-1"></a>location <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/locations.csv&quot;</span>)</span>
<span id="cb2584-2"><a href="supervised-learning-classification.html#cb2584-2" aria-hidden="true" tabindex="-1"></a>location</span></code></pre></div>
<pre><code>## # A tibble: 2,184 × 7
##    month   day weekday   daytype  hour hourtype location
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
##  1     1     4 wednesday weekday     0 night    home    
##  2     1     4 wednesday weekday     1 night    home    
##  3     1     4 wednesday weekday     2 night    home    
##  4     1     4 wednesday weekday     3 night    home    
##  5     1     4 wednesday weekday     4 night    home    
##  6     1     4 wednesday weekday     5 night    home    
##  7     1     4 wednesday weekday     6 morning  home    
##  8     1     4 wednesday weekday     7 morning  home    
##  9     1     4 wednesday weekday     8 morning  home    
## 10     1     4 wednesday weekday     9 morning  office  
## # ℹ 2,174 more rows</code></pre>
<p>The <code>where9am</code> data frame contains 91 days (thirteen weeks) worth of data in which Brett recorded his <code>location</code> at 9am each day as well as whether the <code>daytype</code> was a weekend or weekday.</p>
<div class="sourceCode" id="cb2586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2586-1"><a href="supervised-learning-classification.html#cb2586-1" aria-hidden="true" tabindex="-1"></a>where9am <span class="ot">&lt;-</span> location <span class="sc">%&gt;%</span></span>
<span id="cb2586-2"><a href="supervised-learning-classification.html#cb2586-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(hour <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2586-3"><a href="supervised-learning-classification.html#cb2586-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(daytype, location) <span class="sc">%&gt;%</span></span>
<span id="cb2586-4"><a href="supervised-learning-classification.html#cb2586-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">location =</span> <span class="fu">factor</span>(location, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;appointment&quot;</span>, <span class="st">&quot;campus&quot;</span>, <span class="st">&quot;home&quot;</span>, <span class="st">&quot;office&quot;</span>)))</span>
<span id="cb2586-5"><a href="supervised-learning-classification.html#cb2586-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2586-6"><a href="supervised-learning-classification.html#cb2586-6" aria-hidden="true" tabindex="-1"></a>where9am</span></code></pre></div>
<pre><code>## # A tibble: 91 × 2
##    daytype location   
##    &lt;chr&gt;   &lt;fct&gt;      
##  1 weekday office     
##  2 weekday office     
##  3 weekday office     
##  4 weekend home       
##  5 weekend home       
##  6 weekday campus     
##  7 weekday home       
##  8 weekday appointment
##  9 weekday office     
## 10 weekday office     
## # ℹ 81 more rows</code></pre>
<p>Using the conditional probability formula, you can compute the probability that Brett is working in the office, given that it is a weekday.</p>
<p><span class="math inline">\(P(A|B) = \frac{P(A\ and\ B)}{P(B)}\)</span></p>
<div class="sourceCode" id="cb2588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2588-1"><a href="supervised-learning-classification.html#cb2588-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute P(A) </span></span>
<span id="cb2588-2"><a href="supervised-learning-classification.html#cb2588-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Find P(office) using nrow() and subset() to count rows in the dataset and save the result as p_A.</span></span>
<span id="cb2588-3"><a href="supervised-learning-classification.html#cb2588-3" aria-hidden="true" tabindex="-1"></a>p_A <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">subset</span>(where9am, location <span class="sc">==</span> <span class="st">&quot;office&quot;</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(where9am)</span>
<span id="cb2588-4"><a href="supervised-learning-classification.html#cb2588-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2588-5"><a href="supervised-learning-classification.html#cb2588-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute P(B)</span></span>
<span id="cb2588-6"><a href="supervised-learning-classification.html#cb2588-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find P(weekday), using nrow() and subset() again, and save the result as p_B.</span></span>
<span id="cb2588-7"><a href="supervised-learning-classification.html#cb2588-7" aria-hidden="true" tabindex="-1"></a>p_B <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">subset</span>(where9am, daytype <span class="sc">==</span> <span class="st">&quot;weekday&quot;</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(where9am)</span>
<span id="cb2588-8"><a href="supervised-learning-classification.html#cb2588-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2588-9"><a href="supervised-learning-classification.html#cb2588-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the observed P(A and B)</span></span>
<span id="cb2588-10"><a href="supervised-learning-classification.html#cb2588-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Find P(office and weekday)</span></span>
<span id="cb2588-11"><a href="supervised-learning-classification.html#cb2588-11" aria-hidden="true" tabindex="-1"></a>p_AB <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">subset</span>(where9am, daytype <span class="sc">==</span> <span class="st">&quot;weekday&quot;</span> <span class="sc">&amp;</span> location <span class="sc">==</span> <span class="st">&quot;office&quot;</span>)) <span class="sc">/</span> <span class="fu">nrow</span>(where9am)</span>
<span id="cb2588-12"><a href="supervised-learning-classification.html#cb2588-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2588-13"><a href="supervised-learning-classification.html#cb2588-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute P(A | B) and print its value</span></span>
<span id="cb2588-14"><a href="supervised-learning-classification.html#cb2588-14" aria-hidden="true" tabindex="-1"></a>p_A_given_B <span class="ot">&lt;-</span> p_AB <span class="sc">/</span> p_B</span>
<span id="cb2588-15"><a href="supervised-learning-classification.html#cb2588-15" aria-hidden="true" tabindex="-1"></a>p_A_given_B</span></code></pre></div>
<pre><code>## [1] 0.6</code></pre>
<p>There is a 60% chance Brett is in the office at 9am given that it is a weekday.</p>
</div>
<div id="a-simple-naive-bayes-model" class="section level4 hasAnchor" number="19.2.1.2">
<h4><span class="header-section-number">19.2.1.2</span> A simple Naive Bayes model<a href="supervised-learning-classification.html#a-simple-naive-bayes-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The previous exercises showed that the probability that Brett is at work or at home at 9am is highly dependent on whether it is the weekend or a weekday.</p>
<p>To see this finding in action, use the <code>where9am</code> data frame to build a Naive Bayes model on the same data.</p>
<p>You can then use this model to predict the future: where does the model think that Brett will be at 9am on Thursday and at 9am on Saturday?</p>
<div class="sourceCode" id="cb2590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2590-1"><a href="supervised-learning-classification.html#cb2590-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the naivebayes package</span></span>
<span id="cb2590-2"><a href="supervised-learning-classification.html#cb2590-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naivebayes)</span></code></pre></div>
<pre><code>## naivebayes 0.9.7 loaded</code></pre>
<pre><code>## 
## Attaching package: &#39;naivebayes&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:data.table&#39;:
## 
##     tables</code></pre>
<div class="sourceCode" id="cb2594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2594-1"><a href="supervised-learning-classification.html#cb2594-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the location prediction model</span></span>
<span id="cb2594-2"><a href="supervised-learning-classification.html#cb2594-2" aria-hidden="true" tabindex="-1"></a>locmodel <span class="ot">&lt;-</span> <span class="fu">naive_bayes</span>(location <span class="sc">~</span> daytype, <span class="at">data =</span> where9am)</span></code></pre></div>
<pre><code>## Warning: naive_bayes(): Feature daytype - zero probabilities are present.
## Consider Laplace smoothing.</code></pre>
<p>Forecast the Thursday 9am location using <code>predict()</code> with the <code>thursday9am</code> object as the <code>newdata</code> argument.</p>
<div class="sourceCode" id="cb2596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2596-1"><a href="supervised-learning-classification.html#cb2596-1" aria-hidden="true" tabindex="-1"></a>thursday9am <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">daytype =</span> <span class="st">&quot;weekday&quot;</span>)</span>
<span id="cb2596-2"><a href="supervised-learning-classification.html#cb2596-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2596-3"><a href="supervised-learning-classification.html#cb2596-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict Thursday&#39;s 9am location</span></span>
<span id="cb2596-4"><a href="supervised-learning-classification.html#cb2596-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, thursday9am)</span></code></pre></div>
<pre><code>## [1] office
## Levels: appointment campus home office</code></pre>
<p>Do the same for predicting the saturday9am location.</p>
<div class="sourceCode" id="cb2598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2598-1"><a href="supervised-learning-classification.html#cb2598-1" aria-hidden="true" tabindex="-1"></a>saturday9am <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">daytype =</span> <span class="st">&quot;weekend&quot;</span>)</span>
<span id="cb2598-2"><a href="supervised-learning-classification.html#cb2598-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2598-3"><a href="supervised-learning-classification.html#cb2598-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict Saturdays&#39;s 9am location</span></span>
<span id="cb2598-4"><a href="supervised-learning-classification.html#cb2598-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, saturday9am)</span></code></pre></div>
<pre><code>## [1] home
## Levels: appointment campus home office</code></pre>
<p>Not surprisingly, Brett is most likely at the office at 9am on a Thursday, but at home at the same time on a Saturday!</p>
</div>
<div id="examining-raw-probabilities" class="section level4 hasAnchor" number="19.2.1.3">
<h4><span class="header-section-number">19.2.1.3</span> Examining “raw” probabilities<a href="supervised-learning-classification.html#examining-raw-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Typing the name of the model object provides the a <em>priori</em> (overall) and conditional probabilities of each of the model’s predictors.</p>
<p>Alternatively, R will compute the <em>posterior</em> probabilities for you if the <code>type = "prob"</code> parameter is supplied to the <code>predict()</code> function.</p>
<p>Using these methods, examine how the model’s predicted 9am location probability varies from day-to-day.</p>
<p>View the computed a priori and conditional probabilities.</p>
<div class="sourceCode" id="cb2600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2600-1"><a href="supervised-learning-classification.html#cb2600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the location prediction model</span></span>
<span id="cb2600-2"><a href="supervised-learning-classification.html#cb2600-2" aria-hidden="true" tabindex="-1"></a>locmodel</span></code></pre></div>
<pre><code>## 
## ================================== Naive Bayes ================================== 
##  
##  Call: 
## naive_bayes.formula(formula = location ~ daytype, data = where9am)
## 
## --------------------------------------------------------------------------------- 
##  
## Laplace smoothing: 0
## 
## --------------------------------------------------------------------------------- 
##  
##  A priori probabilities: 
## 
## appointment      campus        home      office 
##       0.011       0.110       0.451       0.429 
## 
## --------------------------------------------------------------------------------- 
##  
##  Tables: 
## 
## --------------------------------------------------------------------------------- 
##  ::: daytype (Bernoulli) 
## --------------------------------------------------------------------------------- 
##          
## daytype   appointment campus  home office
##   weekday       1.000  1.000 0.366  1.000
##   weekend       0.000  0.000 0.634  0.000
## 
## ---------------------------------------------------------------------------------</code></pre>
<p>See the predicted probabilities for Thursday at 9am.</p>
<div class="sourceCode" id="cb2602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2602-1"><a href="supervised-learning-classification.html#cb2602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the predicted probabilities for Thursday at 9am</span></span>
<span id="cb2602-2"><a href="supervised-learning-classification.html#cb2602-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, thursday9am, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span></code></pre></div>
<pre><code>##      appointment campus  home office
## [1,]      0.0154  0.154 0.231    0.6</code></pre>
<p>Compare these to the predicted probabilities for Saturday at 9am.</p>
<div class="sourceCode" id="cb2604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2604-1"><a href="supervised-learning-classification.html#cb2604-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the predicted probabilities for Saturday at 9am</span></span>
<span id="cb2604-2"><a href="supervised-learning-classification.html#cb2604-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, saturday9am, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span></code></pre></div>
<pre><code>##      appointment   campus  home office
## [1,]   0.0000384 0.000384 0.998 0.0015</code></pre>
<p>Notice the predicted probability of Brett being at the office on a Saturday is essentially zero.</p>
</div>
</div>
<div id="understanding-nbs-naivety" class="section level3 hasAnchor" number="19.2.2">
<h3><span class="header-section-number">19.2.2</span> Understanding NB’s “naivety”<a href="supervised-learning-classification.html#understanding-nbs-naivety" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The challenge of multiple predictors</p>
<ul>
<li>When adding more predictor, it becomes more inefficient to calculate the overlap.</li>
</ul></li>
<li><p>A “naive” simplification</p>
<ul>
<li>Naive Bayes algorithm uses a shortcut to approximate the conditional probability we hope to compute.</li>
<li>Rather than treating the problem as the intersection of all of the related events, the algorithm makes a so-called “naive” assumption about the data.
<ul>
<li><p>Specifically, it assumes that the events are independent. When events are independent, the joint probability can be computed by multiplying the individual probabilities.</p>
<p><img src="image/naive%20simplification.png" width="324" /></p></li>
</ul></li>
</ul></li>
<li><p>An “infrequent” problem</p>
<ul>
<li><p>Suppose further that one of those events has never been observed previously in combination with the outcome. And whenever zero is multiplied in a chain, the entire sequence becomes zero.</p>
<p><img src="image/naive_infrequent.png" width="368" /></p>
<ul>
<li><p>The Laplace correction</p>
<ul>
<li><p>The solution to this problem involves adding a small number, usually ‘1’, to each event and outcome combination to eliminate this veto power.</p>
<p><img src="image/naive_laplace%20correction.png" width="363" /></p></li>
<li><p>As a result, there will be at least some predicted probability for every future outcome even if it has never been seen before.</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div id="a-more-sophisticated-location-model" class="section level4 hasAnchor" number="19.2.2.1">
<h4><span class="header-section-number">19.2.2.1</span> A more sophisticated location model<a href="supervised-learning-classification.html#a-more-sophisticated-location-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>locations</code> dataset records Brett’s location every hour for 13 weeks. Each hour, the tracking information includes the <code>daytype</code> (weekend or weekday) as well as the <code>hourtype</code> (morning, afternoon, evening, or night).</p>
<p>Using this data, build a more sophisticated model to see how Brett’s predicted location not only varies by the day of week but also by the time of day.</p>
<div class="sourceCode" id="cb2606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2606-1"><a href="supervised-learning-classification.html#cb2606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a NB model of location</span></span>
<span id="cb2606-2"><a href="supervised-learning-classification.html#cb2606-2" aria-hidden="true" tabindex="-1"></a>locmodel <span class="ot">&lt;-</span> <span class="fu">naive_bayes</span>(location <span class="sc">~</span> daytype <span class="sc">+</span> hourtype, location)</span>
<span id="cb2606-3"><a href="supervised-learning-classification.html#cb2606-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2606-4"><a href="supervised-learning-classification.html#cb2606-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict Brett&#39;s location on a weekday afternoon</span></span>
<span id="cb2606-5"><a href="supervised-learning-classification.html#cb2606-5" aria-hidden="true" tabindex="-1"></a>weekday_afternoon <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">daytype =</span> <span class="st">&quot;weekday&quot;</span>, <span class="at">hourtype =</span> <span class="st">&quot;afternoon&quot;</span>)</span>
<span id="cb2606-6"><a href="supervised-learning-classification.html#cb2606-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, weekday_afternoon)</span></code></pre></div>
<pre><code>## [1] office
## Levels: appointment campus home office restaurant store theater</code></pre>
<div class="sourceCode" id="cb2608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2608-1"><a href="supervised-learning-classification.html#cb2608-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict Brett&#39;s location on a weekday evening</span></span>
<span id="cb2608-2"><a href="supervised-learning-classification.html#cb2608-2" aria-hidden="true" tabindex="-1"></a>weekday_evening <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">daytype =</span> <span class="st">&quot;weekday&quot;</span>, <span class="at">hourtype =</span> <span class="st">&quot;evening&quot;</span>)</span>
<span id="cb2608-3"><a href="supervised-learning-classification.html#cb2608-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, weekday_evening)</span></code></pre></div>
<pre><code>## [1] home
## Levels: appointment campus home office restaurant store theater</code></pre>
<p>Naive Bayes model forecasts that Brett will be at the office on a weekday afternoon and at home in the evening.</p>
</div>
<div id="preparing-for-unforeseen-circumstances" class="section level4 hasAnchor" number="19.2.2.2">
<h4><span class="header-section-number">19.2.2.2</span> Preparing for unforeseen circumstances<a href="supervised-learning-classification.html#preparing-for-unforeseen-circumstances" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While Brett was tracking his location over 13 weeks, he never went into the office during the weekend. Consequently, the joint probability of P(office and weekend) = 0.</p>
<p>Explore how this impacts the predicted probability that Brett may go to work on the weekend in the future. Additionally, you can see how using the Laplace correction will allow a small chance for these types of unforeseen circumstances.</p>
<p><code>naive_bayes(..., laplace = 1)</code></p>
<p>Output predicted probabilities for a weekend afternoon.</p>
<div class="sourceCode" id="cb2610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2610-1"><a href="supervised-learning-classification.html#cb2610-1" aria-hidden="true" tabindex="-1"></a>weekend_afternoon <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">daytype =</span> <span class="st">&quot;weekend&quot;</span>, <span class="at">hourtype =</span> <span class="st">&quot;afternoon&quot;</span>)</span>
<span id="cb2610-2"><a href="supervised-learning-classification.html#cb2610-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2610-3"><a href="supervised-learning-classification.html#cb2610-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Observe the predicted probabilities for a weekend afternoon</span></span>
<span id="cb2610-4"><a href="supervised-learning-classification.html#cb2610-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel, weekend_afternoon, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span></code></pre></div>
<pre><code>##      appointment  campus  home  office restaurant  store   theater
## [1,]      0.0246 0.00048 0.844 0.00335      0.111 0.0164 0.0000739</code></pre>
<p>Create a new naive Bayes model with the Laplace smoothing parameter set to <code>1</code>.</p>
<div class="sourceCode" id="cb2612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2612-1"><a href="supervised-learning-classification.html#cb2612-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a new model using the Laplace correction</span></span>
<span id="cb2612-2"><a href="supervised-learning-classification.html#cb2612-2" aria-hidden="true" tabindex="-1"></a>locmodel2 <span class="ot">&lt;-</span> <span class="fu">naive_bayes</span>(location <span class="sc">~</span> daytype <span class="sc">+</span> hourtype, location, <span class="at">laplace =</span> <span class="dv">1</span>)</span>
<span id="cb2612-3"><a href="supervised-learning-classification.html#cb2612-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2612-4"><a href="supervised-learning-classification.html#cb2612-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Observe the new predicted probabilities for a weekend afternoon</span></span>
<span id="cb2612-5"><a href="supervised-learning-classification.html#cb2612-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(locmodel2, weekend_afternoon, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span></code></pre></div>
<pre><code>##      appointment  campus  home  office restaurant  store theater
## [1,]      0.0201 0.00619 0.831 0.00793       0.11 0.0187 0.00634</code></pre>
<p>Adding the Laplace correction allows for the small chance that Brett might go to the office on the weekend in the future.</p>
<p>The small probability added to every outcome ensures that they are all possible even if never previously observed.</p>
</div>
</div>
</div>
<div id="logistic-regression" class="section level2 hasAnchor" number="19.3">
<h2><span class="header-section-number">19.3</span> Logistic Regression<a href="supervised-learning-classification.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="making-binary-predictions-with-regression" class="section level3 hasAnchor" number="19.3.1">
<h3><span class="header-section-number">19.3.1</span> Making binary predictions with regression<a href="supervised-learning-classification.html#making-binary-predictions-with-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Making predictions with logistic regression</strong></p>
<p><img src="image/logistic%20model_predict.png" width="429" /></p>
<p>Sometimes you may need to set this threshold (0.5) higher or lower to make the model more or less aggressive.</p>
<div id="building-simple-logistic-regression-models" class="section level4 hasAnchor" number="19.3.1.1">
<h4><span class="header-section-number">19.3.1.1</span> Building simple logistic regression models<a href="supervised-learning-classification.html#building-simple-logistic-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>donors</code> dataset contains 93,462 examples of people mailed in a fundraising solicitation for paralyzed military veterans. The <code>donated</code> column is <code>1</code> if the person made a donation in response to the mailing and <code>0</code> otherwise. This binary outcome will be the <em>dependent</em> variable for the logistic regression model.</p>
<p>The remaining columns are features of the prospective donors that may influence their donation behavior. These are the model’s <em>independent variables</em>.</p>
<div class="sourceCode" id="cb2614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2614-1"><a href="supervised-learning-classification.html#cb2614-1" aria-hidden="true" tabindex="-1"></a>donors <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/donors.csv&quot;</span>)</span>
<span id="cb2614-2"><a href="supervised-learning-classification.html#cb2614-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2614-3"><a href="supervised-learning-classification.html#cb2614-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the dataset to identify potential independent variables</span></span>
<span id="cb2614-4"><a href="supervised-learning-classification.html#cb2614-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(donors)</span></code></pre></div>
<pre><code>## Rows: 93,462
## Columns: 13
## $ donated           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ veteran           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ bad_address       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ age               &lt;dbl&gt; 60, 46, NA, 70, 78, NA, 38, NA, NA, 65, NA, 75, 72, …
## $ has_children      &lt;dbl&gt; 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1…
## $ wealth_rating     &lt;dbl&gt; 0, 3, 1, 2, 1, 0, 2, 3, 1, 0, 1, 2, 1, 0, 2, 3, 2, 0…
## $ interest_veterans &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ interest_religion &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0…
## $ pet_owner         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ catalog_shopper   &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ recency           &lt;chr&gt; &quot;CURRENT&quot;, &quot;CURRENT&quot;, &quot;CURRENT&quot;, &quot;CURRENT&quot;, &quot;CURRENT…
## $ frequency         &lt;chr&gt; &quot;FREQUENT&quot;, &quot;FREQUENT&quot;, &quot;FREQUENT&quot;, &quot;FREQUENT&quot;, &quot;FRE…
## $ money             &lt;chr&gt; &quot;MEDIUM&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;MEDIUM&quot;, &quot;MEDIUM&quot;, &quot;MED…</code></pre>
<p>Count the number of occurrences of each level of the <code>donated</code> variable.</p>
<div class="sourceCode" id="cb2616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2616-1"><a href="supervised-learning-classification.html#cb2616-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the dependent variable</span></span>
<span id="cb2616-2"><a href="supervised-learning-classification.html#cb2616-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donors<span class="sc">$</span>donated)</span></code></pre></div>
<pre><code>## 
##     0     1 
## 88751  4711</code></pre>
<p>Hypothesis about which independent variables will be predictive of the dependent variable.</p>
<ul>
<li><p>The <code>bad_address</code> column, which is set to <code>1</code> for an invalid mailing address and <code>0</code> otherwise, seems like it might reduce the chances of a donation.</p></li>
<li><p>One might suspect that religious interest (<code>interest_religion</code>)</p></li>
<li><p>Interest in veterans affairs (<code>interest_veterans</code>) would be associated with greater charitable giving.</p></li>
</ul>
<div class="sourceCode" id="cb2618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2618-1"><a href="supervised-learning-classification.html#cb2618-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the donation model</span></span>
<span id="cb2618-2"><a href="supervised-learning-classification.html#cb2618-2" aria-hidden="true" tabindex="-1"></a>donation_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb2618-3"><a href="supervised-learning-classification.html#cb2618-3" aria-hidden="true" tabindex="-1"></a>    donated <span class="sc">~</span> bad_address <span class="sc">+</span> interest_religion <span class="sc">+</span> interest_veterans, </span>
<span id="cb2618-4"><a href="supervised-learning-classification.html#cb2618-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> donors, </span>
<span id="cb2618-5"><a href="supervised-learning-classification.html#cb2618-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb2618-6"><a href="supervised-learning-classification.html#cb2618-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2618-7"><a href="supervised-learning-classification.html#cb2618-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model results</span></span>
<span id="cb2618-8"><a href="supervised-learning-classification.html#cb2618-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(donation_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = donated ~ bad_address + interest_religion + interest_veterans, 
##     family = &quot;binomial&quot;, data = donors)
## 
## Coefficients:
##                   Estimate Std. Error z value            Pr(&gt;|z|)    
## (Intercept)        -2.9514     0.0165 -178.66 &lt;0.0000000000000002 ***
## bad_address        -0.3078     0.1435   -2.15               0.032 *  
## interest_religion   0.0672     0.0507    1.33               0.185    
## interest_veterans   0.1101     0.0468    2.35               0.019 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 37330  on 93461  degrees of freedom
## Residual deviance: 37316  on 93458  degrees of freedom
## AIC: 37324
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="making-a-binary-prediction" class="section level4 hasAnchor" number="19.3.1.2">
<h4><span class="header-section-number">19.3.1.2</span> Making a binary prediction<a href="supervised-learning-classification.html#making-a-binary-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the previous exercise, you used the <code>glm()</code> function to build a logistic regression model of donor behavior.</p>
<p>By default, <code>predict()</code> outputs predictions in terms of log odds unless <code>type = "response"</code> is specified. This converts the log odds to probabilities.</p>
<p>Because a logistic regression model estimates the probability of the outcome, it is up to you to determine the threshold at which the probability implies action. One must balance the extremes of being too cautious versus being too aggressive.</p>
<div class="sourceCode" id="cb2620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2620-1"><a href="supervised-learning-classification.html#cb2620-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the donation probability</span></span>
<span id="cb2620-2"><a href="supervised-learning-classification.html#cb2620-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate each person&#39;s donation probability</span></span>
<span id="cb2620-3"><a href="supervised-learning-classification.html#cb2620-3" aria-hidden="true" tabindex="-1"></a>donors<span class="sc">$</span>donation_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(donation_model, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2620-4"><a href="supervised-learning-classification.html#cb2620-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2620-5"><a href="supervised-learning-classification.html#cb2620-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the donation probability of the average prospect</span></span>
<span id="cb2620-6"><a href="supervised-learning-classification.html#cb2620-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the actual probability that an average person would donate</span></span>
<span id="cb2620-7"><a href="supervised-learning-classification.html#cb2620-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donors<span class="sc">$</span>donated)</span></code></pre></div>
<pre><code>## [1] 0.0504</code></pre>
<p>Use <code>ifelse()</code> to predict a donation if their predicted donation probability is greater than average. Then calculate the model’s accuracy.</p>
<div class="sourceCode" id="cb2622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2622-1"><a href="supervised-learning-classification.html#cb2622-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict a donation if probability of donation is greater than average (0.0504)</span></span>
<span id="cb2622-2"><a href="supervised-learning-classification.html#cb2622-2" aria-hidden="true" tabindex="-1"></a>donors<span class="sc">$</span>donation_pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(donors<span class="sc">$</span>donation_prob <span class="sc">&gt;</span> <span class="fl">0.0504</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2622-3"><a href="supervised-learning-classification.html#cb2622-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2622-4"><a href="supervised-learning-classification.html#cb2622-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the model&#39;s accuracy</span></span>
<span id="cb2622-5"><a href="supervised-learning-classification.html#cb2622-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donors<span class="sc">$</span>donation_pred <span class="sc">==</span> donors<span class="sc">$</span>donated)</span></code></pre></div>
<pre><code>## [1] 0.795</code></pre>
<p>With an accuracy of nearly 80%, the model seems to be doing its job. But is it too good to be true? There are the limitations of accuracy.</p>
</div>
</div>
<div id="model-performance-tradeoffs" class="section level3 hasAnchor" number="19.3.2">
<h3><span class="header-section-number">19.3.2</span> Model performance tradeoffs<a href="supervised-learning-classification.html#model-performance-tradeoffs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the previous exercise illustrated, rare events create challenges for classification models. When one outcome is very rare, predicting the opposite can result in a very high accuracy.</p>
<p><strong><em>ROC curves</em></strong></p>
<p><img src="image/roc%20curve.png" width="254" /></p>
<ul>
<li><p>Provides a way to better understand a model’s ability to distinguish between positive and negative predictions the outcome of interest versus all others.</p></li>
<li><p>The ROC curve depicts the relationship between the percentage of positive examples as it relates to the percentage of the other outcomes.</p></li>
<li><p>The diagonal line is the baseline performance for a very poor model. The further another curve is away from this, the better it is performing.</p></li>
</ul>
<p><strong>Area under the ROC curve (AUC)</strong></p>
<p><img src="image/AUC.png" width="521" /></p>
<ul>
<li><p>The baseline model that is no better than random chance has an AUC = 0.5.</p></li>
<li><p>A perfect model has an AUC = 1.</p></li>
<li><p>The closer the AUC is to 1, the better.</p></li>
</ul>
<p><strong>Using AUC and ROC appropriately</strong></p>
<p>Curves of varying shapes can have the same AUC value. For this reason, it is important to look not only at the AUC but also how the shape of each curve indicates how a model is performing across the range of predictions.</p>
<p><img src="image/AUC%20ROC.png" width="241" /></p>
<p>For example, one model may do extremely well at identifying a few easy cases at first but perform poorly on more difficult cases. Another model may do just the opposite.</p>
<p>When AUC values are very close, it’s important to know more about how the model will be used.</p>
<div id="calculating-roc-curves-and-auc" class="section level4 hasAnchor" number="19.3.2.1">
<h4><span class="header-section-number">19.3.2.1</span> Calculating ROC Curves and AUC<a href="supervised-learning-classification.html#calculating-roc-curves-and-auc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Graphing the model’s performance better illustrates the tradeoff between a model that is overly aggressive and one that is overly passive.</p>
<p>Create a ROC curve with <code>roc(actual, predicted)</code> and the columns of actual and predicted donations.</p>
<div class="sourceCode" id="cb2624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2624-1"><a href="supervised-learning-classification.html#cb2624-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the pROC package</span></span>
<span id="cb2624-2"><a href="supervised-learning-classification.html#cb2624-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code></pre></div>
<pre><code>## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</code></pre>
<pre><code>## 
## Attaching package: &#39;pROC&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cov, smooth, var</code></pre>
<div class="sourceCode" id="cb2628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2628-1"><a href="supervised-learning-classification.html#cb2628-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a ROC curve</span></span>
<span id="cb2628-2"><a href="supervised-learning-classification.html#cb2628-2" aria-hidden="true" tabindex="-1"></a>ROC <span class="ot">&lt;-</span> <span class="fu">roc</span>(donors<span class="sc">$</span>donated, donors<span class="sc">$</span>donation_prob)</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<p>Use <code>plot()</code> to draw the ROC object.</p>
<div class="sourceCode" id="cb2631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2631-1"><a href="supervised-learning-classification.html#cb2631-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb2631-2"><a href="supervised-learning-classification.html#cb2631-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1003-1.png" width="672" /></p>
<p>Compute the area under the curve with <code>auc()</code>.</p>
<div class="sourceCode" id="cb2632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2632-1"><a href="supervised-learning-classification.html#cb2632-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve (AUC)</span></span>
<span id="cb2632-2"><a href="supervised-learning-classification.html#cb2632-2" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(ROC)</span></code></pre></div>
<pre><code>## Area under the curve: 0.51</code></pre>
<p>Based on this visualization, the model isn’t doing much better than baseline—a model doing nothing but making predictions at random.</p>
</div>
</div>
<div id="dummy-variables-missing-data-and-interactions" class="section level3 hasAnchor" number="19.3.3">
<h3><span class="header-section-number">19.3.3</span> Dummy variables, missing data, and interactions<a href="supervised-learning-classification.html#dummy-variables-missing-data-and-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="dummy-coding" class="section level4 hasAnchor" number="19.3.3.1">
<h4><span class="header-section-number">19.3.3.1</span> Dummy coding<a href="supervised-learning-classification.html#dummy-coding" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes a dataset contains numeric values that represent a categorical feature.</p>
<p>In the <code>donors</code> dataset, <code>wealth_rating</code> uses numbers to indicate the donor’s wealth level:</p>
<ul>
<li><p>0 = Unknown</p></li>
<li><p>1 = Low</p></li>
<li><p>2 = Medium</p></li>
<li><p>3 = High</p></li>
</ul>
<p>This exercise illustrates how to prepare this type of categorical feature and examines its impact on a logistic regression model.</p>
<ul>
<li><p>Create a factor <code>wealth_levels</code> from the numeric <code>wealth_rating</code> with labels as shown above.</p></li>
<li><p>Then, use <code>relevel()</code> to change the reference category to <code>Medium</code>. (參照組)</p></li>
<li><p>Build a logistic regression model using the column <code>wealth_levels</code> to predict <code>donated</code> and display the result with <code>summary()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb2634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2634-1"><a href="supervised-learning-classification.html#cb2634-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the wealth rating to a factor</span></span>
<span id="cb2634-2"><a href="supervised-learning-classification.html#cb2634-2" aria-hidden="true" tabindex="-1"></a>donors<span class="sc">$</span>wealth_levels <span class="ot">&lt;-</span> <span class="fu">factor</span>(donors<span class="sc">$</span>wealth_rating, </span>
<span id="cb2634-3"><a href="supervised-learning-classification.html#cb2634-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb2634-4"><a href="supervised-learning-classification.html#cb2634-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>))</span>
<span id="cb2634-5"><a href="supervised-learning-classification.html#cb2634-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2634-6"><a href="supervised-learning-classification.html#cb2634-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use relevel() to change reference category </span></span>
<span id="cb2634-7"><a href="supervised-learning-classification.html#cb2634-7" aria-hidden="true" tabindex="-1"></a>donors<span class="sc">$</span>wealth_levels <span class="ot">&lt;-</span> <span class="fu">relevel</span>(donors<span class="sc">$</span>wealth_levels, <span class="at">ref =</span> <span class="st">&quot;Medium&quot;</span>)</span>
<span id="cb2634-8"><a href="supervised-learning-classification.html#cb2634-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2634-9"><a href="supervised-learning-classification.html#cb2634-9" aria-hidden="true" tabindex="-1"></a><span class="co"># See how our factor coding impacts the model</span></span>
<span id="cb2634-10"><a href="supervised-learning-classification.html#cb2634-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(donated <span class="sc">~</span> wealth_levels, donors, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = donated ~ wealth_levels, family = &quot;binomial&quot;, data = donors)
## 
## Coefficients:
##                      Estimate Std. Error z value            Pr(&gt;|z|)    
## (Intercept)           -2.9189     0.0361  -80.77 &lt;0.0000000000000002 ***
## wealth_levelsUnknown  -0.0437     0.0424   -1.03                0.30    
## wealth_levelsLow      -0.0524     0.0533   -0.98                0.33    
## wealth_levelsHigh      0.0480     0.0477    1.01                0.31    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 37330  on 93461  degrees of freedom
## Residual deviance: 37323  on 93458  degrees of freedom
## AIC: 37331
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="handling-missing-data" class="section level4 hasAnchor" number="19.3.3.2">
<h4><span class="header-section-number">19.3.3.2</span> Handling missing data<a href="supervised-learning-classification.html#handling-missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Some of the prospective donors have missing <code>age</code> data. Unfortunately, R will exclude any cases with NA values when building a regression model.</p>
<p>One workaround is to replace, or impute, the missing values with an estimated value.</p>
<p>After doing so, you may also create a <em>missing data indicator</em> to model the possibility that cases with missing data are different in some way from those without.</p>
<div class="sourceCode" id="cb2636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2636-1"><a href="supervised-learning-classification.html#cb2636-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the average age among non-missing values</span></span>
<span id="cb2636-2"><a href="supervised-learning-classification.html#cb2636-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(donors<span class="sc">$</span>age)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##       1      48      62      62      75      98   22546</code></pre>
<p>Use <code>ifelse()</code> and the test <code>is.na(donors$age)</code> to impute the average (rounded to 2 decimal places) for cases with missing age. Be sure to also ignore <code>NA</code>s.</p>
<p>Create a binary dummy variable named <code>missing_age</code> indicating the presence of missing data using another <code>ifelse()</code> call and the same test.</p>
<div class="sourceCode" id="cb2638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2638-1"><a href="supervised-learning-classification.html#cb2638-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing age values with the mean age</span></span>
<span id="cb2638-2"><a href="supervised-learning-classification.html#cb2638-2" aria-hidden="true" tabindex="-1"></a>donors<span class="sc">$</span>imputed_age <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(donors<span class="sc">$</span>age), <span class="fl">61.65</span>, donors<span class="sc">$</span>age)</span>
<span id="cb2638-3"><a href="supervised-learning-classification.html#cb2638-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2638-4"><a href="supervised-learning-classification.html#cb2638-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create missing value indicator for age</span></span>
<span id="cb2638-5"><a href="supervised-learning-classification.html#cb2638-5" aria-hidden="true" tabindex="-1"></a>donors<span class="sc">$</span>missing_age <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(donors<span class="sc">$</span>age), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2638-6"><a href="supervised-learning-classification.html#cb2638-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2638-7"><a href="supervised-learning-classification.html#cb2638-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(donors <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, imputed_age, missing_age))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##     age imputed_age missing_age
##   &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1    60        60             0
## 2    46        46             0
## 3    NA        61.6           1
## 4    70        70             0
## 5    78        78             0
## 6    NA        61.6           1</code></pre>
<p>Sometimes missing data has to be dealt with using more complicated methods.</p>
</div>
<div id="building-a-interaction-model" class="section level4 hasAnchor" number="19.3.3.3">
<h4><span class="header-section-number">19.3.3.3</span> Building a interaction model<a href="supervised-learning-classification.html#building-a-interaction-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One of the best predictors of future giving is a history of recent, frequent, and large gifts. In marketing terms, this is known as R/F/M:</p>
<ul>
<li><p>Recency</p></li>
<li><p>Frequency</p></li>
<li><p>Money</p></li>
</ul>
<p>Donors that haven’t given both recently and frequently may be especially likely to give again; in other words, the <em>combined</em> impact of recency and frequency may be greater than the sum of the separate effects.</p>
<p>Because these predictors together have a greater impact on the dependent variable, their joint effect must be modeled as an interaction.</p>
<ul>
<li>Create a logistic regression model of <code>donated</code> as a function of <code>money</code> plus the interaction of <code>recency</code> and <code>frequency</code>.</li>
</ul>
<div class="sourceCode" id="cb2640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2640-1"><a href="supervised-learning-classification.html#cb2640-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a recency, frequency, and money (RFM) model</span></span>
<span id="cb2640-2"><a href="supervised-learning-classification.html#cb2640-2" aria-hidden="true" tabindex="-1"></a>rfm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(donated <span class="sc">~</span> money <span class="sc">+</span> recency <span class="sc">*</span> frequency, donors, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb2640-3"><a href="supervised-learning-classification.html#cb2640-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2640-4"><a href="supervised-learning-classification.html#cb2640-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the RFM model to see how the parameters were coded</span></span>
<span id="cb2640-5"><a href="supervised-learning-classification.html#cb2640-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rfm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = donated ~ money + recency * frequency, family = &quot;binomial&quot;, 
##     data = donors)
## 
## Coefficients:
##                                   Estimate Std. Error z value
## (Intercept)                        -3.0114     0.0428  -70.38
## moneyMEDIUM                         0.3619     0.0430    8.41
## recencyLAPSED                      -0.8668     0.4143   -2.09
## frequencyINFREQUENT                -0.5015     0.0311  -16.14
## recencyLAPSED:frequencyINFREQUENT   1.0179     0.5171    1.97
##                                              Pr(&gt;|z|)    
## (Intercept)                       &lt;0.0000000000000002 ***
## moneyMEDIUM                       &lt;0.0000000000000002 ***
## recencyLAPSED                                   0.036 *  
## frequencyINFREQUENT               &lt;0.0000000000000002 ***
## recencyLAPSED:frequencyINFREQUENT               0.049 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 37330  on 93461  degrees of freedom
## Residual deviance: 36938  on 93457  degrees of freedom
## AIC: 36948
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Compute the AUC for the new model with the function <code>auc()</code> and compare performance to the simpler model.</p>
<div class="sourceCode" id="cb2642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2642-1"><a href="supervised-learning-classification.html#cb2642-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predicted probabilities for the RFM model</span></span>
<span id="cb2642-2"><a href="supervised-learning-classification.html#cb2642-2" aria-hidden="true" tabindex="-1"></a>rfm_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfm_model, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2642-3"><a href="supervised-learning-classification.html#cb2642-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2642-4"><a href="supervised-learning-classification.html#cb2642-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve and find AUC for the new model</span></span>
<span id="cb2642-5"><a href="supervised-learning-classification.html#cb2642-5" aria-hidden="true" tabindex="-1"></a>ROC <span class="ot">&lt;-</span> <span class="fu">roc</span>(donors<span class="sc">$</span>donated, rfm_prob)</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb2645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2645-1"><a href="supervised-learning-classification.html#cb2645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1009-1.png" width="672" /></p>
<div class="sourceCode" id="cb2646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2646-1"><a href="supervised-learning-classification.html#cb2646-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(ROC)</span></code></pre></div>
<pre><code>## Area under the curve: 0.578</code></pre>
<p>Based on the ROC curve, you’ve confirmed that past giving patterns are certainly predictive of future giving.</p>
</div>
</div>
<div id="automatic-feature-selection" class="section level3 hasAnchor" number="19.3.4">
<h3><span class="header-section-number">19.3.4</span> Automatic feature selection<a href="supervised-learning-classification.html#automatic-feature-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Stepwise regression</strong></p>
<ul>
<li><p>Backward stepwise</p>
<ul>
<li><p>Begins with a model containing all of the predictors.</p></li>
<li><p>It then checks to see what happens when each one of the predictors is removed from the model. If removing a predictor does not substantially impact the model’s ability to predict the outcome, then it can be safely deleted.</p></li>
<li><p>At each step, the predictor that impacts the model the least is removed. This continues step-by-step until only important predictors remain.</p></li>
</ul></li>
<li><p>Forward stepwise</p>
<ul>
<li><p>Beginning with a model containing no predictors.</p></li>
<li><p>It examines each potential predictor to see which one, if any, offers the greatest improvement to the model’s predictive power.</p></li>
<li><p>Predictors are added step-by-step until no new predictors add substantial value to the model.</p></li>
</ul></li>
</ul>
<p><img src="image/stepwise%20regression.png" width="593" /></p>
<p>It is possible that the two could come to completely different conclusions about the most important predictors.</p>
<div id="building-a-stepwise-regression-model" class="section level4 hasAnchor" number="19.3.4.1">
<h4><span class="header-section-number">19.3.4.1</span> Building a stepwise regression model<a href="supervised-learning-classification.html#building-a-stepwise-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the absence of subject-matter expertise, stepwise regression can assist with the search for the most important predictors of the outcome of interest.</p>
<p>In this exercise, you will use a forward stepwise approach to add predictors to the model one-by-one until no additional benefit is seen.</p>
<ul>
<li><p>Specify the base model with no predictors.</p></li>
<li><p>Specify the model with all predictors.</p></li>
</ul>
<div class="sourceCode" id="cb2648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2648-1"><a href="supervised-learning-classification.html#cb2648-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify a null model with no predictors</span></span>
<span id="cb2648-2"><a href="supervised-learning-classification.html#cb2648-2" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(donated <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> donors, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb2648-3"><a href="supervised-learning-classification.html#cb2648-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2648-4"><a href="supervised-learning-classification.html#cb2648-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the full model using all of the potential predictors</span></span>
<span id="cb2648-5"><a href="supervised-learning-classification.html#cb2648-5" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(donated <span class="sc">~</span> ., <span class="at">data =</span> donors, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<p>Apply <code>step()</code> to these models to perform forward stepwise regression.</p>
<p><code>step(null, scope = list(lower = null, upper = full), direction = "forward")</code></p>
<div class="sourceCode" id="cb2649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2649-1"><a href="supervised-learning-classification.html#cb2649-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a forward stepwise algorithm to build a parsimonious model</span></span>
<span id="cb2649-2"><a href="supervised-learning-classification.html#cb2649-2" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(null_model, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null_model, <span class="at">upper =</span> full_model), <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=37332
## donated ~ 1</code></pre>
<pre><code>## Warning in add1.glm(fit, scope$add, scale = scale, trace = trace, k = k, :
## using the 70916/93462 rows from a combined fit</code></pre>
<pre><code>##                     Df Deviance   AIC
## + frequency          1    28502 37122
## + money              1    28621 37241
## + wealth_rating      1    28705 37326
## + has_children       1    28705 37326
## + age                1    28707 37328
## + imputed_age        1    28707 37328
## + wealth_levels      3    28704 37328
## + interest_veterans  1    28709 37330
## + donation_prob      1    28710 37330
## + donation_pred      1    28710 37330
## + catalog_shopper    1    28710 37330
## + pet_owner          1    28711 37331
## &lt;none&gt;                    28714 37332
## + interest_religion  1    28712 37333
## + recency            1    28713 37333
## + bad_address        1    28714 37334
## + veteran            1    28714 37334
## 
## Step:  AIC=37025
## donated ~ frequency</code></pre>
<pre><code>## Warning in add1.glm(fit, scope$add, scale = scale, trace = trace, k = k, :
## using the 70916/93462 rows from a combined fit</code></pre>
<pre><code>##                     Df Deviance   AIC
## + money              1    28441 36966
## + wealth_rating      1    28493 37018
## + wealth_levels      3    28490 37019
## + has_children       1    28494 37019
## + donation_prob      1    28498 37023
## + interest_veterans  1    28498 37023
## + catalog_shopper    1    28499 37024
## + donation_pred      1    28499 37024
## + age                1    28499 37024
## + imputed_age        1    28499 37024
## + pet_owner          1    28499 37024
## &lt;none&gt;                    28502 37025
## + interest_religion  1    28501 37026
## + recency            1    28501 37026
## + bad_address        1    28502 37026
## + veteran            1    28502 37027
## 
## Step:  AIC=36950
## donated ~ frequency + money</code></pre>
<pre><code>## Warning in add1.glm(fit, scope$add, scale = scale, trace = trace, k = k, :
## using the 70916/93462 rows from a combined fit</code></pre>
<pre><code>##                     Df Deviance   AIC
## + wealth_levels      3    28427 36942
## + wealth_rating      1    28431 36942
## + has_children       1    28432 36943
## + interest_veterans  1    28438 36948
## + donation_prob      1    28438 36949
## + catalog_shopper    1    28438 36949
## + donation_pred      1    28439 36949
## + age                1    28439 36949
## + imputed_age        1    28439 36949
## + pet_owner          1    28439 36949
## &lt;none&gt;                    28441 36950
## + interest_religion  1    28440 36951
## + recency            1    28440 36951
## + bad_address        1    28441 36951
## + veteran            1    28441 36952
## 
## Step:  AIC=36945
## donated ~ frequency + money + wealth_levels</code></pre>
<pre><code>## Warning in add1.glm(fit, scope$add, scale = scale, trace = trace, k = k, :
## using the 70916/93462 rows from a combined fit</code></pre>
<pre><code>##                     Df Deviance   AIC
## + has_children       1    28416 36937
## + age                1    28424 36944
## + imputed_age        1    28424 36944
## + interest_veterans  1    28424 36945
## + donation_prob      1    28424 36945
## + catalog_shopper    1    28424 36945
## + donation_pred      1    28425 36945
## &lt;none&gt;                    28427 36945
## + pet_owner          1    28425 36946
## + interest_religion  1    28426 36947
## + recency            1    28426 36947
## + bad_address        1    28427 36947
## + veteran            1    28427 36947
## 
## Step:  AIC=36938
## donated ~ frequency + money + wealth_levels + has_children</code></pre>
<pre><code>## Warning in add1.glm(fit, scope$add, scale = scale, trace = trace, k = k, :
## using the 70916/93462 rows from a combined fit</code></pre>
<pre><code>##                     Df Deviance   AIC
## + pet_owner          1    28413 36937
## + donation_prob      1    28413 36937
## + catalog_shopper    1    28413 36937
## + interest_veterans  1    28413 36937
## + donation_pred      1    28414 36938
## &lt;none&gt;                    28416 36938
## + interest_religion  1    28415 36939
## + age                1    28416 36940
## + imputed_age        1    28416 36940
## + recency            1    28416 36940
## + bad_address        1    28416 36940
## + veteran            1    28416 36940
## 
## Step:  AIC=36932
## donated ~ frequency + money + wealth_levels + has_children + 
##     pet_owner</code></pre>
<pre><code>## Warning in add1.glm(fit, scope$add, scale = scale, trace = trace, k = k, :
## using the 70916/93462 rows from a combined fit</code></pre>
<pre><code>##                     Df Deviance   AIC
## &lt;none&gt;                    28413 36932
## + donation_prob      1    28411 36932
## + interest_veterans  1    28411 36932
## + catalog_shopper    1    28412 36933
## + donation_pred      1    28412 36933
## + age                1    28412 36933
## + imputed_age        1    28412 36933
## + recency            1    28413 36934
## + interest_religion  1    28413 36934
## + bad_address        1    28413 36934
## + veteran            1    28413 36934</code></pre>
<div class="sourceCode" id="cb2663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2663-1"><a href="supervised-learning-classification.html#cb2663-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the stepwise donation probability</span></span>
<span id="cb2663-2"><a href="supervised-learning-classification.html#cb2663-2" aria-hidden="true" tabindex="-1"></a>step_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(step_model, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2663-3"><a href="supervised-learning-classification.html#cb2663-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2663-4"><a href="supervised-learning-classification.html#cb2663-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC of the stepwise model</span></span>
<span id="cb2663-5"><a href="supervised-learning-classification.html#cb2663-5" aria-hidden="true" tabindex="-1"></a>ROC <span class="ot">&lt;-</span> <span class="fu">roc</span>(donors<span class="sc">$</span>donated, step_prob)</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb2666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2666-1"><a href="supervised-learning-classification.html#cb2666-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1012-1.png" width="672" /></p>
<div class="sourceCode" id="cb2667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2667-1"><a href="supervised-learning-classification.html#cb2667-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(ROC)</span></code></pre></div>
<pre><code>## Area under the curve: 0.585</code></pre>
<p>Despite the caveats of stepwise regression, it seems to have resulted in a relatively strong model!</p>
</div>
</div>
</div>
<div id="classification-trees" class="section level2 hasAnchor" number="19.4">
<h2><span class="header-section-number">19.4</span> Classification Trees<a href="supervised-learning-classification.html#classification-trees" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="making-decisions-with-trees" class="section level3 hasAnchor" number="19.4.1">
<h3><span class="header-section-number">19.4.1</span> Making decisions with trees<a href="supervised-learning-classification.html#making-decisions-with-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>A decision tree model</strong></p>
<p><img src="image/decision%20tree%20model.png" width="502" /></p>
<ul>
<li><p>Beginning at the <em>root node</em>, data flows through if/else decision nodes that split the data according to its attributes.</p></li>
<li><p>The <em>branches</em> indicate the potential choices.</p></li>
<li><p>The <em>leaf nodes</em> denote the final decisions. These are also known as <em>terminal nodes</em> because they terminate the decision making process.</p></li>
</ul>
<p><strong>Building trees in R</strong></p>
<div class="sourceCode" id="cb2669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2669-1"><a href="supervised-learning-classification.html#cb2669-1" aria-hidden="true" tabindex="-1"></a><span class="co"># building a simple rpart classification tree</span></span>
<span id="cb2669-2"><a href="supervised-learning-classification.html#cb2669-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb2669-3"><a href="supervised-learning-classification.html#cb2669-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(y <span class="sc">~</span> x, data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb2669-4"><a href="supervised-learning-classification.html#cb2669-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2669-5"><a href="supervised-learning-classification.html#cb2669-5" aria-hidden="true" tabindex="-1"></a><span class="co"># making predictions from an rpart tree</span></span>
<span id="cb2669-6"><a href="supervised-learning-classification.html#cb2669-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, test_data, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<div id="building-a-simple-decision-tree" class="section level4 hasAnchor" number="19.4.1.1">
<h4><span class="header-section-number">19.4.1.1</span> Building a simple decision tree<a href="supervised-learning-classification.html#building-a-simple-decision-tree" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>loans</code> dataset contains 11,312 randomly-selected people who applied for and later received loans from Lending Club, a US-based peer-to-peer lending company.</p>
<p>You will use a decision tree to try to learn patterns in the outcome of these loans (either repaid or default) based on the requested loan amount and credit score at the time of application.</p>
<p>Then, see how the tree’s predictions differ for an applicant with good credit versus one with bad credit.</p>
<div class="sourceCode" id="cb2670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2670-1"><a href="supervised-learning-classification.html#cb2670-1" aria-hidden="true" tabindex="-1"></a>loans <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/loans.csv&quot;</span>)</span>
<span id="cb2670-2"><a href="supervised-learning-classification.html#cb2670-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(loans)</span></code></pre></div>
<pre><code>## Rows: 39,732
## Columns: 16
## $ keep               &lt;dbl&gt; 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, …
## $ rand               &lt;dbl&gt; 0.1305, 0.9982, 0.6283, 0.2524, 0.4745, 0.7499, 0.8…
## $ default            &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, …
## $ loan_amount        &lt;chr&gt; &quot;LOW&quot;, &quot;LOW&quot;, &quot;LOW&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;, &quot;LOW&quot;, &quot;MEDIU…
## $ emp_length         &lt;chr&gt; &quot;10+ years&quot;, &quot;&lt; 2 years&quot;, &quot;10+ years&quot;, &quot;10+ years&quot;,…
## $ home_ownership     &lt;chr&gt; &quot;RENT&quot;, &quot;RENT&quot;, &quot;RENT&quot;, &quot;RENT&quot;, &quot;RENT&quot;, &quot;RENT&quot;, &quot;RE…
## $ income             &lt;chr&gt; &quot;LOW&quot;, &quot;LOW&quot;, &quot;LOW&quot;, &quot;MEDIUM&quot;, &quot;HIGH&quot;, &quot;LOW&quot;, &quot;MEDI…
## $ loan_purpose       &lt;chr&gt; &quot;credit_card&quot;, &quot;car&quot;, &quot;small_business&quot;, &quot;other&quot;, &quot;o…
## $ debt_to_income     &lt;chr&gt; &quot;HIGH&quot;, &quot;LOW&quot;, &quot;AVERAGE&quot;, &quot;HIGH&quot;, &quot;AVERAGE&quot;, &quot;AVERA…
## $ credit_score       &lt;chr&gt; &quot;AVERAGE&quot;, &quot;AVERAGE&quot;, &quot;AVERAGE&quot;, &quot;AVERAGE&quot;, &quot;AVERAG…
## $ recent_inquiry     &lt;chr&gt; &quot;YES&quot;, &quot;YES&quot;, &quot;YES&quot;, &quot;YES&quot;, &quot;NO&quot;, &quot;YES&quot;, &quot;YES&quot;, &quot;YE…
## $ delinquent         &lt;chr&gt; &quot;NEVER&quot;, &quot;NEVER&quot;, &quot;NEVER&quot;, &quot;MORE THAN 2 YEARS AGO&quot;,…
## $ credit_accounts    &lt;chr&gt; &quot;FEW&quot;, &quot;FEW&quot;, &quot;FEW&quot;, &quot;AVERAGE&quot;, &quot;MANY&quot;, &quot;AVERAGE&quot;, …
## $ bad_public_record  &lt;chr&gt; &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO…
## $ credit_utilization &lt;chr&gt; &quot;HIGH&quot;, &quot;LOW&quot;, &quot;HIGH&quot;, &quot;LOW&quot;, &quot;MEDIUM&quot;, &quot;MEDIUM&quot;, &quot;…
## $ past_bankrupt      &lt;chr&gt; &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO…</code></pre>
<div class="sourceCode" id="cb2672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2672-1"><a href="supervised-learning-classification.html#cb2672-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup dataset</span></span>
<span id="cb2672-2"><a href="supervised-learning-classification.html#cb2672-2" aria-hidden="true" tabindex="-1"></a>loans <span class="ot">&lt;-</span> loans <span class="sc">%&gt;%</span> </span>
<span id="cb2672-3"><a href="supervised-learning-classification.html#cb2672-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(keep <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2672-4"><a href="supervised-learning-classification.html#cb2672-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">factor</span>(default, </span>
<span id="cb2672-5"><a href="supervised-learning-classification.html#cb2672-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb2672-6"><a href="supervised-learning-classification.html#cb2672-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;repaid&quot;</span>, <span class="st">&quot;default&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb2672-7"><a href="supervised-learning-classification.html#cb2672-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(keep, rand, default))</span>
<span id="cb2672-8"><a href="supervised-learning-classification.html#cb2672-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2672-9"><a href="supervised-learning-classification.html#cb2672-9" aria-hidden="true" tabindex="-1"></a>loans<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">relevel</span>(loans<span class="sc">$</span>outcome, <span class="at">ref =</span> <span class="st">&quot;default&quot;</span>)</span>
<span id="cb2672-10"><a href="supervised-learning-classification.html#cb2672-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2672-11"><a href="supervised-learning-classification.html#cb2672-11" aria-hidden="true" tabindex="-1"></a><span class="co"># view structure</span></span>
<span id="cb2672-12"><a href="supervised-learning-classification.html#cb2672-12" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(loans)</span></code></pre></div>
<pre><code>## tibble [11,312 × 14] (S3: tbl_df/tbl/data.frame)
##  $ loan_amount       : chr [1:11312] &quot;LOW&quot; &quot;LOW&quot; &quot;LOW&quot; &quot;MEDIUM&quot; ...
##  $ emp_length        : chr [1:11312] &quot;10+ years&quot; &quot;&lt; 2 years&quot; &quot;6 - 9 years&quot; &quot;2 - 5 years&quot; ...
##  $ home_ownership    : chr [1:11312] &quot;RENT&quot; &quot;RENT&quot; &quot;RENT&quot; &quot;OWN&quot; ...
##  $ income            : chr [1:11312] &quot;LOW&quot; &quot;LOW&quot; &quot;MEDIUM&quot; &quot;MEDIUM&quot; ...
##  $ loan_purpose      : chr [1:11312] &quot;credit_card&quot; &quot;car&quot; &quot;car&quot; &quot;small_business&quot; ...
##  $ debt_to_income    : chr [1:11312] &quot;HIGH&quot; &quot;LOW&quot; &quot;LOW&quot; &quot;LOW&quot; ...
##  $ credit_score      : chr [1:11312] &quot;AVERAGE&quot; &quot;AVERAGE&quot; &quot;LOW&quot; &quot;AVERAGE&quot; ...
##  $ recent_inquiry    : chr [1:11312] &quot;YES&quot; &quot;YES&quot; &quot;YES&quot; &quot;YES&quot; ...
##  $ delinquent        : chr [1:11312] &quot;NEVER&quot; &quot;NEVER&quot; &quot;NEVER&quot; &quot;NEVER&quot; ...
##  $ credit_accounts   : chr [1:11312] &quot;FEW&quot; &quot;FEW&quot; &quot;FEW&quot; &quot;AVERAGE&quot; ...
##  $ bad_public_record : chr [1:11312] &quot;NO&quot; &quot;NO&quot; &quot;NO&quot; &quot;NO&quot; ...
##  $ credit_utilization: chr [1:11312] &quot;HIGH&quot; &quot;LOW&quot; &quot;HIGH&quot; &quot;MEDIUM&quot; ...
##  $ past_bankrupt     : chr [1:11312] &quot;NO&quot; &quot;NO&quot; &quot;NO&quot; &quot;NO&quot; ...
##  $ outcome           : Factor w/ 2 levels &quot;default&quot;,&quot;repaid&quot;: 2 1 2 1 1 1 1 2 1 1 ...</code></pre>
<div class="sourceCode" id="cb2674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2674-1"><a href="supervised-learning-classification.html#cb2674-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view outcome size</span></span>
<span id="cb2674-2"><a href="supervised-learning-classification.html#cb2674-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(loans<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>## 
## default  repaid 
##    5654    5658</code></pre>
<p>Fit a decision tree model.</p>
<div class="sourceCode" id="cb2676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2676-1"><a href="supervised-learning-classification.html#cb2676-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the rpart package</span></span>
<span id="cb2676-2"><a href="supervised-learning-classification.html#cb2676-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb2676-3"><a href="supervised-learning-classification.html#cb2676-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2676-4"><a href="supervised-learning-classification.html#cb2676-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a lending model predicting loan outcome versus loan amount and credit score</span></span>
<span id="cb2676-5"><a href="supervised-learning-classification.html#cb2676-5" aria-hidden="true" tabindex="-1"></a>loan_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(outcome <span class="sc">~</span> loan_amount <span class="sc">+</span> credit_score, </span>
<span id="cb2676-6"><a href="supervised-learning-classification.html#cb2676-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> loans, </span>
<span id="cb2676-7"><a href="supervised-learning-classification.html#cb2676-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;class&quot;</span>, </span>
<span id="cb2676-8"><a href="supervised-learning-classification.html#cb2676-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="dv">0</span>))</span></code></pre></div>
<p>Use <code>predict()</code> with the resulting loan model to predict the outcome for the <code>good_credit</code> applicant.</p>
<div class="sourceCode" id="cb2677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2677-1"><a href="supervised-learning-classification.html#cb2677-1" aria-hidden="true" tabindex="-1"></a>good_credit <span class="ot">&lt;-</span> <span class="fu">head</span>(loans <span class="sc">%&gt;%</span></span>
<span id="cb2677-2"><a href="supervised-learning-classification.html#cb2677-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(home_ownership <span class="sc">==</span> <span class="st">&quot;MORTGAGE&quot;</span>), <span class="dv">1</span>) </span>
<span id="cb2677-3"><a href="supervised-learning-classification.html#cb2677-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2677-4"><a href="supervised-learning-classification.html#cb2677-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a prediction for someone with good credit</span></span>
<span id="cb2677-5"><a href="supervised-learning-classification.html#cb2677-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(loan_model, good_credit, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>##      1 
## repaid 
## Levels: default repaid</code></pre>
<p>Do the same for the <code>bad_credit</code> applicant.</p>
<div class="sourceCode" id="cb2679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2679-1"><a href="supervised-learning-classification.html#cb2679-1" aria-hidden="true" tabindex="-1"></a>bad_credit <span class="ot">&lt;-</span> <span class="fu">head</span>(loans <span class="sc">%&gt;%</span></span>
<span id="cb2679-2"><a href="supervised-learning-classification.html#cb2679-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(home_ownership <span class="sc">==</span> <span class="st">&quot;RENT&quot;</span>, debt_to_income <span class="sc">==</span> <span class="st">&quot;LOW&quot;</span>, emp_length <span class="sc">==</span> <span class="st">&quot;6 - 9 years&quot;</span>), <span class="dv">1</span>)</span>
<span id="cb2679-3"><a href="supervised-learning-classification.html#cb2679-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2679-4"><a href="supervised-learning-classification.html#cb2679-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a prediction for someone with bad credit</span></span>
<span id="cb2679-5"><a href="supervised-learning-classification.html#cb2679-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(loan_model, bad_credit, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>##       1 
## default 
## Levels: default repaid</code></pre>
</div>
<div id="visualizing-classification-trees" class="section level4 hasAnchor" number="19.4.1.2">
<h4><span class="header-section-number">19.4.1.2</span> Visualizing classification trees<a href="supervised-learning-classification.html#visualizing-classification-trees" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Due to government rules to prevent illegal discrimination, lenders are required to explain why a loan application was rejected.</p>
<p>The structure of classification trees can be depicted visually, <code>rpart.plot()</code>, which helps to understand how the tree makes its decisions.</p>
<p>Type <code>loan_model</code> to see a text representation of the classification tree.</p>
<div class="sourceCode" id="cb2681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2681-1"><a href="supervised-learning-classification.html#cb2681-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the loan_model object</span></span>
<span id="cb2681-2"><a href="supervised-learning-classification.html#cb2681-2" aria-hidden="true" tabindex="-1"></a>loan_model</span></code></pre></div>
<pre><code>## n= 11312 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##  1) root 11312 5650 repaid (0.500 0.500)  
##    2) credit_score=AVERAGE,LOW 9490 4440 default (0.532 0.468)  
##      4) credit_score=LOW 1667  631 default (0.621 0.379) *
##      5) credit_score=AVERAGE 7823 3810 default (0.513 0.487)  
##       10) loan_amount=HIGH 2472 1080 default (0.564 0.436) *
##       11) loan_amount=LOW,MEDIUM 5351 2620 repaid (0.490 0.510)  
##         22) loan_amount=LOW 1810  874 default (0.517 0.483) *
##         23) loan_amount=MEDIUM 3541 1690 repaid (0.477 0.523) *
##    3) credit_score=HIGH 1822  601 repaid (0.330 0.670) *</code></pre>
<p>Apply the <code>rpart.plot()</code> to the loan model to visualize the tree.</p>
<div class="sourceCode" id="cb2683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2683-1"><a href="supervised-learning-classification.html#cb2683-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the rpart.plot package</span></span>
<span id="cb2683-2"><a href="supervised-learning-classification.html#cb2683-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb2683-3"><a href="supervised-learning-classification.html#cb2683-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2683-4"><a href="supervised-learning-classification.html#cb2683-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the loan_model with default settings</span></span>
<span id="cb2683-5"><a href="supervised-learning-classification.html#cb2683-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(loan_model)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1019-1.png" width="672" /></p>
<p>Changing other plotting parameters.</p>
<div class="sourceCode" id="cb2684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2684-1"><a href="supervised-learning-classification.html#cb2684-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the loan_model with customized settings</span></span>
<span id="cb2684-2"><a href="supervised-learning-classification.html#cb2684-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(loan_model, </span>
<span id="cb2684-3"><a href="supervised-learning-classification.html#cb2684-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb2684-4"><a href="supervised-learning-classification.html#cb2684-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), </span>
<span id="cb2684-5"><a href="supervised-learning-classification.html#cb2684-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fallen.leaves =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1020-1.png" width="672" /></p>
</div>
</div>
<div id="growing-larger-classification-trees" class="section level3 hasAnchor" number="19.4.2">
<h3><span class="header-section-number">19.4.2</span> Growing larger classification trees<a href="supervised-learning-classification.html#growing-larger-classification-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Axis-parallel splits</strong></p>
<ul>
<li><p>Decision tree always creates axis-parallel splits (divide-and-conquer process).</p></li>
<li><p>The split that produces the purest partitions will be used first. As the tree continues to grow, it creates smaller and more homogeneous partitions.</p></li>
<li><p>However, decision tree can be overly complex.</p></li>
</ul>
<p><strong>The problem of overfitting</strong></p>
<ul>
<li><p>When a tree has grown overly large and overly complex, it may experience the problem of overfitting.</p></li>
<li><p>Rather than modeling the most important trends in the data, a tree that has been over-fitted tends to model the noise.</p></li>
<li><p>Because it perfectly classifies every training example correctly does not mean it will do so on unseen data</p></li>
</ul>
<p><strong>Evaluating model performance</strong></p>
<ul>
<li><p>train / test split dataset</p></li>
<li><p>If the tree performs much more poorly on the test set than the training set, it suggests the model may have been over-fitted.</p></li>
</ul>
<div id="creating-random-test-datasets" class="section level4 hasAnchor" number="19.4.2.1">
<h4><span class="header-section-number">19.4.2.1</span> Creating random test datasets<a href="supervised-learning-classification.html#creating-random-test-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before building a more sophisticated lending model, it is important to hold out a portion of the loan data to simulate how well it will predict the outcomes of future loan applicants.</p>
<p><img src="https://assets.datacamp.com/production/course_2906/datasets/dtree_test_set.png" width="246" /></p>
<p>The <code>sample()</code> function can be used to generate a random sample of rows to include in the training set. Simply supply it the total number of observations and the number needed for training.</p>
<p>Use the resulting vector of row IDs to subset the loans into training and testing datasets.</p>
<div class="sourceCode" id="cb2685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2685-1"><a href="supervised-learning-classification.html#cb2685-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the number of rows for training</span></span>
<span id="cb2685-2"><a href="supervised-learning-classification.html#cb2685-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(loans) <span class="sc">*</span> <span class="fl">0.75</span></span></code></pre></div>
<pre><code>## [1] 8484</code></pre>
<ul>
<li><p>Use the <code>sample()</code> function to create an integer vector of row IDs for the 75% sample. The first argument of <code>sample()</code> should be the number of rows in the data set, and the second is the number of rows you need in your training set.</p></li>
<li><p>Subset the <code>loans</code> data using the row IDs to create the training dataset. Save this as <code>loans_train</code>.</p></li>
<li><p>Subset <code>loans</code> again, but this time select all the rows that are <em>not</em> in <code>sample_rows</code>. Save this as <code>loans_test</code> .</p></li>
</ul>
<div class="sourceCode" id="cb2687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2687-1"><a href="supervised-learning-classification.html#cb2687-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a random sample of row IDs</span></span>
<span id="cb2687-2"><a href="supervised-learning-classification.html#cb2687-2" aria-hidden="true" tabindex="-1"></a>sample_rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(loans), <span class="dv">8484</span>)</span>
<span id="cb2687-3"><a href="supervised-learning-classification.html#cb2687-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2687-4"><a href="supervised-learning-classification.html#cb2687-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the training dataset</span></span>
<span id="cb2687-5"><a href="supervised-learning-classification.html#cb2687-5" aria-hidden="true" tabindex="-1"></a>loans_train <span class="ot">&lt;-</span> loans[sample_rows, ]</span>
<span id="cb2687-6"><a href="supervised-learning-classification.html#cb2687-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2687-7"><a href="supervised-learning-classification.html#cb2687-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2687-8"><a href="supervised-learning-classification.html#cb2687-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the test dataset</span></span>
<span id="cb2687-9"><a href="supervised-learning-classification.html#cb2687-9" aria-hidden="true" tabindex="-1"></a>loans_test <span class="ot">&lt;-</span> loans[<span class="sc">-</span>sample_rows, ]</span>
<span id="cb2687-10"><a href="supervised-learning-classification.html#cb2687-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2687-11"><a href="supervised-learning-classification.html#cb2687-11" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">train =</span> <span class="fu">dim</span>(loans_train), <span class="at">test =</span> <span class="fu">dim</span>(loans_test))</span></code></pre></div>
<pre><code>## $train
## [1] 8484   14
## 
## $test
## [1] 2828   14</code></pre>
</div>
<div id="building-and-evaluating-a-larger-tree" class="section level4 hasAnchor" number="19.4.2.2">
<h4><span class="header-section-number">19.4.2.2</span> Building and evaluating a larger tree<a href="supervised-learning-classification.html#building-and-evaluating-a-larger-tree" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lending Club has additional information about the applicants, such as home ownership status, length of employment, loan purpose, and past bankruptcies, that may be useful for making more accurate predictions.</p>
<p>Using all of the available applicant data, build a more sophisticated lending model using the random training dataset created previously. Then, use this model to make predictions on the testing dataset to estimate the performance of the model on future loan applications.</p>
<div class="sourceCode" id="cb2689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2689-1"><a href="supervised-learning-classification.html#cb2689-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grow a tree using all of the available applicant data</span></span>
<span id="cb2689-2"><a href="supervised-learning-classification.html#cb2689-2" aria-hidden="true" tabindex="-1"></a>loan_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(outcome <span class="sc">~</span> ., <span class="at">data =</span> loans_train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>, <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="dv">0</span>))</span>
<span id="cb2689-3"><a href="supervised-learning-classification.html#cb2689-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2689-4"><a href="supervised-learning-classification.html#cb2689-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test dataset. Don&#39;t forget the type argument.</span></span>
<span id="cb2689-5"><a href="supervised-learning-classification.html#cb2689-5" aria-hidden="true" tabindex="-1"></a>loans_test<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(loan_model, loans_test, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb2689-6"><a href="supervised-learning-classification.html#cb2689-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2689-7"><a href="supervised-learning-classification.html#cb2689-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the confusion matrix</span></span>
<span id="cb2689-8"><a href="supervised-learning-classification.html#cb2689-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(loans_test<span class="sc">$</span>pred, loans_test<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>##          
##           default repaid
##   default     789    621
##   repaid      621    797</code></pre>
<p>Compute the accuracy of the predictions.</p>
<div class="sourceCode" id="cb2691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2691-1"><a href="supervised-learning-classification.html#cb2691-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the accuracy on the test dataset</span></span>
<span id="cb2691-2"><a href="supervised-learning-classification.html#cb2691-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loans_test<span class="sc">$</span>pred <span class="sc">==</span> loans_test<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>## [1] 0.561</code></pre>
</div>
</div>
<div id="tending-to-classification-trees" class="section level3 hasAnchor" number="19.4.3">
<h3><span class="header-section-number">19.4.3</span> Tending to classification trees<a href="supervised-learning-classification.html#tending-to-classification-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Pre-pruning</strong></p>
<p><img src="image/decision%20tree_prepruning.png" width="519" /></p>
<p><strong>Post-pruning</strong></p>
<p><img src="image/decision%20tree_postpruning.png" width="494" /></p>
<div id="preventing-overgrown-trees" class="section level4 hasAnchor" number="19.4.3.1">
<h4><span class="header-section-number">19.4.3.1</span> Preventing overgrown trees<a href="supervised-learning-classification.html#preventing-overgrown-trees" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using the pre-pruning methods for early stopping, you can prevent a tree from growing too large and complex. See how the <code>rpart</code> control options for maximum tree depth and minimum split count impact the resulting tree.</p>
<p><code>rpart(..., control = rpart.control(cp, maxdepth, minsplit))</code></p>
<p>See how the test set accuracy of the simpler model compares to the original accuracy of 57%.</p>
<div class="sourceCode" id="cb2693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2693-1"><a href="supervised-learning-classification.html#cb2693-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grow a tree with maxdepth of 6</span></span>
<span id="cb2693-2"><a href="supervised-learning-classification.html#cb2693-2" aria-hidden="true" tabindex="-1"></a>loan_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(outcome <span class="sc">~</span> ., loans_train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>, </span>
<span id="cb2693-3"><a href="supervised-learning-classification.html#cb2693-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="dv">0</span>, <span class="at">maxdepth =</span> <span class="dv">6</span>))</span>
<span id="cb2693-4"><a href="supervised-learning-classification.html#cb2693-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2693-5"><a href="supervised-learning-classification.html#cb2693-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a class prediction on the test set</span></span>
<span id="cb2693-6"><a href="supervised-learning-classification.html#cb2693-6" aria-hidden="true" tabindex="-1"></a>loans_test<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(loan_model, loans_test, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb2693-7"><a href="supervised-learning-classification.html#cb2693-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2693-8"><a href="supervised-learning-classification.html#cb2693-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the accuracy of the simpler tree</span></span>
<span id="cb2693-9"><a href="supervised-learning-classification.html#cb2693-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loans_test<span class="sc">$</span>pred <span class="sc">==</span> loans_test<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>## [1] 0.588</code></pre>
<div class="sourceCode" id="cb2695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2695-1"><a href="supervised-learning-classification.html#cb2695-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Swap maxdepth for a minimum split of 500 </span></span>
<span id="cb2695-2"><a href="supervised-learning-classification.html#cb2695-2" aria-hidden="true" tabindex="-1"></a>loan_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(outcome <span class="sc">~</span> ., <span class="at">data =</span> loans_train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>, </span>
<span id="cb2695-3"><a href="supervised-learning-classification.html#cb2695-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="dv">0</span>, <span class="at">minsplit =</span> <span class="dv">500</span>))</span>
<span id="cb2695-4"><a href="supervised-learning-classification.html#cb2695-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2695-5"><a href="supervised-learning-classification.html#cb2695-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this. How does the accuracy change?</span></span>
<span id="cb2695-6"><a href="supervised-learning-classification.html#cb2695-6" aria-hidden="true" tabindex="-1"></a>loans_test<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(loan_model, loans_test, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb2695-7"><a href="supervised-learning-classification.html#cb2695-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loans_test<span class="sc">$</span>pred <span class="sc">==</span> loans_test<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>## [1] 0.606</code></pre>
<p>Creating a simpler decision tree may actually result in greater performance on the test dataset.</p>
</div>
<div id="creating-a-pruned-tree" class="section level4 hasAnchor" number="19.4.3.2">
<h4><span class="header-section-number">19.4.3.2</span> Creating a pruned tree<a href="supervised-learning-classification.html#creating-a-pruned-tree" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Stopping a tree from growing all the way can lead it to ignore some aspects of the data or miss important trends it may have discovered later.</p>
<p>By using post-pruning, you can intentionally grow a large and complex tree then prune it to be smaller and more efficient later on.</p>
<p>In this exercise, you will have the opportunity to construct a visualization of the tree’s performance versus complexity, and use this information to prune the tree to an appropriate level.</p>
<ul>
<li><p>Use all of the applicant variables and no pre-pruning to create an overly complex tree. Make sure to set <code>cp = 0</code> in <code>rpart.control()</code> to prevent pre-pruning.</p></li>
<li><p>Create a complexity plot by using <code>plotcp()</code> on the model.</p></li>
</ul>
<div class="sourceCode" id="cb2697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2697-1"><a href="supervised-learning-classification.html#cb2697-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grow an overly complex tree</span></span>
<span id="cb2697-2"><a href="supervised-learning-classification.html#cb2697-2" aria-hidden="true" tabindex="-1"></a>loan_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(outcome <span class="sc">~</span> ., loans_train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>, </span>
<span id="cb2697-3"><a href="supervised-learning-classification.html#cb2697-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="dv">0</span>))</span>
<span id="cb2697-4"><a href="supervised-learning-classification.html#cb2697-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2697-5"><a href="supervised-learning-classification.html#cb2697-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the complexity plot</span></span>
<span id="cb2697-6"><a href="supervised-learning-classification.html#cb2697-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(loan_model)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1027-1.png" width="672" /></p>
<ul>
<li><p>Based on the complexity plot, prune the tree to a complexity of 0.0014 by using the <code>prune(model, cp)</code> .</p></li>
<li><p>Compare the accuracy of the pruned tree to the original accuracy.</p></li>
</ul>
<div class="sourceCode" id="cb2698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2698-1"><a href="supervised-learning-classification.html#cb2698-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prune the tree</span></span>
<span id="cb2698-2"><a href="supervised-learning-classification.html#cb2698-2" aria-hidden="true" tabindex="-1"></a>loan_model_pruned <span class="ot">&lt;-</span> <span class="fu">prune</span>(loan_model, <span class="at">cp =</span> <span class="fl">0.0014</span>)</span>
<span id="cb2698-3"><a href="supervised-learning-classification.html#cb2698-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2698-4"><a href="supervised-learning-classification.html#cb2698-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the accuracy of the pruned tree</span></span>
<span id="cb2698-5"><a href="supervised-learning-classification.html#cb2698-5" aria-hidden="true" tabindex="-1"></a>loans_test<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(loan_model_pruned, loans_test, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb2698-6"><a href="supervised-learning-classification.html#cb2698-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loans_test<span class="sc">$</span>pred <span class="sc">==</span> loans_test<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>## [1] 0.609</code></pre>
<p>As with pre-pruning, creating a simpler tree actually improved the performance of the tree on the test dataset.</p>
</div>
</div>
<div id="seeing-the-forest-from-the-trees" class="section level3 hasAnchor" number="19.4.4">
<h3><span class="header-section-number">19.4.4</span> Seeing the forest from the trees<a href="supervised-learning-classification.html#seeing-the-forest-from-the-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Making decisions as an ensemble</strong></p>
<p><img src="image/random%20forest.png" width="481" /></p>
<ul>
<li><p>Allocating each tree a random subset of data. So, both the features and examples may differ from tree to tree.</p>
<ul>
<li>Though each tree may reflect only a narrow portion of the data, the overall consensus is strengthened by these diverse perspectives.</li>
</ul></li>
<li><p>All <em>ensemble methods</em> are based on the principle that weaker learners become stronger with teamwork.</p>
<ul>
<li><p>In a random forest, each tree is asked to make a prediction, and the group’s overall prediction is determined by a majority vote.</p></li>
<li><p>The teamwork-based approach of the random forest may help it find important trends a single tree may miss.</p></li>
</ul></li>
</ul>
<p><strong>Random forests in R</strong></p>
<div class="sourceCode" id="cb2700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2700-1"><a href="supervised-learning-classification.html#cb2700-1" aria-hidden="true" tabindex="-1"></a><span class="co"># building a simple random forest</span></span>
<span id="cb2700-2"><a href="supervised-learning-classification.html#cb2700-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb2700-3"><a href="supervised-learning-classification.html#cb2700-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(y <span class="sc">~</span> x, data,</span>
<span id="cb2700-4"><a href="supervised-learning-classification.html#cb2700-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> num, <span class="co"># number of trees in the forest</span></span>
<span id="cb2700-5"><a href="supervised-learning-classification.html#cb2700-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mtry =</span> <span class="fu">sqrt</span>(p)) <span class="co"># number of predictors (p) per tree</span></span>
<span id="cb2700-6"><a href="supervised-learning-classification.html#cb2700-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2700-7"><a href="supervised-learning-classification.html#cb2700-7" aria-hidden="true" tabindex="-1"></a><span class="co"># making predictions from a random forest</span></span>
<span id="cb2700-8"><a href="supervised-learning-classification.html#cb2700-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, test_data)</span></code></pre></div>
<div id="building-a-random-forest-model" class="section level4 hasAnchor" number="19.4.4.1">
<h4><span class="header-section-number">19.4.4.1</span> Building a random forest model<a href="supervised-learning-classification.html#building-a-random-forest-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using the <code>randomForest</code> package, build a random forest and see how it compares to the single trees you built previously.</p>
<p>Keep in mind that due to the random nature of the forest, the results may vary slightly each time you create the forest.</p>
<ul>
<li><p>Build a random forest model using all of the loan application variables.</p></li>
<li><p>Compute the accuracy of the random forest model to compare to the original tree’s accuracy.</p></li>
</ul>
<div class="sourceCode" id="cb2701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2701-1"><a href="supervised-learning-classification.html#cb2701-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the randomForest package</span></span>
<span id="cb2701-2"><a href="supervised-learning-classification.html#cb2701-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb2701-3"><a href="supervised-learning-classification.html#cb2701-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2701-4"><a href="supervised-learning-classification.html#cb2701-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a random forest model</span></span>
<span id="cb2701-5"><a href="supervised-learning-classification.html#cb2701-5" aria-hidden="true" tabindex="-1"></a>loan_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(outcome <span class="sc">~</span> ., <span class="at">data =</span> loans_train)</span>
<span id="cb2701-6"><a href="supervised-learning-classification.html#cb2701-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2701-7"><a href="supervised-learning-classification.html#cb2701-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the accuracy of the random forest</span></span>
<span id="cb2701-8"><a href="supervised-learning-classification.html#cb2701-8" aria-hidden="true" tabindex="-1"></a>loans_test<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(loan_model, loans_test)</span>
<span id="cb2701-9"><a href="supervised-learning-classification.html#cb2701-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loans_test<span class="sc">$</span>pred <span class="sc">==</span> loans_test<span class="sc">$</span>outcome)</span></code></pre></div>
<pre><code>## [1] 0.599</code></pre>
<div class="sourceCode" id="cb2703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2703-1"><a href="supervised-learning-classification.html#cb2703-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See the model</span></span>
<span id="cb2703-2"><a href="supervised-learning-classification.html#cb2703-2" aria-hidden="true" tabindex="-1"></a>loan_model</span></code></pre></div>
<pre><code>## 
## Call:
##  randomForest(formula = outcome ~ ., data = loans_train) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 3
## 
##         OOB estimate of  error rate: 41.4%
## Confusion matrix:
##         default repaid class.error
## default    2644   1600       0.377
## repaid     1913   2327       0.451</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="experimental-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="supervised-learning-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "github"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/19-Supervised-Learning-in-R-Classification.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
