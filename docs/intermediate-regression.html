<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Intermediate Regression | Data Scientist with R</title>
  <meta name="description" content="This is a notebook about the data science courses took from the datacamp." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Intermediate Regression | Data Scientist with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a notebook about the data science courses took from the datacamp." />
  <meta name="github-repo" content="yenchunnnn/CourseNote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Intermediate Regression | Data Scientist with R" />
  
  <meta name="twitter:description" content="This is a notebook about the data science courses took from the datacamp." />
  

<meta name="author" content="Yen Chun Chen" />


<meta name="date" content="2024-01-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-regression.html"/>
<link rel="next" href="sampling-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Scientist with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-arithmetic"><i class="fa fa-check"></i><b>1.1</b> Basic arithmetic</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-data-types"><i class="fa fa-check"></i><b>1.2</b> Basic data types</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vector"><i class="fa fa-check"></i><b>1.3</b> Vector</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#useful-function"><i class="fa fa-check"></i><b>1.3.1</b> Useful function</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---by-brackets-or-names"><i class="fa fa-check"></i><b>1.3.2</b> Selection - by brackets or names</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---by-comparison---operators"><i class="fa fa-check"></i><b>1.3.3</b> Selection - by comparison - operators</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---by-comparison---values"><i class="fa fa-check"></i><b>1.3.4</b> Selection - by comparison - values</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrix"><i class="fa fa-check"></i><b>1.4</b> Matrix</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#construct-function"><i class="fa fa-check"></i><b>1.4.1</b> Construct function</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#construct-by-vector"><i class="fa fa-check"></i><b>1.4.2</b> Construct by vector</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#naming-a-matrix"><i class="fa fa-check"></i><b>1.4.3</b> Naming a matrix</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#manipulating---sum-of-each-row-column"><i class="fa fa-check"></i><b>1.4.4</b> Manipulating - sum of each row &amp; column</a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#manipulating---add-columns"><i class="fa fa-check"></i><b>1.4.5</b> Manipulating - add columns</a></li>
<li class="chapter" data-level="1.4.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#manipulating---add-rows"><i class="fa fa-check"></i><b>1.4.6</b> Manipulating - add rows</a></li>
<li class="chapter" data-level="1.4.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection-of-matrix-elements"><i class="fa fa-check"></i><b>1.4.7</b> Selection of matrix elements</a></li>
<li class="chapter" data-level="1.4.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#arithmetic---1"><i class="fa fa-check"></i><b>1.4.8</b> Arithmetic - 1</a></li>
<li class="chapter" data-level="1.4.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#arithmetic---2"><i class="fa fa-check"></i><b>1.4.9</b> Arithmetic - 2</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factor"><i class="fa fa-check"></i><b>1.5</b> Factor</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#useful-function-1"><i class="fa fa-check"></i><b>1.5.1</b> Useful function</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#nominal-ordinal-categorical-variable"><i class="fa fa-check"></i><b>1.5.2</b> Nominal &amp; Ordinal categorical variable</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factor-levels"><i class="fa fa-check"></i><b>1.5.3</b> Factor levels</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#summarizing-a-factor"><i class="fa fa-check"></i><b>1.5.4</b> Summarizing a factor</a></li>
<li class="chapter" data-level="1.5.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#ordered-factors"><i class="fa fa-check"></i><b>1.5.5</b> Ordered factors</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frame"><i class="fa fa-check"></i><b>1.6</b> Data Frame</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#quick-look-at-dataset"><i class="fa fa-check"></i><b>1.6.1</b> Quick look at dataset</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-data-frame"><i class="fa fa-check"></i><b>1.6.2</b> Creating a data frame</a></li>
<li class="chapter" data-level="1.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---brackets"><i class="fa fa-check"></i><b>1.6.3</b> Selection - brackets</a></li>
<li class="chapter" data-level="1.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---names"><i class="fa fa-check"></i><b>1.6.4</b> Selection - names</a></li>
<li class="chapter" data-level="1.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection--"><i class="fa fa-check"></i><b>1.6.5</b> Selection - $</a></li>
<li class="chapter" data-level="1.6.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection---subset"><i class="fa fa-check"></i><b>1.6.6</b> Selection - subset</a></li>
<li class="chapter" data-level="1.6.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#sorting"><i class="fa fa-check"></i><b>1.6.7</b> Sorting</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#list"><i class="fa fa-check"></i><b>1.7</b> List</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-list"><i class="fa fa-check"></i><b>1.7.1</b> Creating a list</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#creating-a-named-list"><i class="fa fa-check"></i><b>1.7.2</b> Creating a named list</a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#selection"><i class="fa fa-check"></i><b>1.7.3</b> Selection</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#bring-it-all-together"><i class="fa fa-check"></i><b>1.8</b> Bring it all together</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intermediate-r.html"><a href="intermediate-r.html"><i class="fa fa-check"></i><b>2</b> Intermediate R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intermediate-r.html"><a href="intermediate-r.html#conditionals-and-control-flow"><i class="fa fa-check"></i><b>2.1</b> Conditionals and Control Flow</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intermediate-r.html"><a href="intermediate-r.html#relational-operators"><i class="fa fa-check"></i><b>2.1.1</b> Relational operators</a></li>
<li class="chapter" data-level="2.1.2" data-path="intermediate-r.html"><a href="intermediate-r.html#conditional-statements"><i class="fa fa-check"></i><b>2.1.2</b> Conditional statements</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intermediate-r.html"><a href="intermediate-r.html#loops"><i class="fa fa-check"></i><b>2.2</b> Loops</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intermediate-r.html"><a href="intermediate-r.html#while-loop"><i class="fa fa-check"></i><b>2.2.1</b> While loop</a></li>
<li class="chapter" data-level="2.2.2" data-path="intermediate-r.html"><a href="intermediate-r.html#for-loop"><i class="fa fa-check"></i><b>2.2.2</b> For loop</a></li>
<li class="chapter" data-level="2.2.3" data-path="intermediate-r.html"><a href="intermediate-r.html#bring-it-all-together-1"><i class="fa fa-check"></i><b>2.2.3</b> Bring it all together</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intermediate-r.html"><a href="intermediate-r.html#function"><i class="fa fa-check"></i><b>2.3</b> Function</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intermediate-r.html"><a href="intermediate-r.html#introduction-to-function"><i class="fa fa-check"></i><b>2.3.1</b> Introduction to function</a></li>
<li class="chapter" data-level="2.3.2" data-path="intermediate-r.html"><a href="intermediate-r.html#writing-functions"><i class="fa fa-check"></i><b>2.3.2</b> Writing functions</a></li>
<li class="chapter" data-level="2.3.3" data-path="intermediate-r.html"><a href="intermediate-r.html#packages"><i class="fa fa-check"></i><b>2.3.3</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intermediate-r.html"><a href="intermediate-r.html#the-apply-family"><i class="fa fa-check"></i><b>2.4</b> The apply family</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intermediate-r.html"><a href="intermediate-r.html#lapply"><i class="fa fa-check"></i><b>2.4.1</b> lapply</a></li>
<li class="chapter" data-level="2.4.2" data-path="intermediate-r.html"><a href="intermediate-r.html#sapply"><i class="fa fa-check"></i><b>2.4.2</b> sapply</a></li>
<li class="chapter" data-level="2.4.3" data-path="intermediate-r.html"><a href="intermediate-r.html#vapply"><i class="fa fa-check"></i><b>2.4.3</b> vapply</a></li>
<li class="chapter" data-level="2.4.4" data-path="intermediate-r.html"><a href="intermediate-r.html#lapply-vs-sapply-vs-vapply"><i class="fa fa-check"></i><b>2.4.4</b> lapply vs sapply vs vapply</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intermediate-r.html"><a href="intermediate-r.html#utilities"><i class="fa fa-check"></i><b>2.5</b> Utilities</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intermediate-r.html"><a href="intermediate-r.html#mathematical-utilities"><i class="fa fa-check"></i><b>2.5.1</b> Mathematical utilities</a></li>
<li class="chapter" data-level="2.5.2" data-path="intermediate-r.html"><a href="intermediate-r.html#data-structures-utilities"><i class="fa fa-check"></i><b>2.5.2</b> Data structures utilities</a></li>
<li class="chapter" data-level="2.5.3" data-path="intermediate-r.html"><a href="intermediate-r.html#regular-expressions"><i class="fa fa-check"></i><b>2.5.3</b> Regular Expressions</a></li>
<li class="chapter" data-level="2.5.4" data-path="intermediate-r.html"><a href="intermediate-r.html#dates-times"><i class="fa fa-check"></i><b>2.5.4</b> Dates &amp; Times</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-wrangling"><i class="fa fa-check"></i><b>3.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#load-dataset"><i class="fa fa-check"></i><b>3.1.1</b> Load dataset</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#filtering"><i class="fa fa-check"></i><b>3.1.2</b> Filtering</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#arrange"><i class="fa fa-check"></i><b>3.1.3</b> Arrange</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#mutate"><i class="fa fa-check"></i><b>3.1.4</b> Mutate</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#subset-df-variable"><i class="fa fa-check"></i><b>3.2.1</b> Subset df variable</a></li>
<li class="chapter" data-level="3.2.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#ggplot-aesthetics"><i class="fa fa-check"></i><b>3.2.2</b> ggplot aesthetics</a></li>
<li class="chapter" data-level="3.2.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#faceting"><i class="fa fa-check"></i><b>3.2.3</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#grouping-summarizing"><i class="fa fa-check"></i><b>3.3</b> Grouping &amp; summarizing</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#summarize"><i class="fa fa-check"></i><b>3.3.1</b> Summarize</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#group-by"><i class="fa fa-check"></i><b>3.3.2</b> Group by</a></li>
<li class="chapter" data-level="3.3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#visualizing-summarized-data"><i class="fa fa-check"></i><b>3.3.3</b> Visualizing summarized data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#types-of-visualizations"><i class="fa fa-check"></i><b>3.4</b> Types of visualizations</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#line-plots"><i class="fa fa-check"></i><b>3.4.1</b> Line plots</a></li>
<li class="chapter" data-level="3.4.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#bar-plots"><i class="fa fa-check"></i><b>3.4.2</b> Bar plots</a></li>
<li class="chapter" data-level="3.4.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#histograms"><i class="fa fa-check"></i><b>3.4.3</b> Histograms</a></li>
<li class="chapter" data-level="3.4.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#box-plots"><i class="fa fa-check"></i><b>3.4.4</b> Box plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#transforming-data"><i class="fa fa-check"></i><b>4.1</b> Transforming Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-manipulation.html"><a href="data-manipulation.html#exploring-data"><i class="fa fa-check"></i><b>4.1.1</b> Exploring data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#aggregating-data"><i class="fa fa-check"></i><b>4.2</b> Aggregating Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-manipulation.html"><a href="data-manipulation.html#count"><i class="fa fa-check"></i><b>4.2.1</b> Count</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manipulation.html"><a href="data-manipulation.html#group_by-summarize-ungroup"><i class="fa fa-check"></i><b>4.2.2</b> group_by, summarize, ungroup</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-manipulation.html"><a href="data-manipulation.html#slice_min-slice_max"><i class="fa fa-check"></i><b>4.2.3</b> slice_min, slice_max</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#selecting-and-transforming-data"><i class="fa fa-check"></i><b>4.3</b> Selecting and Transforming Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-manipulation.html"><a href="data-manipulation.html#select"><i class="fa fa-check"></i><b>4.3.1</b> Select</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-manipulation.html"><a href="data-manipulation.html#rename"><i class="fa fa-check"></i><b>4.3.2</b> Rename</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-manipulation.html"><a href="data-manipulation.html#transmute"><i class="fa fa-check"></i><b>4.3.3</b> Transmute</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#case-study-the-babynames-dataset"><i class="fa fa-check"></i><b>4.4</b> Case Study: The babynames Dataset</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#load-dataset-1"><i class="fa fa-check"></i><b>4.4.1</b> Load dataset</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#exploring-data-1"><i class="fa fa-check"></i><b>4.4.2</b> Exploring data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="joining-data.html"><a href="joining-data.html"><i class="fa fa-check"></i><b>5</b> Joining Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="joining-data.html"><a href="joining-data.html#inner-join"><i class="fa fa-check"></i><b>5.1</b> Inner join</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="joining-data.html"><a href="joining-data.html#join-by-keys"><i class="fa fa-check"></i><b>5.1.1</b> Join by keys</a></li>
<li class="chapter" data-level="5.1.2" data-path="joining-data.html"><a href="joining-data.html#join-with-a-one-to-many-relationship"><i class="fa fa-check"></i><b>5.1.2</b> Join with a one-to-many relationship</a></li>
<li class="chapter" data-level="5.1.3" data-path="joining-data.html"><a href="joining-data.html#join-in-either-direction"><i class="fa fa-check"></i><b>5.1.3</b> Join in either direction</a></li>
<li class="chapter" data-level="5.1.4" data-path="joining-data.html"><a href="joining-data.html#join-three-or-more-tables"><i class="fa fa-check"></i><b>5.1.4</b> Join three or more tables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="joining-data.html"><a href="joining-data.html#left-right-joins"><i class="fa fa-check"></i><b>5.2</b> Left &amp; Right Joins</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="joining-data.html"><a href="joining-data.html#left-join"><i class="fa fa-check"></i><b>5.2.1</b> Left join</a></li>
<li class="chapter" data-level="5.2.2" data-path="joining-data.html"><a href="joining-data.html#right-join"><i class="fa fa-check"></i><b>5.2.2</b> Right join</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="joining-data.html"><a href="joining-data.html#full-semi-anti-joins"><i class="fa fa-check"></i><b>5.3</b> Full, Semi &amp; Anti Joins</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="joining-data.html"><a href="joining-data.html#full-join"><i class="fa fa-check"></i><b>5.3.1</b> Full join</a></li>
<li class="chapter" data-level="5.3.2" data-path="joining-data.html"><a href="joining-data.html#semi-anti-joins"><i class="fa fa-check"></i><b>5.3.2</b> Semi &amp; Anti joins</a></li>
<li class="chapter" data-level="5.3.3" data-path="joining-data.html"><a href="joining-data.html#visualizing-set-differences"><i class="fa fa-check"></i><b>5.3.3</b> Visualizing set differences</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="joining-data.html"><a href="joining-data.html#case-study-joins-on-stack-overflow-data"><i class="fa fa-check"></i><b>5.4</b> Case study: Joins on Stack Overflow Data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="joining-data.html"><a href="joining-data.html#load-dataset-2"><i class="fa fa-check"></i><b>5.4.1</b> Load dataset</a></li>
<li class="chapter" data-level="5.4.2" data-path="joining-data.html"><a href="joining-data.html#stack-overflow-questions"><i class="fa fa-check"></i><b>5.4.2</b> Stack Overflow questions</a></li>
<li class="chapter" data-level="5.4.3" data-path="joining-data.html"><a href="joining-data.html#joining-questions-and-answers"><i class="fa fa-check"></i><b>5.4.3</b> Joining questions and answers</a></li>
<li class="chapter" data-level="5.4.4" data-path="joining-data.html"><a href="joining-data.html#the-bind_rows-verb"><i class="fa fa-check"></i><b>5.4.4</b> The bind_rows verb</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>6</b> Introduction to Statistics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#summary-statistics"><i class="fa fa-check"></i><b>6.1</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-center"><i class="fa fa-check"></i><b>6.1.1</b> Measures of center</a></li>
<li class="chapter" data-level="6.1.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-spread"><i class="fa fa-check"></i><b>6.1.2</b> Measures of spread</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#random-numbers-and-probability"><i class="fa fa-check"></i><b>6.2</b> Random Numbers and Probability</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chances"><i class="fa fa-check"></i><b>6.2.1</b> Chances</a></li>
<li class="chapter" data-level="6.2.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#discrete-distributions"><i class="fa fa-check"></i><b>6.2.2</b> Discrete distributions</a></li>
<li class="chapter" data-level="6.2.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#continuous-distributions"><i class="fa fa-check"></i><b>6.2.3</b> Continuous distributions</a></li>
<li class="chapter" data-level="6.2.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#binomial-distribution"><i class="fa fa-check"></i><b>6.2.4</b> Binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#more-distributions-central-limit-theorem"><i class="fa fa-check"></i><b>6.3</b> More Distributions &amp; Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#normal-distribution"><i class="fa fa-check"></i><b>6.3.1</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>6.3.2</b> Central limit theorem</a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#poisson-distribution"><i class="fa fa-check"></i><b>6.3.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="6.3.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#exponential-distribution"><i class="fa fa-check"></i><b>6.3.4</b> Exponential distribution</a></li>
<li class="chapter" data-level="6.3.5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#students-t-distribution"><i class="fa fa-check"></i><b>6.3.5</b> (Student’s) t-distribution</a></li>
<li class="chapter" data-level="6.3.6" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#log-normal-distribution"><i class="fa fa-check"></i><b>6.3.6</b> Log-normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation-and-experimental-design"><i class="fa fa-check"></i><b>6.4</b> Correlation and Experimental Design</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation"><i class="fa fa-check"></i><b>6.4.1</b> Correlation</a></li>
<li class="chapter" data-level="6.4.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation-caveats"><i class="fa fa-check"></i><b>6.4.2</b> Correlation caveats</a></li>
<li class="chapter" data-level="6.4.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#design-of-experiments"><i class="fa fa-check"></i><b>6.4.3</b> Design of experiments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Introduction to Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#data-columns-types-affect-plot-types"><i class="fa fa-check"></i><b>7.1.1</b> Data columns types affect plot types</a></li>
<li class="chapter" data-level="7.1.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>7.1.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="7.1.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#ggplot2-layers"><i class="fa fa-check"></i><b>7.1.3</b> ggplot2 layers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#aesthetics"><i class="fa fa-check"></i><b>7.2</b> Aesthetics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#visible-aesthetics"><i class="fa fa-check"></i><b>7.2.1</b> Visible aesthetics</a></li>
<li class="chapter" data-level="7.2.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#using-attributes"><i class="fa fa-check"></i><b>7.2.2</b> Using attributes</a></li>
<li class="chapter" data-level="7.2.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#modifying-aesthetics"><i class="fa fa-check"></i><b>7.2.3</b> Modifying aesthetics</a></li>
<li class="chapter" data-level="7.2.4" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#aesthetics-best-practices"><i class="fa fa-check"></i><b>7.2.4</b> Aesthetics best practices</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#geometries"><i class="fa fa-check"></i><b>7.3</b> Geometries</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>7.3.1</b> Scatter plots</a></li>
<li class="chapter" data-level="7.3.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#histograms-1"><i class="fa fa-check"></i><b>7.3.2</b> Histograms</a></li>
<li class="chapter" data-level="7.3.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#bar-plots-1"><i class="fa fa-check"></i><b>7.3.3</b> Bar plots</a></li>
<li class="chapter" data-level="7.3.4" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#line-plots-1"><i class="fa fa-check"></i><b>7.3.4</b> Line plots</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>7.4</b> Themes</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#themes-from-scratch"><i class="fa fa-check"></i><b>7.4.1</b> Themes from scratch</a></li>
<li class="chapter" data-level="7.4.2" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#theme-flexibility"><i class="fa fa-check"></i><b>7.4.2</b> Theme flexibility</a></li>
<li class="chapter" data-level="7.4.3" data-path="introduction-to-data-visualization-with-ggplot2.html"><a href="introduction-to-data-visualization-with-ggplot2.html#effective-explanatory-plots"><i class="fa fa-check"></i><b>7.4.3</b> Effective explanatory plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>8</b> Intermediate Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#statistics"><i class="fa fa-check"></i><b>8.1</b> Statistics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#stats-with-geoms"><i class="fa fa-check"></i><b>8.1.1</b> Stats with geoms</a></li>
<li class="chapter" data-level="8.1.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#stats-sum-quantile"><i class="fa fa-check"></i><b>8.1.2</b> Stats: sum &amp; quantile</a></li>
<li class="chapter" data-level="8.1.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#stats-outside-geoms"><i class="fa fa-check"></i><b>8.1.3</b> Stats outside geoms</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#coordinates"><i class="fa fa-check"></i><b>8.2</b> Coordinates</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#coordinates-layer"><i class="fa fa-check"></i><b>8.2.1</b> Coordinates layer</a></li>
<li class="chapter" data-level="8.2.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#coordinates-vs.-scales"><i class="fa fa-check"></i><b>8.2.2</b> Coordinates vs. scales</a></li>
<li class="chapter" data-level="8.2.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#double-flipped-axes"><i class="fa fa-check"></i><b>8.2.3</b> Double &amp; flipped axes</a></li>
<li class="chapter" data-level="8.2.4" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#polar-coordinates"><i class="fa fa-check"></i><b>8.2.4</b> Polar coordinates</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>8.3</b> Facets</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#the-facets-layer"><i class="fa fa-check"></i><b>8.3.1</b> The facets layer</a></li>
<li class="chapter" data-level="8.3.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facet-labels-order"><i class="fa fa-check"></i><b>8.3.2</b> Facet labels &amp; order</a></li>
<li class="chapter" data-level="8.3.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facet-plotting-spaces"><i class="fa fa-check"></i><b>8.3.3</b> Facet plotting spaces</a></li>
<li class="chapter" data-level="8.3.4" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#facet-wrap-margins"><i class="fa fa-check"></i><b>8.3.4</b> Facet wrap &amp; margins</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#best-practices"><i class="fa fa-check"></i><b>8.4</b> Best Practices</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#bar-plots-2"><i class="fa fa-check"></i><b>8.4.1</b> Bar plots</a></li>
<li class="chapter" data-level="8.4.2" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#heatmaps-use-case-scenario"><i class="fa fa-check"></i><b>8.4.2</b> Heatmaps use case scenario</a></li>
<li class="chapter" data-level="8.4.3" data-path="intermediate-data-visualization-with-ggplot2.html"><a href="intermediate-data-visualization-with-ggplot2.html#when-good-data-makes-bad-plots"><i class="fa fa-check"></i><b>8.4.3</b> When good data makes bad plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html"><i class="fa fa-check"></i><b>9</b> Introduction to Importing Data in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#flat-files-with-utils"><i class="fa fa-check"></i><b>9.1</b> Flat files with utils</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#read.csv"><i class="fa fa-check"></i><b>9.1.1</b> read.csv</a></li>
<li class="chapter" data-level="9.1.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#read.delim"><i class="fa fa-check"></i><b>9.1.2</b> read.delim</a></li>
<li class="chapter" data-level="9.1.3" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#read.table"><i class="fa fa-check"></i><b>9.1.3</b> read.table</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#readr-data.table"><i class="fa fa-check"></i><b>9.2</b> readr &amp; data.table</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#readr"><i class="fa fa-check"></i><b>9.2.1</b> readr</a></li>
<li class="chapter" data-level="9.2.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#data.table"><i class="fa fa-check"></i><b>9.2.2</b> data.table</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#excel-data"><i class="fa fa-check"></i><b>9.3</b> Excel data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#list-the-sheets-of-xls-file"><i class="fa fa-check"></i><b>9.3.1</b> List the sheets of xls file</a></li>
<li class="chapter" data-level="9.3.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#import-an-excel-sheet"><i class="fa fa-check"></i><b>9.3.2</b> Import an Excel sheet</a></li>
<li class="chapter" data-level="9.3.3" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#col_names-skip-argument"><i class="fa fa-check"></i><b>9.3.3</b> col_names &amp; skip argument</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#reproducible-excel-work---xlconnect"><i class="fa fa-check"></i><b>9.4</b> Reproducible Excel work - XLConnect</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#adapting-sheets"><i class="fa fa-check"></i><b>9.4.1</b> Adapting sheets</a></li>
<li class="chapter" data-level="9.4.2" data-path="introduction-to-importing-data-in-r.html"><a href="introduction-to-importing-data-in-r.html#adapting-sheets-1"><i class="fa fa-check"></i><b>9.4.2</b> Adapting sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html"><i class="fa fa-check"></i><b>10</b> Cleaning Data in R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#common-data-problems"><i class="fa fa-check"></i><b>10.1</b> Common Data Problems</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#data-type-constraints"><i class="fa fa-check"></i><b>10.1.1</b> Data type constraints</a></li>
<li class="chapter" data-level="10.1.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#range-constraints"><i class="fa fa-check"></i><b>10.1.2</b> Range constraints</a></li>
<li class="chapter" data-level="10.1.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#uniqueness-constraints"><i class="fa fa-check"></i><b>10.1.3</b> Uniqueness constraints</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#categorical-and-text-data"><i class="fa fa-check"></i><b>10.2</b> Categorical and Text Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#checking-membership"><i class="fa fa-check"></i><b>10.2.1</b> Checking membership</a></li>
<li class="chapter" data-level="10.2.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#categorical-data-problems"><i class="fa fa-check"></i><b>10.2.2</b> Categorical data problems</a></li>
<li class="chapter" data-level="10.2.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#cleaning-text-data"><i class="fa fa-check"></i><b>10.2.3</b> Cleaning text data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#advanced-data-problems"><i class="fa fa-check"></i><b>10.3</b> Advanced Data Problems</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#uniformity"><i class="fa fa-check"></i><b>10.3.1</b> Uniformity</a></li>
<li class="chapter" data-level="10.3.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#cross-field-validation"><i class="fa fa-check"></i><b>10.3.2</b> Cross field validation</a></li>
<li class="chapter" data-level="10.3.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#completeness"><i class="fa fa-check"></i><b>10.3.3</b> Completeness</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#record-linkage"><i class="fa fa-check"></i><b>10.4</b> Record Linkage</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#comparing-strings"><i class="fa fa-check"></i><b>10.4.1</b> Comparing strings</a></li>
<li class="chapter" data-level="10.4.2" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#generating-and-comparing-pairs"><i class="fa fa-check"></i><b>10.4.2</b> Generating and comparing pairs</a></li>
<li class="chapter" data-level="10.4.3" data-path="cleaning-data-in-r.html"><a href="cleaning-data-in-r.html#scoring-and-linking"><i class="fa fa-check"></i><b>10.4.3</b> Scoring and linking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html"><i class="fa fa-check"></i><b>11</b> Working with Dates and Times in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#dates-and-times-in-r"><i class="fa fa-check"></i><b>11.1</b> Dates and Times in R</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#introduction-to-dates"><i class="fa fa-check"></i><b>11.1.1</b> Introduction to dates</a></li>
<li class="chapter" data-level="11.1.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#why-use-dates"><i class="fa fa-check"></i><b>11.1.2</b> Why use dates?</a></li>
<li class="chapter" data-level="11.1.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#what-about-times"><i class="fa fa-check"></i><b>11.1.3</b> What about times?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#parsing-manipulating-with-lubridate"><i class="fa fa-check"></i><b>11.2</b> Parsing &amp; Manipulating with lubridate</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#parsing-dates"><i class="fa fa-check"></i><b>11.2.1</b> Parsing dates</a></li>
<li class="chapter" data-level="11.2.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#manipulating-dates"><i class="fa fa-check"></i><b>11.2.2</b> Manipulating dates</a></li>
<li class="chapter" data-level="11.2.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#extracting-parts-of-a-datetime"><i class="fa fa-check"></i><b>11.2.3</b> Extracting parts of a datetime</a></li>
<li class="chapter" data-level="11.2.4" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#rounding-datetimes"><i class="fa fa-check"></i><b>11.2.4</b> Rounding datetimes</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#arithmetic-with-dates-and-times"><i class="fa fa-check"></i><b>11.3</b> Arithmetic with Dates and Times</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#taking-differences-of-datetimes"><i class="fa fa-check"></i><b>11.3.1</b> Taking differences of datetimes</a></li>
<li class="chapter" data-level="11.3.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#time-spans"><i class="fa fa-check"></i><b>11.3.2</b> Time spans</a></li>
<li class="chapter" data-level="11.3.3" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#intervals"><i class="fa fa-check"></i><b>11.3.3</b> Intervals</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#problems-in-practice"><i class="fa fa-check"></i><b>11.4</b> Problems in practice</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#time-zones"><i class="fa fa-check"></i><b>11.4.1</b> Time zones</a></li>
<li class="chapter" data-level="11.4.2" data-path="working-with-dates-and-times-in-r.html"><a href="working-with-dates-and-times-in-r.html#more-on-import-and-export-datetimes"><i class="fa fa-check"></i><b>11.4.2</b> More on import and export datetimes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html"><i class="fa fa-check"></i><b>12</b> Introduction to Writing Functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#write-a-function"><i class="fa fa-check"></i><b>12.1</b> Write a Function</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#why-write-function"><i class="fa fa-check"></i><b>12.1.1</b> Why write function?</a></li>
<li class="chapter" data-level="12.1.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#convert-scripts-into-functions"><i class="fa fa-check"></i><b>12.1.2</b> Convert scripts into functions</a></li>
<li class="chapter" data-level="12.1.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#readable-code"><i class="fa fa-check"></i><b>12.1.3</b> Readable code</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#all-about-arguments"><i class="fa fa-check"></i><b>12.2</b> All About Arguments</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#default-arguments"><i class="fa fa-check"></i><b>12.2.1</b> Default arguments</a></li>
<li class="chapter" data-level="12.2.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#pass-arguments-between-functions"><i class="fa fa-check"></i><b>12.2.2</b> Pass arguments between functions</a></li>
<li class="chapter" data-level="12.2.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#checking-arguments"><i class="fa fa-check"></i><b>12.2.3</b> Checking arguments</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#return-values-and-scope"><i class="fa fa-check"></i><b>12.3</b> Return Values and Scope</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#returning-values"><i class="fa fa-check"></i><b>12.3.1</b> Returning values</a></li>
<li class="chapter" data-level="12.3.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#return-multiple-values"><i class="fa fa-check"></i><b>12.3.2</b> Return multiple values</a></li>
<li class="chapter" data-level="12.3.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#environments"><i class="fa fa-check"></i><b>12.3.3</b> Environments</a></li>
<li class="chapter" data-level="12.3.4" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#scope-and-precedence"><i class="fa fa-check"></i><b>12.3.4</b> Scope and precedence</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#case-study-on-grain-yields"><i class="fa fa-check"></i><b>12.4</b> Case Study on Grain Yields</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#grain-yields-unit-conversion"><i class="fa fa-check"></i><b>12.4.1</b> Grain yields &amp; unit conversion</a></li>
<li class="chapter" data-level="12.4.2" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#visualizing-grain-yields"><i class="fa fa-check"></i><b>12.4.2</b> Visualizing grain yields</a></li>
<li class="chapter" data-level="12.4.3" data-path="introduction-to-writing-functions.html"><a href="introduction-to-writing-functions.html#modeling-grain-yields"><i class="fa fa-check"></i><b>12.4.3</b> Modeling grain yields</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html"><i class="fa fa-check"></i><b>13</b> Exploratory Data Analysis in R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#exploring-categorical-data"><i class="fa fa-check"></i><b>13.1</b> Exploring Categorical Data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#categorical-data"><i class="fa fa-check"></i><b>13.1.1</b> Categorical data</a></li>
<li class="chapter" data-level="13.1.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#counts-vs.-proportions"><i class="fa fa-check"></i><b>13.1.2</b> Counts vs. proportions</a></li>
<li class="chapter" data-level="13.1.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#distribution-of-one-variable"><i class="fa fa-check"></i><b>13.1.3</b> Distribution of one variable</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#exploring-numerical-data"><i class="fa fa-check"></i><b>13.2</b> Exploring numerical data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#numerical-data"><i class="fa fa-check"></i><b>13.2.1</b> Numerical Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#distribution-of-one-variable-1"><i class="fa fa-check"></i><b>13.2.2</b> Distribution of one variable</a></li>
<li class="chapter" data-level="13.2.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#box-plots-1"><i class="fa fa-check"></i><b>13.2.3</b> Box plots</a></li>
<li class="chapter" data-level="13.2.4" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#visual-in-higher-dimensions"><i class="fa fa-check"></i><b>13.2.4</b> Visual in higher dimensions</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#numerical-summaries"><i class="fa fa-check"></i><b>13.3</b> Numerical Summaries</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#measures-of-center-1"><i class="fa fa-check"></i><b>13.3.1</b> Measures of center</a></li>
<li class="chapter" data-level="13.3.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#measures-of-variability"><i class="fa fa-check"></i><b>13.3.2</b> Measures of variability</a></li>
<li class="chapter" data-level="13.3.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#shape-transformations"><i class="fa fa-check"></i><b>13.3.3</b> Shape &amp; transformations</a></li>
<li class="chapter" data-level="13.3.4" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#outliers"><i class="fa fa-check"></i><b>13.3.4</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#case-study"><i class="fa fa-check"></i><b>13.4</b> Case Study</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#new-data"><i class="fa fa-check"></i><b>13.4.1</b> New data</a></li>
<li class="chapter" data-level="13.4.2" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#check-in-1"><i class="fa fa-check"></i><b>13.4.2</b> Check-in 1</a></li>
<li class="chapter" data-level="13.4.3" data-path="exploratory-data-analysis-in-r.html"><a href="exploratory-data-analysis-in-r.html#check-in-2"><i class="fa fa-check"></i><b>13.4.3</b> Check-in 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html"><i class="fa fa-check"></i><b>14</b> Introduction to Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>14.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#tale-of-two-variables"><i class="fa fa-check"></i><b>14.1.1</b> Tale of two variables</a></li>
<li class="chapter" data-level="14.1.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#fitting-a-linear-regression"><i class="fa fa-check"></i><b>14.1.2</b> Fitting a linear regression</a></li>
<li class="chapter" data-level="14.1.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#categorical-explanatory-variables"><i class="fa fa-check"></i><b>14.1.3</b> Categorical explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#predictions-model-objects"><i class="fa fa-check"></i><b>14.2</b> Predictions &amp; model objects</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#making-predictions"><i class="fa fa-check"></i><b>14.2.1</b> Making predictions</a></li>
<li class="chapter" data-level="14.2.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#working-with-model-objects"><i class="fa fa-check"></i><b>14.2.2</b> Working with model objects</a></li>
<li class="chapter" data-level="14.2.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#regression-to-the-mean"><i class="fa fa-check"></i><b>14.2.3</b> Regression to the mean</a></li>
<li class="chapter" data-level="14.2.4" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#transforming-variables"><i class="fa fa-check"></i><b>14.2.4</b> Transforming variables</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#assessing-model-fit"><i class="fa fa-check"></i><b>14.3</b> Assessing model fit</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#quantifying-model-fit"><i class="fa fa-check"></i><b>14.3.1</b> Quantifying model fit</a></li>
<li class="chapter" data-level="14.3.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#visualizing-model-fit"><i class="fa fa-check"></i><b>14.3.2</b> Visualizing model fit</a></li>
<li class="chapter" data-level="14.3.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#outliers-leverage-influence"><i class="fa fa-check"></i><b>14.3.3</b> Outliers, leverage, influence</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#simple-logistic-regression"><i class="fa fa-check"></i><b>14.4</b> Simple logistic regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#why-need-logistic-regression"><i class="fa fa-check"></i><b>14.4.1</b> Why need logistic regression</a></li>
<li class="chapter" data-level="14.4.2" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#predictions-odds-ratios"><i class="fa fa-check"></i><b>14.4.2</b> Predictions &amp; odds ratios</a></li>
<li class="chapter" data-level="14.4.3" data-path="introduction-to-regression.html"><a href="introduction-to-regression.html#quantify-logistic-regression-fit"><i class="fa fa-check"></i><b>14.4.3</b> Quantify logistic regression fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intermediate-regression.html"><a href="intermediate-regression.html"><i class="fa fa-check"></i><b>15</b> Intermediate Regression</a>
<ul>
<li class="chapter" data-level="15.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#parallel-slopes"><i class="fa fa-check"></i><b>15.1</b> Parallel Slopes</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#parallel-slopes-linear-regression"><i class="fa fa-check"></i><b>15.1.1</b> Parallel slopes linear regression</a></li>
<li class="chapter" data-level="15.1.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#predicting-parallel-slopes"><i class="fa fa-check"></i><b>15.1.2</b> Predicting parallel slopes</a></li>
<li class="chapter" data-level="15.1.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#assessing-model-performance"><i class="fa fa-check"></i><b>15.1.3</b> Assessing model performance</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#interactions"><i class="fa fa-check"></i><b>15.2</b> Interactions</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#models-for-each-category"><i class="fa fa-check"></i><b>15.2.1</b> Models for each category</a></li>
<li class="chapter" data-level="15.2.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#one-model-with-an-interaction"><i class="fa fa-check"></i><b>15.2.2</b> One model with an interaction</a></li>
<li class="chapter" data-level="15.2.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#predict-with-interactions"><i class="fa fa-check"></i><b>15.2.3</b> Predict with interactions</a></li>
<li class="chapter" data-level="15.2.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#simpsons-paradox"><i class="fa fa-check"></i><b>15.2.4</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>15.3</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#two-numeric-ivs"><i class="fa fa-check"></i><b>15.3.1</b> Two numeric IVs</a></li>
<li class="chapter" data-level="15.3.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#more-than-2-ivs"><i class="fa fa-check"></i><b>15.3.2</b> More than 2 IVs</a></li>
<li class="chapter" data-level="15.3.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#model-performance"><i class="fa fa-check"></i><b>15.3.3</b> Model performance</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>15.4</b> Multiple Logistic Regression</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-logistic-regression-1"><i class="fa fa-check"></i><b>15.4.1</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="15.4.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#logistic-distribution"><i class="fa fa-check"></i><b>15.4.2</b> Logistic distribution</a></li>
<li class="chapter" data-level="15.4.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#model-performance-1"><i class="fa fa-check"></i><b>15.4.3</b> Model performance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sampling-in-r.html"><a href="sampling-in-r.html"><i class="fa fa-check"></i><b>16</b> Sampling in R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#introduction-to-sampling"><i class="fa fa-check"></i><b>16.1</b> Introduction to Sampling</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-point-estimates"><i class="fa fa-check"></i><b>16.1.1</b> Sampling &amp; point estimates</a></li>
<li class="chapter" data-level="16.1.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#convenience-sampling"><i class="fa fa-check"></i><b>16.1.2</b> Convenience sampling</a></li>
<li class="chapter" data-level="16.1.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#pseudo-random-number-generation"><i class="fa fa-check"></i><b>16.1.3</b> Pseudo-random number generation</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-methods"><i class="fa fa-check"></i><b>16.2</b> Sampling Methods</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#simple-random-systematic-sampling"><i class="fa fa-check"></i><b>16.2.1</b> Simple random &amp; systematic sampling</a></li>
<li class="chapter" data-level="16.2.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#stratified-weighted-random-sampling"><i class="fa fa-check"></i><b>16.2.2</b> Stratified &amp; weighted random sampling</a></li>
<li class="chapter" data-level="16.2.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#cluster-sampling"><i class="fa fa-check"></i><b>16.2.3</b> Cluster sampling</a></li>
<li class="chapter" data-level="16.2.4" data-path="sampling-in-r.html"><a href="sampling-in-r.html#comparing-sampling-methods"><i class="fa fa-check"></i><b>16.2.4</b> Comparing sampling methods</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-distributions"><i class="fa fa-check"></i><b>16.3</b> Sampling Distributions</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#relative-error-of-point-estimates"><i class="fa fa-check"></i><b>16.3.1</b> Relative error of point estimates</a></li>
<li class="chapter" data-level="16.3.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#creating-a-sampling-distribution"><i class="fa fa-check"></i><b>16.3.2</b> Creating a sampling distribution</a></li>
<li class="chapter" data-level="16.3.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#approximate-sampling-distributions"><i class="fa fa-check"></i><b>16.3.3</b> Approximate sampling distributions</a></li>
<li class="chapter" data-level="16.3.4" data-path="sampling-in-r.html"><a href="sampling-in-r.html#standard-errors-clt"><i class="fa fa-check"></i><b>16.3.4</b> Standard errors &amp; CLT</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="sampling-in-r.html"><a href="sampling-in-r.html#bootstrap-distributions"><i class="fa fa-check"></i><b>16.4</b> Bootstrap Distributions</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#introduction-to-bootstrapping"><i class="fa fa-check"></i><b>16.4.1</b> Introduction to bootstrapping</a></li>
<li class="chapter" data-level="16.4.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#comparing-sampling-bootstrap-distributions"><i class="fa fa-check"></i><b>16.4.2</b> Comparing sampling &amp; bootstrap distributions</a></li>
<li class="chapter" data-level="16.4.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#confidence-intervals"><i class="fa fa-check"></i><b>16.4.3</b> Confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>17</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-to-hypothesis-testing"><i class="fa fa-check"></i><b>17.1</b> Introduction to Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-tests-z-scores"><i class="fa fa-check"></i><b>17.1.1</b> Hypothesis tests &amp; z-scores</a></li>
<li class="chapter" data-level="17.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#p-values"><i class="fa fa-check"></i><b>17.1.2</b> p-values</a></li>
<li class="chapter" data-level="17.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-significance"><i class="fa fa-check"></i><b>17.1.3</b> Statistical significance</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-sample-anova-tests"><i class="fa fa-check"></i><b>17.2</b> Two-Sample &amp; ANOVA Tests</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#performing-t-tests"><i class="fa fa-check"></i><b>17.2.1</b> Performing t-tests</a></li>
<li class="chapter" data-level="17.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#calculating-p-values-from-t-statistics"><i class="fa fa-check"></i><b>17.2.2</b> Calculating p-values from t-statistics</a></li>
<li class="chapter" data-level="17.2.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#paired-t-tests"><i class="fa fa-check"></i><b>17.2.3</b> Paired t-tests</a></li>
<li class="chapter" data-level="17.2.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#anova-tests"><i class="fa fa-check"></i><b>17.2.4</b> ANOVA tests</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#proportion-tests"><i class="fa fa-check"></i><b>17.3</b> Proportion Tests</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-proportion-tests"><i class="fa fa-check"></i><b>17.3.1</b> One-sample proportion tests</a></li>
<li class="chapter" data-level="17.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-sample-proportion-tests"><i class="fa fa-check"></i><b>17.3.2</b> Two-sample proportion tests</a></li>
<li class="chapter" data-level="17.3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-test-of-independence"><i class="fa fa-check"></i><b>17.3.3</b> Chi-square test of independence</a></li>
<li class="chapter" data-level="17.3.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-goodness-of-fit-tests"><i class="fa fa-check"></i><b>17.3.4</b> Chi-square goodness of fit tests</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-tests"><i class="fa fa-check"></i><b>17.4</b> Non-Parametric Tests</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#assumptions-in-hypothesis-testing"><i class="fa fa-check"></i><b>17.4.1</b> Assumptions in hypothesis testing</a></li>
<li class="chapter" data-level="17.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#simulation-based-infer-pipeline"><i class="fa fa-check"></i><b>17.4.2</b> Simulation-based infer pipeline</a></li>
<li class="chapter" data-level="17.4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-anova-unpaired-t-tests"><i class="fa fa-check"></i><b>17.4.3</b> Non-parametric ANOVA &amp; unpaired t-tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>18</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="18.1" data-path="experimental-design.html"><a href="experimental-design.html#introduction-to-experimental-design"><i class="fa fa-check"></i><b>18.1</b> Introduction to experimental design</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="experimental-design.html"><a href="experimental-design.html#introduction-1"><i class="fa fa-check"></i><b>18.1.1</b> Introduction</a></li>
<li class="chapter" data-level="18.1.2" data-path="experimental-design.html"><a href="experimental-design.html#replication-blocking"><i class="fa fa-check"></i><b>18.1.2</b> Replication &amp; blocking</a></li>
<li class="chapter" data-level="18.1.3" data-path="experimental-design.html"><a href="experimental-design.html#hypothesis-testing-1"><i class="fa fa-check"></i><b>18.1.3</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="experimental-design.html"><a href="experimental-design.html#basic-experiments"><i class="fa fa-check"></i><b>18.2</b> Basic Experiments</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="experimental-design.html"><a href="experimental-design.html#anova-factor-experiments"><i class="fa fa-check"></i><b>18.2.1</b> ANOVA &amp; factor experiments</a></li>
<li class="chapter" data-level="18.2.2" data-path="experimental-design.html"><a href="experimental-design.html#model-validation"><i class="fa fa-check"></i><b>18.2.2</b> Model validation</a></li>
<li class="chapter" data-level="18.2.3" data-path="experimental-design.html"><a href="experimental-design.html#ab-testing"><i class="fa fa-check"></i><b>18.2.3</b> A/B testing</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="experimental-design.html"><a href="experimental-design.html#block-designs"><i class="fa fa-check"></i><b>18.3</b> Block Designs</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="experimental-design.html"><a href="experimental-design.html#intro-to-sampling"><i class="fa fa-check"></i><b>18.3.1</b> Intro to sampling</a></li>
<li class="chapter" data-level="18.3.2" data-path="experimental-design.html"><a href="experimental-design.html#randomized-complete-block-designs-rcbd"><i class="fa fa-check"></i><b>18.3.2</b> Randomized Complete Block Designs (RCBD)</a></li>
<li class="chapter" data-level="18.3.3" data-path="experimental-design.html"><a href="experimental-design.html#balanced-incomplete-block-designs-bibd"><i class="fa fa-check"></i><b>18.3.3</b> Balanced Incomplete Block Designs (BIBD)</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="experimental-design.html"><a href="experimental-design.html#squares-factorial-experiments"><i class="fa fa-check"></i><b>18.4</b> Squares &amp; Factorial Experiments</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="experimental-design.html"><a href="experimental-design.html#latin-squares"><i class="fa fa-check"></i><b>18.4.1</b> Latin squares</a></li>
<li class="chapter" data-level="18.4.2" data-path="experimental-design.html"><a href="experimental-design.html#graeco-latin-squares"><i class="fa fa-check"></i><b>18.4.2</b> Graeco-Latin squares</a></li>
<li class="chapter" data-level="18.4.3" data-path="experimental-design.html"><a href="experimental-design.html#factorial-experiments"><i class="fa fa-check"></i><b>18.4.3</b> Factorial experiments</a></li>
<li class="chapter" data-level="18.4.4" data-path="experimental-design.html"><a href="experimental-design.html#other-experimental-designs"><i class="fa fa-check"></i><b>18.4.4</b> Other experimental designs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html"><i class="fa fa-check"></i><b>19</b> Supervised Learning: Classification</a>
<ul>
<li class="chapter" data-level="19.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#k-nearest-neighbors-knn"><i class="fa fa-check"></i><b>19.1</b> k-Nearest Neighbors (kNN)</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#classification-with-nearest-neighbors"><i class="fa fa-check"></i><b>19.1.1</b> Classification with Nearest Neighbors</a></li>
<li class="chapter" data-level="19.1.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#k-in-knn"><i class="fa fa-check"></i><b>19.1.2</b> ‘k’ in kNN</a></li>
<li class="chapter" data-level="19.1.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#data-preparation-for-knn"><i class="fa fa-check"></i><b>19.1.3</b> 1-3.Data preparation for kNN</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#naive-bayes"><i class="fa fa-check"></i><b>19.2</b> Naive Bayes</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#understanding-bayesian-methods"><i class="fa fa-check"></i><b>19.2.1</b> Understanding Bayesian methods</a></li>
<li class="chapter" data-level="19.2.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#understanding-nbs-naivety"><i class="fa fa-check"></i><b>19.2.2</b> Understanding NB’s “naivety”</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#logistic-regression"><i class="fa fa-check"></i><b>19.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#making-binary-predictions-with-regression"><i class="fa fa-check"></i><b>19.3.1</b> Making binary predictions with regression</a></li>
<li class="chapter" data-level="19.3.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#model-performance-tradeoffs"><i class="fa fa-check"></i><b>19.3.2</b> Model performance tradeoffs</a></li>
<li class="chapter" data-level="19.3.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#dummy-variables-missing-data-and-interactions"><i class="fa fa-check"></i><b>19.3.3</b> Dummy variables, missing data, and interactions</a></li>
<li class="chapter" data-level="19.3.4" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#automatic-feature-selection"><i class="fa fa-check"></i><b>19.3.4</b> Automatic feature selection</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#classification-trees"><i class="fa fa-check"></i><b>19.4</b> Classification Trees</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#making-decisions-with-trees"><i class="fa fa-check"></i><b>19.4.1</b> Making decisions with trees</a></li>
<li class="chapter" data-level="19.4.2" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#growing-larger-classification-trees"><i class="fa fa-check"></i><b>19.4.2</b> Growing larger classification trees</a></li>
<li class="chapter" data-level="19.4.3" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#tending-to-classification-trees"><i class="fa fa-check"></i><b>19.4.3</b> Tending to classification trees</a></li>
<li class="chapter" data-level="19.4.4" data-path="supervised-learning-classification.html"><a href="supervised-learning-classification.html#seeing-the-forest-from-the-trees"><i class="fa fa-check"></i><b>19.4.4</b> Seeing the forest from the trees</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html"><i class="fa fa-check"></i><b>20</b> Supervised Learning: Regression</a>
<ul>
<li class="chapter" data-level="20.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#what-is-regression"><i class="fa fa-check"></i><b>20.1</b> What is Regression?</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#introduction-2"><i class="fa fa-check"></i><b>20.1.1</b> Introduction</a></li>
<li class="chapter" data-level="20.1.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#linear-regression"><i class="fa fa-check"></i><b>20.1.2</b> Linear regression</a></li>
<li class="chapter" data-level="20.1.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#predicting-model"><i class="fa fa-check"></i><b>20.1.3</b> Predicting model</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#training-and-evaluating-models"><i class="fa fa-check"></i><b>20.2</b> Training and Evaluating Models</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#graphically"><i class="fa fa-check"></i><b>20.2.1</b> Graphically</a></li>
<li class="chapter" data-level="20.2.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#root-mean-squared-error"><i class="fa fa-check"></i><b>20.2.2</b> Root Mean Squared Error</a></li>
<li class="chapter" data-level="20.2.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#r-squared"><i class="fa fa-check"></i><b>20.2.3</b> R-squared</a></li>
<li class="chapter" data-level="20.2.4" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#training-a-model"><i class="fa fa-check"></i><b>20.2.4</b> Training a Model</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#issues-to-consider"><i class="fa fa-check"></i><b>20.3</b> Issues to Consider</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#categorical-iv"><i class="fa fa-check"></i><b>20.3.1</b> Categorical IV</a></li>
<li class="chapter" data-level="20.3.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#interactions-1"><i class="fa fa-check"></i><b>20.3.2</b> Interactions</a></li>
<li class="chapter" data-level="20.3.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#transforming-dv-before-modeling"><i class="fa fa-check"></i><b>20.3.3</b> Transforming DV before modeling</a></li>
<li class="chapter" data-level="20.3.4" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#transforming-iv-before-modeling"><i class="fa fa-check"></i><b>20.3.4</b> Transforming IV before modeling</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#dealing-with-non-linear-responses"><i class="fa fa-check"></i><b>20.4</b> Dealing with Non-Linear Responses</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#logistic-regression-to-predict-probabilities"><i class="fa fa-check"></i><b>20.4.1</b> Logistic regression to predict probabilities</a></li>
<li class="chapter" data-level="20.4.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#poisson-and-quasipoisson-regression-to-predict-counts"><i class="fa fa-check"></i><b>20.4.2</b> Poisson and quasipoisson regression to predict counts</a></li>
<li class="chapter" data-level="20.4.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#gam-to-learn-non-linear-transforms"><i class="fa fa-check"></i><b>20.4.3</b> GAM to learn non-linear transforms</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#tree-based-methods"><i class="fa fa-check"></i><b>20.5</b> Tree-Based Methods</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#random-forests"><i class="fa fa-check"></i><b>20.5.1</b> Random forests</a></li>
<li class="chapter" data-level="20.5.2" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#one-hot-encoding"><i class="fa fa-check"></i><b>20.5.2</b> One-Hot-Encoding</a></li>
<li class="chapter" data-level="20.5.3" data-path="supervised-learning-regression.html"><a href="supervised-learning-regression.html#gradient-boosting"><i class="fa fa-check"></i><b>20.5.3</b> Gradient boosting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>21</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="21.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>21.1</b> k-means clustering</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#types-of-machine-learning"><i class="fa fa-check"></i><b>21.1.1</b> Types of machine learning</a></li>
<li class="chapter" data-level="21.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-to-k-means"><i class="fa fa-check"></i><b>21.1.2</b> Introduction to k-means</a></li>
<li class="chapter" data-level="21.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#model-selection"><i class="fa fa-check"></i><b>21.1.3</b> Model selection</a></li>
<li class="chapter" data-level="21.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#pokemon-data"><i class="fa fa-check"></i><b>21.1.4</b> Pokemon data</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#hierarchical-clustering"><i class="fa fa-check"></i><b>21.2</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-3"><i class="fa fa-check"></i><b>21.2.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#selecting-number-of-clusters-1"><i class="fa fa-check"></i><b>21.2.2</b> Selecting number of clusters</a></li>
<li class="chapter" data-level="21.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#clustering-linkage"><i class="fa fa-check"></i><b>21.2.3</b> Clustering linkage</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#dimensionality-reduction---pca"><i class="fa fa-check"></i><b>21.3</b> Dimensionality reduction - PCA</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-4"><i class="fa fa-check"></i><b>21.3.1</b> Introduction</a></li>
<li class="chapter" data-level="21.3.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#visualizing-and-interpreting-1"><i class="fa fa-check"></i><b>21.3.2</b> Visualizing and interpreting</a></li>
<li class="chapter" data-level="21.3.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#practical-issues"><i class="fa fa-check"></i><b>21.3.3</b> Practical issues</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#case-study-1"><i class="fa fa-check"></i><b>21.4</b> Case study</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-5"><i class="fa fa-check"></i><b>21.4.1</b> Introduction</a></li>
<li class="chapter" data-level="21.4.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#next-steps"><i class="fa fa-check"></i><b>21.4.2</b> Next steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html"><i class="fa fa-check"></i><b>22</b> Intermediate Importing Data in R</a>
<ul>
<li class="chapter" data-level="22.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-databases-1"><i class="fa fa-check"></i><b>22.1</b> Import from databases-1</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#connect-to-a-database"><i class="fa fa-check"></i><b>22.1.1</b> Connect to a database</a></li>
<li class="chapter" data-level="22.1.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-table-data"><i class="fa fa-check"></i><b>22.1.2</b> Import table data</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-databases-2"><i class="fa fa-check"></i><b>22.2</b> Import from databases-2</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#sql-queries-from-inside-r"><i class="fa fa-check"></i><b>22.2.1</b> SQL Queries from inside R</a></li>
<li class="chapter" data-level="22.2.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#dbi-internals"><i class="fa fa-check"></i><b>22.2.2</b> DBI internals</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-the-web-1"><i class="fa fa-check"></i><b>22.3</b> Import from the web-1</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#http"><i class="fa fa-check"></i><b>22.3.1</b> HTTP</a></li>
<li class="chapter" data-level="22.3.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#downloading-files"><i class="fa fa-check"></i><b>22.3.2</b> Downloading files</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-the-web-2"><i class="fa fa-check"></i><b>22.4</b> Import from the web-2</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#apis-json"><i class="fa fa-check"></i><b>22.4.1</b> APIs &amp; JSON</a></li>
<li class="chapter" data-level="22.4.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#json-jsonlite"><i class="fa fa-check"></i><b>22.4.2</b> JSON &amp; jsonlite</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#import-from-statistical-software"><i class="fa fa-check"></i><b>22.5</b> Import from statistical software</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#haven-package"><i class="fa fa-check"></i><b>22.5.1</b> haven package</a></li>
<li class="chapter" data-level="22.5.2" data-path="intermediate-importing-data-in-r.html"><a href="intermediate-importing-data-in-r.html#foreign-package"><i class="fa fa-check"></i><b>22.5.2</b> foreign package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html"><i class="fa fa-check"></i><b>23</b> Introduction to SQL</a>
<ul>
<li class="chapter" data-level="23.1" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#relational-databases"><i class="fa fa-check"></i><b>23.1</b> Relational Databases</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#databases"><i class="fa fa-check"></i><b>23.1.1</b> Databases</a></li>
<li class="chapter" data-level="23.1.2" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#tables"><i class="fa fa-check"></i><b>23.1.2</b> Tables</a></li>
<li class="chapter" data-level="23.1.3" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#data"><i class="fa fa-check"></i><b>23.1.3</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#querying"><i class="fa fa-check"></i><b>23.2</b> Querying</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#introducing"><i class="fa fa-check"></i><b>23.2.1</b> Introducing</a></li>
<li class="chapter" data-level="23.2.2" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#writing-queries"><i class="fa fa-check"></i><b>23.2.2</b> Writing queries</a></li>
<li class="chapter" data-level="23.2.3" data-path="introduction-to-sql.html"><a href="introduction-to-sql.html#sql-flavors"><i class="fa fa-check"></i><b>23.2.3</b> SQL flavors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="intermediate-sql.html"><a href="intermediate-sql.html"><i class="fa fa-check"></i><b>24</b> Intermediate SQL</a>
<ul>
<li class="chapter" data-level="24.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#selecting-data"><i class="fa fa-check"></i><b>24.1</b> Selecting Data</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#querying-a-database"><i class="fa fa-check"></i><b>24.1.1</b> Querying a database</a></li>
<li class="chapter" data-level="24.1.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#query-execution"><i class="fa fa-check"></i><b>24.1.2</b> Query execution</a></li>
<li class="chapter" data-level="24.1.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#sql-style"><i class="fa fa-check"></i><b>24.1.3</b> SQL style</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-records"><i class="fa fa-check"></i><b>24.2</b> Filtering Records</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-numbers"><i class="fa fa-check"></i><b>24.2.1</b> Filtering numbers</a></li>
<li class="chapter" data-level="24.2.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#multiple-criteria"><i class="fa fa-check"></i><b>24.2.2</b> Multiple criteria</a></li>
<li class="chapter" data-level="24.2.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-text"><i class="fa fa-check"></i><b>24.2.3</b> Filtering text</a></li>
<li class="chapter" data-level="24.2.4" data-path="intermediate-sql.html"><a href="intermediate-sql.html#null-values"><i class="fa fa-check"></i><b>24.2.4</b> NULL values</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#aggregate-functions"><i class="fa fa-check"></i><b>24.3</b> Aggregate Functions</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#summarizing-data"><i class="fa fa-check"></i><b>24.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="24.3.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#summarizing-subsets"><i class="fa fa-check"></i><b>24.3.2</b> Summarizing subsets</a></li>
<li class="chapter" data-level="24.3.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#aliasing-and-arithmetic"><i class="fa fa-check"></i><b>24.3.3</b> Aliasing and arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="intermediate-sql.html"><a href="intermediate-sql.html#sorting-and-grouping"><i class="fa fa-check"></i><b>24.4</b> Sorting and Grouping</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="intermediate-sql.html"><a href="intermediate-sql.html#sorting-results"><i class="fa fa-check"></i><b>24.4.1</b> Sorting results</a></li>
<li class="chapter" data-level="24.4.2" data-path="intermediate-sql.html"><a href="intermediate-sql.html#grouping-data"><i class="fa fa-check"></i><b>24.4.2</b> Grouping data</a></li>
<li class="chapter" data-level="24.4.3" data-path="intermediate-sql.html"><a href="intermediate-sql.html#filtering-grouped-data"><i class="fa fa-check"></i><b>24.4.3</b> Filtering grouped data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html"><i class="fa fa-check"></i><b>25</b> Joining Data in SQL</a>
<ul>
<li class="chapter" data-level="25.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#inner-joins"><i class="fa fa-check"></i><b>25.1</b> Inner Joins</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#ins-outs-of-inner-join"><i class="fa fa-check"></i><b>25.1.1</b> ins &amp; outs of INNER JOIN</a></li>
<li class="chapter" data-level="25.1.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#defining-relationships"><i class="fa fa-check"></i><b>25.1.2</b> Defining relationships</a></li>
<li class="chapter" data-level="25.1.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#multiple-joins"><i class="fa fa-check"></i><b>25.1.3</b> Multiple joins</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#outer-cross-self-joins"><i class="fa fa-check"></i><b>25.2</b> Outer, Cross &amp; Self Joins</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#left-right-joins-1"><i class="fa fa-check"></i><b>25.2.1</b> LEFT &amp; RIGHT JOINs</a></li>
<li class="chapter" data-level="25.2.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#full-join-1"><i class="fa fa-check"></i><b>25.2.2</b> FULL JOIN</a></li>
<li class="chapter" data-level="25.2.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#cross-join"><i class="fa fa-check"></i><b>25.2.3</b> CROSS JOIN</a></li>
<li class="chapter" data-level="25.2.4" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#self-joins"><i class="fa fa-check"></i><b>25.2.4</b> Self joins</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#set-theory-for-sql-joins"><i class="fa fa-check"></i><b>25.3</b> Set Theory for SQL Joins</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#union-vs.-union-all"><i class="fa fa-check"></i><b>25.3.1</b> UNION vs. UNION ALL</a></li>
<li class="chapter" data-level="25.3.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#intersect"><i class="fa fa-check"></i><b>25.3.2</b> INTERSECT</a></li>
<li class="chapter" data-level="25.3.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#except"><i class="fa fa-check"></i><b>25.3.3</b> EXCEPT</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#subqueries"><i class="fa fa-check"></i><b>25.4</b> Subqueries</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#with-semi-joins-anti-joins"><i class="fa fa-check"></i><b>25.4.1</b> With semi joins &amp; anti joins</a></li>
<li class="chapter" data-level="25.4.2" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#inside-where-select"><i class="fa fa-check"></i><b>25.4.2</b> Inside WHERE &amp; SELECT</a></li>
<li class="chapter" data-level="25.4.3" data-path="joining-data-in-sql.html"><a href="joining-data-in-sql.html#inside-from"><i class="fa fa-check"></i><b>25.4.3</b> Inside FROM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="introduction-to-git.html"><a href="introduction-to-git.html"><i class="fa fa-check"></i><b>26</b> Introduction to Git</a>
<ul>
<li class="chapter" data-level="26.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#introduction-6"><i class="fa fa-check"></i><b>26.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#useful-shell-commands"><i class="fa fa-check"></i><b>26.1.1</b> Useful shell commands</a></li>
<li class="chapter" data-level="26.1.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#saving-files"><i class="fa fa-check"></i><b>26.1.2</b> Saving files</a></li>
<li class="chapter" data-level="26.1.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#comparing-files"><i class="fa fa-check"></i><b>26.1.3</b> Comparing files</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#making-changes"><i class="fa fa-check"></i><b>26.2</b> Making changes</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#storing-data-with-git"><i class="fa fa-check"></i><b>26.2.1</b> Storing data with Git</a></li>
<li class="chapter" data-level="26.2.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#viewing-changes"><i class="fa fa-check"></i><b>26.2.2</b> Viewing changes</a></li>
<li class="chapter" data-level="26.2.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#undoing-changes-before-committing"><i class="fa fa-check"></i><b>26.2.3</b> Undoing changes before committing</a></li>
<li class="chapter" data-level="26.2.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#restoring-and-reverting"><i class="fa fa-check"></i><b>26.2.4</b> Restoring and reverting</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#git-workflows"><i class="fa fa-check"></i><b>26.3</b> Git workflows</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#configuring-git"><i class="fa fa-check"></i><b>26.3.1</b> Configuring Git</a></li>
<li class="chapter" data-level="26.3.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#branches"><i class="fa fa-check"></i><b>26.3.2</b> Branches</a></li>
<li class="chapter" data-level="26.3.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#working-with-branches"><i class="fa fa-check"></i><b>26.3.3</b> Working with branches</a></li>
<li class="chapter" data-level="26.3.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#handling-conflict"><i class="fa fa-check"></i><b>26.3.4</b> Handling conflict</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#collaborating-with-git"><i class="fa fa-check"></i><b>26.4</b> Collaborating with Git</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="introduction-to-git.html"><a href="introduction-to-git.html#creating-repos"><i class="fa fa-check"></i><b>26.4.1</b> Creating repos</a></li>
<li class="chapter" data-level="26.4.2" data-path="introduction-to-git.html"><a href="introduction-to-git.html#working-with-remotes"><i class="fa fa-check"></i><b>26.4.2</b> Working with remotes</a></li>
<li class="chapter" data-level="26.4.3" data-path="introduction-to-git.html"><a href="introduction-to-git.html#pulling-from-a-remote"><i class="fa fa-check"></i><b>26.4.3</b> Pulling from a remote</a></li>
<li class="chapter" data-level="26.4.4" data-path="introduction-to-git.html"><a href="introduction-to-git.html#pushing-to-a-remote"><i class="fa fa-check"></i><b>26.4.4</b> Pushing to a remote</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Scientist with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intermediate-regression" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Chapter 15</span> Intermediate Regression<a href="intermediate-regression.html#intermediate-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="parallel-slopes" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Parallel Slopes<a href="intermediate-regression.html#parallel-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The case when there is one numeric explanatory variable and one categorical explanatory variable is sometimes called a “parallel slopes” linear regression due to the shape of the predictions.</p>
<div id="parallel-slopes-linear-regression" class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Parallel slopes linear regression<a href="intermediate-regression.html#parallel-slopes-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, you’ll revisit the Taiwan real estate dataset.</p>
<div class="sourceCode" id="cb1944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1944-1"><a href="intermediate-regression.html#cb1944-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1944-2"><a href="intermediate-regression.html#cb1944-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fst)</span>
<span id="cb1944-3"><a href="intermediate-regression.html#cb1944-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1944-4"><a href="intermediate-regression.html#cb1944-4" aria-hidden="true" tabindex="-1"></a>taiwan_real_estate <span class="ot">&lt;-</span> <span class="fu">read_fst</span>(<span class="st">&quot;data/taiwan_real_estate2.fst&quot;</span>)</span>
<span id="cb1944-5"><a href="intermediate-regression.html#cb1944-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(taiwan_real_estate)</span></code></pre></div>
<pre><code>## Rows: 414
## Columns: 4
## $ dist_to_mrt_m   &lt;dbl&gt; 84.9, 306.6, 562.0, 562.0, 390.6, 2175.0, 623.5, 287.6…
## $ n_convenience   &lt;dbl&gt; 10, 9, 5, 5, 5, 3, 7, 6, 1, 3, 1, 9, 5, 4, 4, 2, 6, 1,…
## $ house_age_years &lt;fct&gt; 30 to 45, 15 to 30, 0 to 15, 0 to 15, 0 to 15, 0 to 15…
## $ price_twd_msq   &lt;dbl&gt; 11.47, 12.77, 14.31, 16.58, 13.04, 9.71, 12.19, 14.13,…</code></pre>
<div id="fitting-interpreting-model" class="section level4 hasAnchor" number="15.1.1.1">
<h4><span class="header-section-number">15.1.1.1</span> Fitting &amp; Interpreting model<a href="intermediate-regression.html#fitting-interpreting-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To combine multiple explanatory variables in the regression formula, separate them with a <code>+</code>.</p>
<div class="sourceCode" id="cb1946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1946-1"><a href="intermediate-regression.html#cb1946-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear regr&#39;n of price_twd_msq vs. n_convenience</span></span>
<span id="cb1946-2"><a href="intermediate-regression.html#cb1946-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience, taiwan_real_estate)</span>
<span id="cb1946-3"><a href="intermediate-regression.html#cb1946-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-4"><a href="intermediate-regression.html#cb1946-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb1946-5"><a href="intermediate-regression.html#cb1946-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience, data = taiwan_real_estate)
## 
## Coefficients:
##   (Intercept)  n_convenience  
##         8.224          0.798</code></pre>
<div class="sourceCode" id="cb1948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1948-1"><a href="intermediate-regression.html#cb1948-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear regr&#39;n of price_twd_msq vs. house_age_years, no intercept</span></span>
<span id="cb1948-2"><a href="intermediate-regression.html#cb1948-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> house_age_years <span class="sc">+</span> <span class="dv">0</span>, taiwan_real_estate)</span>
<span id="cb1948-3"><a href="intermediate-regression.html#cb1948-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1948-4"><a href="intermediate-regression.html#cb1948-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb1948-5"><a href="intermediate-regression.html#cb1948-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_age</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ house_age_years + 0, data = taiwan_real_estate)
## 
## Coefficients:
##  house_age_years0 to 15  house_age_years15 to 30  house_age_years30 to 45  
##                   12.64                     9.88                    11.39</code></pre>
<div class="sourceCode" id="cb1950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1950-1"><a href="intermediate-regression.html#cb1950-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear regr&#39;n of price_twd_msq vs. n_convenience plus house_age_years, no intercept</span></span>
<span id="cb1950-2"><a href="intermediate-regression.html#cb1950-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience <span class="sc">+</span> house_age_years <span class="sc">+</span> <span class="dv">0</span>, taiwan_real_estate)</span>
<span id="cb1950-3"><a href="intermediate-regression.html#cb1950-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1950-4"><a href="intermediate-regression.html#cb1950-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb1950-5"><a href="intermediate-regression.html#cb1950-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience + house_age_years + 
##     0, data = taiwan_real_estate)
## 
## Coefficients:
##           n_convenience   house_age_years0 to 15  house_age_years15 to 30  
##                   0.791                    9.413                    7.085  
## house_age_years30 to 45  
##                   7.511</code></pre>
<p><strong>Interpreting parallel slopes coefficients</strong></p>
<p>The <code>mdl_price_vs_both</code> has one slope coefficient, and three intercept coefficients (one for each possible value of the categorical explanatory variable).</p>
<ul>
<li><p>What is the meaning of the <code>n_convenience</code> coefficient?</p>
<ul>
<li>For each additional nearby convenience store, the expected house price, in TWD per square meter, increases by <code>0.79</code>.</li>
</ul></li>
<li><p>What is the meaning of the “0 to 15 years” coefficient?</p>
<ul>
<li>For a house aged 0 to 15 years with zero nearby convenience stores, the expected house price is <code>9.41</code> TWD per square meter.</li>
</ul></li>
</ul>
</div>
<div id="visualizing-each-iv" class="section level4 hasAnchor" number="15.1.1.2">
<h4><span class="header-section-number">15.1.1.2</span> Visualizing each IV<a href="intermediate-regression.html#visualizing-each-iv" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To visualize the relationship between a numeric explanatory variable and the numeric response, you can draw a scatter plot with a linear trend line.</p>
<p>With a single numeric explanatory variable, the predictions form a single straight line.</p>
<div class="sourceCode" id="cb1952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1952-1"><a href="intermediate-regression.html#cb1952-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using taiwan_real_estate, plot price_twd_msq vs. n_convenience</span></span>
<span id="cb1952-2"><a href="intermediate-regression.html#cb1952-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, <span class="fu">aes</span>(n_convenience, price_twd_msq)) <span class="sc">+</span></span>
<span id="cb1952-3"><a href="intermediate-regression.html#cb1952-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a point layer</span></span>
<span id="cb1952-4"><a href="intermediate-regression.html#cb1952-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1952-5"><a href="intermediate-regression.html#cb1952-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a smooth trend line using linear regr&#39;n, no ribbon</span></span>
<span id="cb1952-6"><a href="intermediate-regression.html#cb1952-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-701-1.png" width="672" /></p>
<p>To visualize the relationship between a categorical explanatory variable and the numeric response, you can draw a box plot.</p>
<p>With a single categorical explanatory variable, the predictions are the <em>means for each category</em>.</p>
<div class="sourceCode" id="cb1954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1954-1"><a href="intermediate-regression.html#cb1954-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using taiwan_real_estate, plot price_twd_msq vs. house_age_years</span></span>
<span id="cb1954-2"><a href="intermediate-regression.html#cb1954-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, <span class="fu">aes</span>(house_age_years, price_twd_msq)) <span class="sc">+</span></span>
<span id="cb1954-3"><a href="intermediate-regression.html#cb1954-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a box plot layer</span></span>
<span id="cb1954-4"><a href="intermediate-regression.html#cb1954-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-702-1.png" width="672" /></p>
</div>
<div id="visualizing-parallel-slopes" class="section level4 hasAnchor" number="15.1.1.3">
<h4><span class="header-section-number">15.1.1.3</span> Visualizing parallel slopes<a href="intermediate-regression.html#visualizing-parallel-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>moderndive</code> package includes an extra geom, <code>geom_parallel_slopes()</code> to show the predictions.</p>
<div class="sourceCode" id="cb1955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1955-1"><a href="intermediate-regression.html#cb1955-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using taiwan_real_estate, plot price_twd_msq vs. n_convenience colored by house_age_years</span></span>
<span id="cb1955-2"><a href="intermediate-regression.html#cb1955-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, <span class="fu">aes</span>(n_convenience, price_twd_msq, <span class="at">color =</span> house_age_years)) <span class="sc">+</span></span>
<span id="cb1955-3"><a href="intermediate-regression.html#cb1955-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a point layer</span></span>
<span id="cb1955-4"><a href="intermediate-regression.html#cb1955-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1955-5"><a href="intermediate-regression.html#cb1955-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add parallel slopes, no ribbon</span></span>
<span id="cb1955-6"><a href="intermediate-regression.html#cb1955-6" aria-hidden="true" tabindex="-1"></a>  moderndive<span class="sc">::</span><span class="fu">geom_parallel_slopes</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-703-1.png" width="672" /></p>
<p>The “parallel slope” model name comes from the fact that the prediction for each category is a slope, and all those slopes are parallel.</p>
</div>
</div>
<div id="predicting-parallel-slopes" class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Predicting parallel slopes<a href="intermediate-regression.html#predicting-parallel-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="predicting-parallel-slopes-model" class="section level4 hasAnchor" number="15.1.2.1">
<h4><span class="header-section-number">15.1.2.1</span> Predicting parallel slopes model<a href="intermediate-regression.html#predicting-parallel-slopes-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Just as with the case of a single explanatory variable, the workflow has two steps: create a data frame of explanatory variables, then add a column of predictions.</p>
<p>Make a grid (<code>expand_grid()</code>) of explanatory data, formed from combinations of the following variables.</p>
<div class="sourceCode" id="cb1956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1956-1"><a href="intermediate-regression.html#cb1956-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a grid of explanatory data</span></span>
<span id="cb1956-2"><a href="intermediate-regression.html#cb1956-2" aria-hidden="true" tabindex="-1"></a>explanatory_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb1956-3"><a href="intermediate-regression.html#cb1956-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set n_convenience to zero to ten</span></span>
<span id="cb1956-4"><a href="intermediate-regression.html#cb1956-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_convenience =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb1956-5"><a href="intermediate-regression.html#cb1956-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set house_age_years to the unique values of that variable</span></span>
<span id="cb1956-6"><a href="intermediate-regression.html#cb1956-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">house_age_years =</span> <span class="fu">unique</span>(taiwan_real_estate<span class="sc">$</span>house_age_years)</span>
<span id="cb1956-7"><a href="intermediate-regression.html#cb1956-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1956-8"><a href="intermediate-regression.html#cb1956-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1956-9"><a href="intermediate-regression.html#cb1956-9" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb1956-10"><a href="intermediate-regression.html#cb1956-10" aria-hidden="true" tabindex="-1"></a>explanatory_data</span></code></pre></div>
<pre><code>## # A tibble: 33 × 2
##    n_convenience house_age_years
##            &lt;int&gt; &lt;fct&gt;          
##  1             0 30 to 45       
##  2             0 15 to 30       
##  3             0 0 to 15        
##  4             1 30 to 45       
##  5             1 15 to 30       
##  6             1 0 to 15        
##  7             2 30 to 45       
##  8             2 15 to 30       
##  9             2 0 to 15        
## 10             3 30 to 45       
## # ℹ 23 more rows</code></pre>
<div class="sourceCode" id="cb1958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1958-1"><a href="intermediate-regression.html#cb1958-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to the data frame</span></span>
<span id="cb1958-2"><a href="intermediate-regression.html#cb1958-2" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span> </span>
<span id="cb1958-3"><a href="intermediate-regression.html#cb1958-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_price_vs_both, explanatory_data))</span>
<span id="cb1958-4"><a href="intermediate-regression.html#cb1958-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1958-5"><a href="intermediate-regression.html#cb1958-5" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb1958-6"><a href="intermediate-regression.html#cb1958-6" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    n_convenience house_age_years price_twd_msq
##            &lt;int&gt; &lt;fct&gt;                   &lt;dbl&gt;
##  1             0 30 to 45                 7.51
##  2             0 15 to 30                 7.09
##  3             0 0 to 15                  9.41
##  4             1 30 to 45                 8.30
##  5             1 15 to 30                 7.88
##  6             1 0 to 15                 10.2 
##  7             2 30 to 45                 9.09
##  8             2 15 to 30                 8.67
##  9             2 0 to 15                 11.0 
## 10             3 30 to 45                 9.89
## # ℹ 23 more rows</code></pre>
<p>To make sure you’ve got the right answer, you can add your predictions to the ggplot with the <code>geom_parallel_slopes()</code> lines.</p>
<div class="sourceCode" id="cb1960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1960-1"><a href="intermediate-regression.html#cb1960-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the plot to add a point layer of predictions</span></span>
<span id="cb1960-2"><a href="intermediate-regression.html#cb1960-2" aria-hidden="true" tabindex="-1"></a>taiwan_real_estate <span class="sc">%&gt;%</span> </span>
<span id="cb1960-3"><a href="intermediate-regression.html#cb1960-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(n_convenience, price_twd_msq, <span class="at">color =</span> house_age_years)) <span class="sc">+</span></span>
<span id="cb1960-4"><a href="intermediate-regression.html#cb1960-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1960-5"><a href="intermediate-regression.html#cb1960-5" aria-hidden="true" tabindex="-1"></a>  moderndive<span class="sc">::</span><span class="fu">geom_parallel_slopes</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1960-6"><a href="intermediate-regression.html#cb1960-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points using prediction_data, with size 5 and shape 15</span></span>
<span id="cb1960-7"><a href="intermediate-regression.html#cb1960-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-706-1.png" width="672" /></p>
</div>
<div id="manually-calculating-predictions" class="section level4 hasAnchor" number="15.1.2.2">
<h4><span class="header-section-number">15.1.2.2</span> Manually calculating predictions<a href="intermediate-regression.html#manually-calculating-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As with simple linear regression, you can manually calculate the predictions from the model coefficients.</p>
<p>The only change for the parallel slopes case is that the intercept is different for each category of the categorical explanatory variable. That means you need to consider the case when (<code>case_when</code> or <code>if_else</code>) each each category occurs separately.</p>
<div class="sourceCode" id="cb1961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1961-1"><a href="intermediate-regression.html#cb1961-1" aria-hidden="true" tabindex="-1"></a>dataframe <span class="sc">%&gt;%</span></span>
<span id="cb1961-2"><a href="intermediate-regression.html#cb1961-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1961-3"><a href="intermediate-regression.html#cb1961-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb1961-4"><a href="intermediate-regression.html#cb1961-4" aria-hidden="true" tabindex="-1"></a>            condition_1 <span class="sc">~</span> value_1,</span>
<span id="cb1961-5"><a href="intermediate-regression.html#cb1961-5" aria-hidden="true" tabindex="-1"></a>            condition_2 <span class="sc">~</span> value_2,</span>
<span id="cb1961-6"><a href="intermediate-regression.html#cb1961-6" aria-hidden="true" tabindex="-1"></a>            <span class="co"># ...</span></span>
<span id="cb1961-7"><a href="intermediate-regression.html#cb1961-7" aria-hidden="true" tabindex="-1"></a>            condition_n <span class="sc">~</span> value_n</span>
<span id="cb1961-8"><a href="intermediate-regression.html#cb1961-8" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb1961-9"><a href="intermediate-regression.html#cb1961-9" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<p>Assign each of the elements of <code>coeffs</code> to the appropriate variable.</p>
<div class="sourceCode" id="cb1962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1962-1"><a href="intermediate-regression.html#cb1962-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coefficients from mdl_price_vs_both</span></span>
<span id="cb1962-2"><a href="intermediate-regression.html#cb1962-2" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(mdl_price_vs_both)</span>
<span id="cb1962-3"><a href="intermediate-regression.html#cb1962-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-4"><a href="intermediate-regression.html#cb1962-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the slope coefficient</span></span>
<span id="cb1962-5"><a href="intermediate-regression.html#cb1962-5" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> coeffs[<span class="dv">1</span>]</span>
<span id="cb1962-6"><a href="intermediate-regression.html#cb1962-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-7"><a href="intermediate-regression.html#cb1962-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the intercept coefficient for 0 to 15</span></span>
<span id="cb1962-8"><a href="intermediate-regression.html#cb1962-8" aria-hidden="true" tabindex="-1"></a>intercept_0_15 <span class="ot">&lt;-</span> coeffs[<span class="dv">2</span>]</span>
<span id="cb1962-9"><a href="intermediate-regression.html#cb1962-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-10"><a href="intermediate-regression.html#cb1962-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the intercept coefficient for 15 to 30</span></span>
<span id="cb1962-11"><a href="intermediate-regression.html#cb1962-11" aria-hidden="true" tabindex="-1"></a>intercept_15_30 <span class="ot">&lt;-</span> coeffs[<span class="dv">3</span>]</span>
<span id="cb1962-12"><a href="intermediate-regression.html#cb1962-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-13"><a href="intermediate-regression.html#cb1962-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the intercept coefficient for 30 to 45</span></span>
<span id="cb1962-14"><a href="intermediate-regression.html#cb1962-14" aria-hidden="true" tabindex="-1"></a>intercept_30_45 <span class="ot">&lt;-</span> coeffs[<span class="dv">4</span>]</span>
<span id="cb1962-15"><a href="intermediate-regression.html#cb1962-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-16"><a href="intermediate-regression.html#cb1962-16" aria-hidden="true" tabindex="-1"></a><span class="co"># See elements</span></span>
<span id="cb1962-17"><a href="intermediate-regression.html#cb1962-17" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">coeffs =</span> coeffs, <span class="at">slope =</span> slope, <span class="at">intercept_0_15 =</span> intercept_0_15, <span class="at">intercept_15_30 =</span> intercept_15_30, <span class="at">intercept_30_45 =</span> intercept_30_45)</span></code></pre></div>
<pre><code>## $coeffs
##           n_convenience  house_age_years0 to 15 house_age_years15 to 30 
##                   0.791                   9.413                   7.085 
## house_age_years30 to 45 
##                   7.511 
## 
## $slope
## n_convenience 
##         0.791 
## 
## $intercept_0_15
## house_age_years0 to 15 
##                   9.41 
## 
## $intercept_15_30
## house_age_years15 to 30 
##                    7.09 
## 
## $intercept_30_45
## house_age_years30 to 45 
##                    7.51</code></pre>
<div class="sourceCode" id="cb1964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1964-1"><a href="intermediate-regression.html#cb1964-1" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span> </span>
<span id="cb1964-2"><a href="intermediate-regression.html#cb1964-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1964-3"><a href="intermediate-regression.html#cb1964-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Consider the 3 cases to choose the intercept</span></span>
<span id="cb1964-4"><a href="intermediate-regression.html#cb1964-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">case_when</span>(</span>
<span id="cb1964-5"><a href="intermediate-regression.html#cb1964-5" aria-hidden="true" tabindex="-1"></a>      house_age_years <span class="sc">==</span> <span class="st">&quot;0 to 15&quot;</span> <span class="sc">~</span> intercept_0_15,</span>
<span id="cb1964-6"><a href="intermediate-regression.html#cb1964-6" aria-hidden="true" tabindex="-1"></a>      house_age_years <span class="sc">==</span> <span class="st">&quot;15 to 30&quot;</span> <span class="sc">~</span> intercept_15_30,</span>
<span id="cb1964-7"><a href="intermediate-regression.html#cb1964-7" aria-hidden="true" tabindex="-1"></a>      house_age_years <span class="sc">==</span> <span class="st">&quot;30 to 45&quot;</span> <span class="sc">~</span> intercept_30_45</span>
<span id="cb1964-8"><a href="intermediate-regression.html#cb1964-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1964-9"><a href="intermediate-regression.html#cb1964-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1964-10"><a href="intermediate-regression.html#cb1964-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manually calculate the predictions</span></span>
<span id="cb1964-11"><a href="intermediate-regression.html#cb1964-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">price_twd_msq =</span> intercept <span class="sc">+</span> slope <span class="sc">*</span> n_convenience</span>
<span id="cb1964-12"><a href="intermediate-regression.html#cb1964-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1964-13"><a href="intermediate-regression.html#cb1964-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1964-14"><a href="intermediate-regression.html#cb1964-14" aria-hidden="true" tabindex="-1"></a><span class="co"># See the results</span></span>
<span id="cb1964-15"><a href="intermediate-regression.html#cb1964-15" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 33 × 4
##    n_convenience house_age_years intercept price_twd_msq
##            &lt;int&gt; &lt;fct&gt;               &lt;dbl&gt;         &lt;dbl&gt;
##  1             0 30 to 45             7.51          7.51
##  2             0 15 to 30             7.09          7.09
##  3             0 0 to 15              9.41          9.41
##  4             1 30 to 45             7.51          8.30
##  5             1 15 to 30             7.09          7.88
##  6             1 0 to 15              9.41         10.2 
##  7             2 30 to 45             7.51          9.09
##  8             2 15 to 30             7.09          8.67
##  9             2 0 to 15              9.41         11.0 
## 10             3 30 to 45             7.51          9.89
## # ℹ 23 more rows</code></pre>
</div>
</div>
<div id="assessing-model-performance" class="section level3 hasAnchor" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Assessing model performance<a href="intermediate-regression.html#assessing-model-performance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Model performance metrics</strong></p>
<ul>
<li><p>Coefficient of determination (<em>R</em>-squared)</p>
<ul>
<li><p>How well the linear regression line fits the observed values.</p></li>
<li><p>Larger is better.</p></li>
</ul></li>
<li><p>Residual standard error (<em>RSE</em>)</p>
<ul>
<li><p>The typical size of the residuals.</p></li>
<li><p>Smaller is better.</p></li>
</ul></li>
<li><p>Adjusted coefficient of determination (Adjusted <em>R</em>-squared)</p>
<ul>
<li><p>More explanatory variables increases <em>R</em><span class="smallcaps">²</span>. Too many explanatory variables causes overfitting.</p></li>
<li><p>Adjusted coefficient of determination penalizes more explanatory variables.</p></li>
</ul></li>
</ul>
<div id="compare-adjusted-r²" class="section level4 hasAnchor" number="15.1.3.1">
<h4><span class="header-section-number">15.1.3.1</span> Compare <em>adjusted R²</em><a href="intermediate-regression.html#compare-adjusted-r²" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here you’ll compare the coefficient of determination for the three Taiwan house price models, to see which gives the best result.</p>
<div class="sourceCode" id="cb1966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1966-1"><a href="intermediate-regression.html#cb1966-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1966-2"><a href="intermediate-regression.html#cb1966-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1966-3"><a href="intermediate-regression.html#cb1966-3" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv <span class="sc">%&gt;%</span> </span>
<span id="cb1966-4"><a href="intermediate-regression.html#cb1966-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the model-level coefficients</span></span>
<span id="cb1966-5"><a href="intermediate-regression.html#cb1966-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1966-6"><a href="intermediate-regression.html#cb1966-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select the coeffs of determination</span></span>
<span id="cb1966-7"><a href="intermediate-regression.html#cb1966-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared, adj.r.squared)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   r.squared adj.r.squared
##       &lt;dbl&gt;         &lt;dbl&gt;
## 1     0.326         0.324</code></pre>
<div class="sourceCode" id="cb1968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1968-1"><a href="intermediate-regression.html#cb1968-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coeffs of determination for mdl_price_vs_age</span></span>
<span id="cb1968-2"><a href="intermediate-regression.html#cb1968-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_age <span class="sc">%&gt;%</span> </span>
<span id="cb1968-3"><a href="intermediate-regression.html#cb1968-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1968-4"><a href="intermediate-regression.html#cb1968-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared, adj.r.squared)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   r.squared adj.r.squared
##       &lt;dbl&gt;         &lt;dbl&gt;
## 1     0.896         0.895</code></pre>
<div class="sourceCode" id="cb1970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1970-1"><a href="intermediate-regression.html#cb1970-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coeffs of determination for mdl_price_vs_both</span></span>
<span id="cb1970-2"><a href="intermediate-regression.html#cb1970-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both <span class="sc">%&gt;%</span> </span>
<span id="cb1970-3"><a href="intermediate-regression.html#cb1970-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1970-4"><a href="intermediate-regression.html#cb1970-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared, adj.r.squared)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   r.squared adj.r.squared
##       &lt;dbl&gt;         &lt;dbl&gt;
## 1     0.931         0.931</code></pre>
<p>When both explanatory variables are included in the model, the adjusted coefficient of determination is higher, resulting in a better fit.</p>
</div>
<div id="compare-rse" class="section level4 hasAnchor" number="15.1.3.2">
<h4><span class="header-section-number">15.1.3.2</span> Compare <em>RSE</em><a href="intermediate-regression.html#compare-rse" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1972-1"><a href="intermediate-regression.html#cb1972-1" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv <span class="sc">%&gt;%</span> </span>
<span id="cb1972-2"><a href="intermediate-regression.html#cb1972-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the model-level coefficients</span></span>
<span id="cb1972-3"><a href="intermediate-regression.html#cb1972-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1972-4"><a href="intermediate-regression.html#cb1972-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pull out the RSE</span></span>
<span id="cb1972-5"><a href="intermediate-regression.html#cb1972-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 3.38</code></pre>
<div class="sourceCode" id="cb1974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1974-1"><a href="intermediate-regression.html#cb1974-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE for mdl_price_vs_age</span></span>
<span id="cb1974-2"><a href="intermediate-regression.html#cb1974-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_age <span class="sc">%&gt;%</span> </span>
<span id="cb1974-3"><a href="intermediate-regression.html#cb1974-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1974-4"><a href="intermediate-regression.html#cb1974-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 3.95</code></pre>
<div class="sourceCode" id="cb1976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1976-1"><a href="intermediate-regression.html#cb1976-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE for mdl_price_vs_both</span></span>
<span id="cb1976-2"><a href="intermediate-regression.html#cb1976-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both <span class="sc">%&gt;%</span> </span>
<span id="cb1976-3"><a href="intermediate-regression.html#cb1976-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1976-4"><a href="intermediate-regression.html#cb1976-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 3.21</code></pre>
<p>By including both explanatory variables in the model, a lower RSE was achieved, indicating a smaller difference between the predicted responses and the actual responses.</p>
</div>
</div>
</div>
<div id="interactions" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Interactions<a href="intermediate-regression.html#interactions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="models-for-each-category" class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Models for each category<a href="intermediate-regression.html#models-for-each-category" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="one-model-per-category" class="section level4 hasAnchor" number="15.2.1.1">
<h4><span class="header-section-number">15.2.1.1</span> One model per category<a href="intermediate-regression.html#one-model-per-category" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The model you ran on the whole dataset fits some parts of the data better than others. It’s worth taking a look at what happens when you run a linear model on different parts of the dataset separately, to see if each model agrees or disagrees with the others.</p>
<div class="sourceCode" id="cb1978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1978-1"><a href="intermediate-regression.html#cb1978-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for rows where house age is 0 to 15 years</span></span>
<span id="cb1978-2"><a href="intermediate-regression.html#cb1978-2" aria-hidden="true" tabindex="-1"></a>taiwan_0_to_15 <span class="ot">&lt;-</span> taiwan_real_estate <span class="sc">%&gt;%</span> <span class="fu">filter</span>(house_age_years <span class="sc">==</span> <span class="st">&quot;0 to 15&quot;</span>)</span>
<span id="cb1978-3"><a href="intermediate-regression.html#cb1978-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-4"><a href="intermediate-regression.html#cb1978-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for rows where house age is 15 to 30 years</span></span>
<span id="cb1978-5"><a href="intermediate-regression.html#cb1978-5" aria-hidden="true" tabindex="-1"></a>taiwan_15_to_30 <span class="ot">&lt;-</span> taiwan_real_estate <span class="sc">%&gt;%</span> <span class="fu">filter</span>(house_age_years <span class="sc">==</span> <span class="st">&quot;15 to 30&quot;</span>)</span>
<span id="cb1978-6"><a href="intermediate-regression.html#cb1978-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-7"><a href="intermediate-regression.html#cb1978-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for rows where house age is 30 to 45 years</span></span>
<span id="cb1978-8"><a href="intermediate-regression.html#cb1978-8" aria-hidden="true" tabindex="-1"></a>taiwan_30_to_45 <span class="ot">&lt;-</span> taiwan_real_estate <span class="sc">%&gt;%</span> <span class="fu">filter</span>(house_age_years <span class="sc">==</span> <span class="st">&quot;30 to 45&quot;</span>)</span>
<span id="cb1978-9"><a href="intermediate-regression.html#cb1978-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-10"><a href="intermediate-regression.html#cb1978-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. no. convenience stores using 0 to 15 data</span></span>
<span id="cb1978-11"><a href="intermediate-regression.html#cb1978-11" aria-hidden="true" tabindex="-1"></a>mdl_0_to_15 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience, taiwan_0_to_15)</span>
<span id="cb1978-12"><a href="intermediate-regression.html#cb1978-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-13"><a href="intermediate-regression.html#cb1978-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. no. convenience stores using 15 to 30 data</span></span>
<span id="cb1978-14"><a href="intermediate-regression.html#cb1978-14" aria-hidden="true" tabindex="-1"></a>mdl_15_to_30 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience, taiwan_15_to_30)</span>
<span id="cb1978-15"><a href="intermediate-regression.html#cb1978-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-16"><a href="intermediate-regression.html#cb1978-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. no. convenience stores using 30 to 45 data</span></span>
<span id="cb1978-17"><a href="intermediate-regression.html#cb1978-17" aria-hidden="true" tabindex="-1"></a>mdl_30_to_45 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience, taiwan_30_to_45)</span>
<span id="cb1978-18"><a href="intermediate-regression.html#cb1978-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-19"><a href="intermediate-regression.html#cb1978-19" aria-hidden="true" tabindex="-1"></a><span class="co"># See the results</span></span>
<span id="cb1978-20"><a href="intermediate-regression.html#cb1978-20" aria-hidden="true" tabindex="-1"></a>mdl_0_to_15</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience, data = taiwan_0_to_15)
## 
## Coefficients:
##   (Intercept)  n_convenience  
##         9.242          0.834</code></pre>
<div class="sourceCode" id="cb1980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1980-1"><a href="intermediate-regression.html#cb1980-1" aria-hidden="true" tabindex="-1"></a>mdl_15_to_30</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience, data = taiwan_15_to_30)
## 
## Coefficients:
##   (Intercept)  n_convenience  
##         6.872          0.852</code></pre>
<div class="sourceCode" id="cb1982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1982-1"><a href="intermediate-regression.html#cb1982-1" aria-hidden="true" tabindex="-1"></a>mdl_30_to_45</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience, data = taiwan_30_to_45)
## 
## Coefficients:
##   (Intercept)  n_convenience  
##         8.113          0.669</code></pre>
</div>
<div id="predicting-multiple-models" class="section level4 hasAnchor" number="15.2.1.2">
<h4><span class="header-section-number">15.2.1.2</span> Predicting multiple models<a href="intermediate-regression.html#predicting-multiple-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In order to see what each of the models for individual categories are doing, it’s helpful to make predictions from them.</p>
<p>Remember that you only have a single explanatory variable in these models, so <code>expand_grid()</code> isn’t needed.</p>
<div class="sourceCode" id="cb1984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1984-1"><a href="intermediate-regression.html#cb1984-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column of predictions using &quot;0 to 15&quot; model and explanatory data </span></span>
<span id="cb1984-2"><a href="intermediate-regression.html#cb1984-2" aria-hidden="true" tabindex="-1"></a>prediction_data_0_to_15 <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span> </span>
<span id="cb1984-3"><a href="intermediate-regression.html#cb1984-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_0_to_15, explanatory_data))</span>
<span id="cb1984-4"><a href="intermediate-regression.html#cb1984-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-5"><a href="intermediate-regression.html#cb1984-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Same again, with &quot;15 to 30&quot;</span></span>
<span id="cb1984-6"><a href="intermediate-regression.html#cb1984-6" aria-hidden="true" tabindex="-1"></a>prediction_data_15_to_30 <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span> </span>
<span id="cb1984-7"><a href="intermediate-regression.html#cb1984-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_15_to_30, explanatory_data))</span>
<span id="cb1984-8"><a href="intermediate-regression.html#cb1984-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-9"><a href="intermediate-regression.html#cb1984-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Same again, with &quot;30 to 45&quot;</span></span>
<span id="cb1984-10"><a href="intermediate-regression.html#cb1984-10" aria-hidden="true" tabindex="-1"></a>prediction_data_30_to_45 <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span> </span>
<span id="cb1984-11"><a href="intermediate-regression.html#cb1984-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_30_to_45, explanatory_data))</span></code></pre></div>
</div>
<div id="visualizing-multiple-models" class="section level4 hasAnchor" number="15.2.1.3">
<h4><span class="header-section-number">15.2.1.3</span> Visualizing multiple models<a href="intermediate-regression.html#visualizing-multiple-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1985-1"><a href="intermediate-regression.html#cb1985-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extend the plot to include prediction points</span></span>
<span id="cb1985-2"><a href="intermediate-regression.html#cb1985-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, <span class="fu">aes</span>(n_convenience, price_twd_msq, </span>
<span id="cb1985-3"><a href="intermediate-regression.html#cb1985-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> house_age_years)) <span class="sc">+</span></span>
<span id="cb1985-4"><a href="intermediate-regression.html#cb1985-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1985-5"><a href="intermediate-regression.html#cb1985-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1985-6"><a href="intermediate-regression.html#cb1985-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points using prediction_data_0_to_15, colored red, size 3, shape 15</span></span>
<span id="cb1985-7"><a href="intermediate-regression.html#cb1985-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data_0_to_15, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb1985-8"><a href="intermediate-regression.html#cb1985-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points using prediction_data_15_to_30, colored green, size 3, shape 15</span></span>
<span id="cb1985-9"><a href="intermediate-regression.html#cb1985-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data_15_to_30, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb1985-10"><a href="intermediate-regression.html#cb1985-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points using prediction_data_30_to_45, colored blue, size 3, shape 15</span></span>
<span id="cb1985-11"><a href="intermediate-regression.html#cb1985-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data_30_to_45, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-713-1.png" width="672" /></p>
<p>It’s a good sign that our predictions match those of ggplot’s. Notice that the 30 to 45 year house age group has a much shallower slope compared to the other lines.</p>
</div>
<div id="assessing-model-performance-1" class="section level4 hasAnchor" number="15.2.1.4">
<h4><span class="header-section-number">15.2.1.4</span> Assessing model performance<a href="intermediate-regression.html#assessing-model-performance-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To test which approach is best—the whole dataset model or the models for each house age category—you need to calculate some metrics.</p>
<p>Here’s, you’ll compare the coefficient of determination and the residual standard error for each model.</p>
<div class="sourceCode" id="cb1987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1987-1"><a href="intermediate-regression.html#cb1987-1" aria-hidden="true" tabindex="-1"></a>mdl_all_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> price_twd_msq <span class="sc">~</span> n_convenience, <span class="at">data =</span> taiwan_real_estate)</span>
<span id="cb1987-2"><a href="intermediate-regression.html#cb1987-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1987-3"><a href="intermediate-regression.html#cb1987-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coeff. of determination for mdl_all_ages</span></span>
<span id="cb1987-4"><a href="intermediate-regression.html#cb1987-4" aria-hidden="true" tabindex="-1"></a>mdl_all_ages <span class="sc">%&gt;%</span></span>
<span id="cb1987-5"><a href="intermediate-regression.html#cb1987-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1987-6"><a href="intermediate-regression.html#cb1987-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(r.squared)</span></code></pre></div>
<pre><code>## [1] 0.326</code></pre>
<div class="sourceCode" id="cb1989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1989-1"><a href="intermediate-regression.html#cb1989-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coeff. of determination for mdl_0_to_15</span></span>
<span id="cb1989-2"><a href="intermediate-regression.html#cb1989-2" aria-hidden="true" tabindex="-1"></a>mdl_0_to_15 <span class="sc">%&gt;%</span></span>
<span id="cb1989-3"><a href="intermediate-regression.html#cb1989-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1989-4"><a href="intermediate-regression.html#cb1989-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(r.squared)</span></code></pre></div>
<pre><code>## [1] 0.312</code></pre>
<div class="sourceCode" id="cb1991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1991-1"><a href="intermediate-regression.html#cb1991-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coeff. of determination for mdl_15_to_30</span></span>
<span id="cb1991-2"><a href="intermediate-regression.html#cb1991-2" aria-hidden="true" tabindex="-1"></a>mdl_15_to_30 <span class="sc">%&gt;%</span></span>
<span id="cb1991-3"><a href="intermediate-regression.html#cb1991-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1991-4"><a href="intermediate-regression.html#cb1991-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(r.squared)</span></code></pre></div>
<pre><code>## [1] 0.442</code></pre>
<div class="sourceCode" id="cb1993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1993-1"><a href="intermediate-regression.html#cb1993-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coeff. of determination for mdl_30_to_45</span></span>
<span id="cb1993-2"><a href="intermediate-regression.html#cb1993-2" aria-hidden="true" tabindex="-1"></a>mdl_30_to_45 <span class="sc">%&gt;%</span></span>
<span id="cb1993-3"><a href="intermediate-regression.html#cb1993-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1993-4"><a href="intermediate-regression.html#cb1993-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(r.squared)</span></code></pre></div>
<pre><code>## [1] 0.313</code></pre>
<div class="sourceCode" id="cb1995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1995-1"><a href="intermediate-regression.html#cb1995-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE for mdl_all_age</span></span>
<span id="cb1995-2"><a href="intermediate-regression.html#cb1995-2" aria-hidden="true" tabindex="-1"></a>mdl_all_ages <span class="sc">%&gt;%</span></span>
<span id="cb1995-3"><a href="intermediate-regression.html#cb1995-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1995-4"><a href="intermediate-regression.html#cb1995-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 3.38</code></pre>
<div class="sourceCode" id="cb1997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1997-1"><a href="intermediate-regression.html#cb1997-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE for mdl_0_to_15</span></span>
<span id="cb1997-2"><a href="intermediate-regression.html#cb1997-2" aria-hidden="true" tabindex="-1"></a>mdl_0_to_15 <span class="sc">%&gt;%</span></span>
<span id="cb1997-3"><a href="intermediate-regression.html#cb1997-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1997-4"><a href="intermediate-regression.html#cb1997-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 3.56</code></pre>
<div class="sourceCode" id="cb1999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1999-1"><a href="intermediate-regression.html#cb1999-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE for mdl_15_to_30</span></span>
<span id="cb1999-2"><a href="intermediate-regression.html#cb1999-2" aria-hidden="true" tabindex="-1"></a>mdl_15_to_30 <span class="sc">%&gt;%</span></span>
<span id="cb1999-3"><a href="intermediate-regression.html#cb1999-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1999-4"><a href="intermediate-regression.html#cb1999-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 2.59</code></pre>
<div class="sourceCode" id="cb2001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2001-1"><a href="intermediate-regression.html#cb2001-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE for mdl_30_to_45</span></span>
<span id="cb2001-2"><a href="intermediate-regression.html#cb2001-2" aria-hidden="true" tabindex="-1"></a>mdl_30_to_45 <span class="sc">%&gt;%</span></span>
<span id="cb2001-3"><a href="intermediate-regression.html#cb2001-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2001-4"><a href="intermediate-regression.html#cb2001-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(sigma)</span></code></pre></div>
<pre><code>## [1] 3.24</code></pre>
<p>It seems that both metrics for the 15 to 30 age group model are much better than those for the whole dataset model, but the models for the other two age groups are similar to the whole dataset model.</p>
<p>Thus using individual models will improve predictions for 15 to 30 age group.</p>
</div>
</div>
<div id="one-model-with-an-interaction" class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> One model with an interaction<a href="intermediate-regression.html#one-model-with-an-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>What is an interaction?</strong></p>
<div class="line-block">The effect of one explanatory variable on the expected response changes depending on the value of another explanatory variable.</div>
<p><strong>Specifying interactions</strong></p>
<ul>
<li><p>No interactions</p>
<ul>
<li><code>response ~ explntry1 + explntry2</code></li>
</ul></li>
<li><p>With interactions (implicit)</p>
<ul>
<li><code>response_var ~ explntry1 * explntry2</code></li>
</ul></li>
<li><p>With interactions (explicit)</p>
<ul>
<li><code>response ~ explntry1 + explntry2 + explntry1:explntry2</code></li>
</ul></li>
</ul>
<div id="specifying-an-interaction" class="section level4 hasAnchor" number="15.2.2.1">
<h4><span class="header-section-number">15.2.2.1</span> Specifying an interaction<a href="intermediate-regression.html#specifying-an-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ideally, you’d have a single model that had all the predictive power of the individual models.</p>
<p>Defining this single model is achieved through adding interactions between explanatory variables.</p>
<p>Concise code that is quick to type and to read.</p>
<div class="sourceCode" id="cb2003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2003-1"><a href="intermediate-regression.html#cb2003-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs both with an interaction using &quot;times&quot; syntax</span></span>
<span id="cb2003-2"><a href="intermediate-regression.html#cb2003-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience <span class="sc">*</span> house_age_years, taiwan_real_estate)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience * house_age_years, 
##     data = taiwan_real_estate)
## 
## Coefficients:
##                           (Intercept)                          n_convenience  
##                                9.2417                                 0.8336  
##               house_age_years15 to 30                house_age_years30 to 45  
##                               -2.3698                                -1.1286  
## n_convenience:house_age_years15 to 30  n_convenience:house_age_years30 to 45  
##                                0.0183                                -0.1649</code></pre>
<p>Explicit code that describes what you are doing in detail.</p>
<div class="sourceCode" id="cb2005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2005-1"><a href="intermediate-regression.html#cb2005-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs both with an interaction using &quot;colon&quot; syntax</span></span>
<span id="cb2005-2"><a href="intermediate-regression.html#cb2005-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience <span class="sc">+</span> house_age_years <span class="sc">+</span> n_convenience<span class="sc">:</span> house_age_years, taiwan_real_estate)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience + house_age_years + 
##     n_convenience:house_age_years, data = taiwan_real_estate)
## 
## Coefficients:
##                           (Intercept)                          n_convenience  
##                                9.2417                                 0.8336  
##               house_age_years15 to 30                house_age_years30 to 45  
##                               -2.3698                                -1.1286  
## n_convenience:house_age_years15 to 30  n_convenience:house_age_years30 to 45  
##                                0.0183                                -0.1649</code></pre>
</div>
<div id="understandable-coeffs" class="section level4 hasAnchor" number="15.2.2.2">
<h4><span class="header-section-number">15.2.2.2</span> Understandable coeffs<a href="intermediate-regression.html#understandable-coeffs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The previous model with the interaction term returned coefficients that were a little tricky to interpret. In order clarify what the model is predicting, you can reformulate the model in a way that returns understandable coefficients.</p>
<p>For further clarity, you can compare the results to the models on the separate house age categories.</p>
<p>Fit a linear regression of <code>price_twd_msq</code> versus <code>house_age_years</code> plus an interaction between <code>n_convenience</code> and <code>house_age_years</code>, and no global intercept.</p>
<div class="sourceCode" id="cb2007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2007-1"><a href="intermediate-regression.html#cb2007-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. house age plus an interaction, no intercept</span></span>
<span id="cb2007-2"><a href="intermediate-regression.html#cb2007-2" aria-hidden="true" tabindex="-1"></a>mdl_readable_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> house_age_years <span class="sc">+</span> house_age_years<span class="sc">:</span>n_convenience <span class="sc">+</span> <span class="dv">0</span>, taiwan_real_estate)</span>
<span id="cb2007-3"><a href="intermediate-regression.html#cb2007-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2007-4"><a href="intermediate-regression.html#cb2007-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2007-5"><a href="intermediate-regression.html#cb2007-5" aria-hidden="true" tabindex="-1"></a>mdl_readable_inter</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ house_age_years + house_age_years:n_convenience + 
##     0, data = taiwan_real_estate)
## 
## Coefficients:
##                house_age_years0 to 15                house_age_years15 to 30  
##                                 9.242                                  6.872  
##               house_age_years30 to 45   house_age_years0 to 15:n_convenience  
##                                 8.113                                  0.834  
## house_age_years15 to 30:n_convenience  house_age_years30 to 45:n_convenience  
##                                 0.852                                  0.669</code></pre>
<p>The expected increase in house price for each nearby convenience store is lowest for the 30 to 45 year age group.</p>
<p>For comparison, get the coefficients for the three models for each category.</p>
<div class="sourceCode" id="cb2009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2009-1"><a href="intermediate-regression.html#cb2009-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficients for mdl_0_to_15</span></span>
<span id="cb2009-2"><a href="intermediate-regression.html#cb2009-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mdl_0_to_15)</span></code></pre></div>
<pre><code>##   (Intercept) n_convenience 
##         9.242         0.834</code></pre>
<div class="sourceCode" id="cb2011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2011-1"><a href="intermediate-regression.html#cb2011-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficients for mdl_15_to_30</span></span>
<span id="cb2011-2"><a href="intermediate-regression.html#cb2011-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mdl_15_to_30)</span></code></pre></div>
<pre><code>##   (Intercept) n_convenience 
##         6.872         0.852</code></pre>
<div class="sourceCode" id="cb2013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2013-1"><a href="intermediate-regression.html#cb2013-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficients for mdl_30_to_45</span></span>
<span id="cb2013-2"><a href="intermediate-regression.html#cb2013-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mdl_15_to_30)</span></code></pre></div>
<pre><code>##   (Intercept) n_convenience 
##         6.872         0.852</code></pre>
<p>Sometimes fiddling about with how the model formula is specified makes it easier to interpret the coefficients. In this version, you can see how each category has its own intercept and slope (just like the 3 separate models had).</p>
</div>
</div>
<div id="predict-with-interactions" class="section level3 hasAnchor" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Predict with interactions<a href="intermediate-regression.html#predict-with-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="predicting-with-interactions" class="section level4 hasAnchor" number="15.2.3.1">
<h4><span class="header-section-number">15.2.3.1</span> Predicting with interactions<a href="intermediate-regression.html#predicting-with-interactions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb2015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2015-1"><a href="intermediate-regression.html#cb2015-1" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> house_age_years <span class="sc">+</span> n_convenience<span class="sc">:</span>house_age_years <span class="sc">+</span> <span class="dv">0</span>, taiwan_real_estate)</span>
<span id="cb2015-2"><a href="intermediate-regression.html#cb2015-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2015-3"><a href="intermediate-regression.html#cb2015-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a grid of explanatory data</span></span>
<span id="cb2015-4"><a href="intermediate-regression.html#cb2015-4" aria-hidden="true" tabindex="-1"></a>explanatory_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb2015-5"><a href="intermediate-regression.html#cb2015-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set n_convenience to zero to ten</span></span>
<span id="cb2015-6"><a href="intermediate-regression.html#cb2015-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_convenience =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb2015-7"><a href="intermediate-regression.html#cb2015-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set house_age_years to the unique values of that variable</span></span>
<span id="cb2015-8"><a href="intermediate-regression.html#cb2015-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">house_age_years =</span> <span class="fu">unique</span>(taiwan_real_estate<span class="sc">$</span>house_age_years)</span>
<span id="cb2015-9"><a href="intermediate-regression.html#cb2015-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2015-10"><a href="intermediate-regression.html#cb2015-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2015-11"><a href="intermediate-regression.html#cb2015-11" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2015-12"><a href="intermediate-regression.html#cb2015-12" aria-hidden="true" tabindex="-1"></a>explanatory_data</span></code></pre></div>
<pre><code>## # A tibble: 33 × 2
##    n_convenience house_age_years
##            &lt;int&gt; &lt;fct&gt;          
##  1             0 30 to 45       
##  2             0 15 to 30       
##  3             0 0 to 15        
##  4             1 30 to 45       
##  5             1 15 to 30       
##  6             1 0 to 15        
##  7             2 30 to 45       
##  8             2 15 to 30       
##  9             2 0 to 15        
## 10             3 30 to 45       
## # ℹ 23 more rows</code></pre>
<div class="sourceCode" id="cb2017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2017-1"><a href="intermediate-regression.html#cb2017-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to the data frame</span></span>
<span id="cb2017-2"><a href="intermediate-regression.html#cb2017-2" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span></span>
<span id="cb2017-3"><a href="intermediate-regression.html#cb2017-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_price_vs_both_inter, explanatory_data))</span>
<span id="cb2017-4"><a href="intermediate-regression.html#cb2017-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2017-5"><a href="intermediate-regression.html#cb2017-5" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2017-6"><a href="intermediate-regression.html#cb2017-6" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    n_convenience house_age_years price_twd_msq
##            &lt;int&gt; &lt;fct&gt;                   &lt;dbl&gt;
##  1             0 30 to 45                 8.11
##  2             0 15 to 30                 6.87
##  3             0 0 to 15                  9.24
##  4             1 30 to 45                 8.78
##  5             1 15 to 30                 7.72
##  6             1 0 to 15                 10.1 
##  7             2 30 to 45                 9.45
##  8             2 15 to 30                 8.58
##  9             2 0 to 15                 10.9 
## 10             3 30 to 45                10.1 
## # ℹ 23 more rows</code></pre>
<div class="sourceCode" id="cb2019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2019-1"><a href="intermediate-regression.html#cb2019-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using taiwan_real_estate, plot price vs. no. of convenience stores, colored by house age</span></span>
<span id="cb2019-2"><a href="intermediate-regression.html#cb2019-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, <span class="fu">aes</span>(n_convenience, price_twd_msq, <span class="at">color =</span> house_age_years)) <span class="sc">+</span></span>
<span id="cb2019-3"><a href="intermediate-regression.html#cb2019-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make it a scatter plot</span></span>
<span id="cb2019-4"><a href="intermediate-regression.html#cb2019-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2019-5"><a href="intermediate-regression.html#cb2019-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add linear regression trend lines, no ribbon</span></span>
<span id="cb2019-6"><a href="intermediate-regression.html#cb2019-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-722-1.png" width="672" /></p>
<div class="sourceCode" id="cb2021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2021-1"><a href="intermediate-regression.html#cb2021-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points from prediction_data, size 5, shape 15</span></span>
<span id="cb2021-2"><a href="intermediate-regression.html#cb2021-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>## geom_point: na.rm = FALSE
## stat_identity: na.rm = FALSE
## position_identity</code></pre>
</div>
<div id="manually-calculating-predictions-1" class="section level4 hasAnchor" number="15.2.3.2">
<h4><span class="header-section-number">15.2.3.2</span> Manually calculating predictions<a href="intermediate-regression.html#manually-calculating-predictions-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For <code>mdl_price_vs_both_inter</code> model, there are three separate lines to calculate for, and in each one, the prediction is an intercept plus a slope times the numeric explanatory value.</p>
<div class="sourceCode" id="cb2023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2023-1"><a href="intermediate-regression.html#cb2023-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coefficients from mdl_price_vs_both_inter</span></span>
<span id="cb2023-2"><a href="intermediate-regression.html#cb2023-2" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(mdl_price_vs_both_inter)</span>
<span id="cb2023-3"><a href="intermediate-regression.html#cb2023-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-4"><a href="intermediate-regression.html#cb2023-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the intercept for 0 to 15 year age group</span></span>
<span id="cb2023-5"><a href="intermediate-regression.html#cb2023-5" aria-hidden="true" tabindex="-1"></a>intercept_0_15 <span class="ot">&lt;-</span> coeffs[<span class="dv">1</span>]</span>
<span id="cb2023-6"><a href="intermediate-regression.html#cb2023-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-7"><a href="intermediate-regression.html#cb2023-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the intercept for 15 to 30 year age group</span></span>
<span id="cb2023-8"><a href="intermediate-regression.html#cb2023-8" aria-hidden="true" tabindex="-1"></a>intercept_15_30 <span class="ot">&lt;-</span> coeffs[<span class="dv">2</span>]</span>
<span id="cb2023-9"><a href="intermediate-regression.html#cb2023-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-10"><a href="intermediate-regression.html#cb2023-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the intercept for 30 to 45 year age group</span></span>
<span id="cb2023-11"><a href="intermediate-regression.html#cb2023-11" aria-hidden="true" tabindex="-1"></a>intercept_30_45 <span class="ot">&lt;-</span> coeffs[<span class="dv">3</span>]</span>
<span id="cb2023-12"><a href="intermediate-regression.html#cb2023-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-13"><a href="intermediate-regression.html#cb2023-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the slope for 0 to 15 year age group</span></span>
<span id="cb2023-14"><a href="intermediate-regression.html#cb2023-14" aria-hidden="true" tabindex="-1"></a>slope_0_15 <span class="ot">&lt;-</span> coeffs[<span class="dv">4</span>]</span>
<span id="cb2023-15"><a href="intermediate-regression.html#cb2023-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-16"><a href="intermediate-regression.html#cb2023-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the slope for 15 to 30 year age group</span></span>
<span id="cb2023-17"><a href="intermediate-regression.html#cb2023-17" aria-hidden="true" tabindex="-1"></a>slope_15_30 <span class="ot">&lt;-</span> coeffs[<span class="dv">5</span>]</span>
<span id="cb2023-18"><a href="intermediate-regression.html#cb2023-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-19"><a href="intermediate-regression.html#cb2023-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the slope for 30 to 45 year age group</span></span>
<span id="cb2023-20"><a href="intermediate-regression.html#cb2023-20" aria-hidden="true" tabindex="-1"></a>slope_30_45 <span class="ot">&lt;-</span> coeffs[<span class="dv">6</span>]</span>
<span id="cb2023-21"><a href="intermediate-regression.html#cb2023-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-22"><a href="intermediate-regression.html#cb2023-22" aria-hidden="true" tabindex="-1"></a>coeffs</span></code></pre></div>
<pre><code>##                house_age_years0 to 15               house_age_years15 to 30 
##                                 9.242                                 6.872 
##               house_age_years30 to 45  house_age_years0 to 15:n_convenience 
##                                 8.113                                 0.834 
## house_age_years15 to 30:n_convenience house_age_years30 to 45:n_convenience 
##                                 0.852                                 0.669</code></pre>
<div class="sourceCode" id="cb2025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2025-1"><a href="intermediate-regression.html#cb2025-1" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span> </span>
<span id="cb2025-2"><a href="intermediate-regression.html#cb2025-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2025-3"><a href="intermediate-regression.html#cb2025-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Consider the 3 cases to choose the price</span></span>
<span id="cb2025-4"><a href="intermediate-regression.html#cb2025-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">price_twd_msq =</span> <span class="fu">case_when</span>(</span>
<span id="cb2025-5"><a href="intermediate-regression.html#cb2025-5" aria-hidden="true" tabindex="-1"></a>      house_age_years <span class="sc">==</span> <span class="st">&quot;0 to 15&quot;</span> <span class="sc">~</span> intercept_0_15 <span class="sc">+</span> slope_0_15 <span class="sc">*</span> n_convenience,</span>
<span id="cb2025-6"><a href="intermediate-regression.html#cb2025-6" aria-hidden="true" tabindex="-1"></a>      house_age_years <span class="sc">==</span> <span class="st">&quot;15 to 30&quot;</span> <span class="sc">~</span> intercept_15_30 <span class="sc">+</span> slope_15_30 <span class="sc">*</span> n_convenience,</span>
<span id="cb2025-7"><a href="intermediate-regression.html#cb2025-7" aria-hidden="true" tabindex="-1"></a>      house_age_years <span class="sc">==</span> <span class="st">&quot;30 to 45&quot;</span> <span class="sc">~</span> intercept_30_45 <span class="sc">+</span> slope_30_45 <span class="sc">*</span> n_convenience</span>
<span id="cb2025-8"><a href="intermediate-regression.html#cb2025-8" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb2025-9"><a href="intermediate-regression.html#cb2025-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2025-10"><a href="intermediate-regression.html#cb2025-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2025-11"><a href="intermediate-regression.html#cb2025-11" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2025-12"><a href="intermediate-regression.html#cb2025-12" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    n_convenience house_age_years price_twd_msq
##            &lt;int&gt; &lt;fct&gt;                   &lt;dbl&gt;
##  1             0 30 to 45                 8.11
##  2             0 15 to 30                 6.87
##  3             0 0 to 15                  9.24
##  4             1 30 to 45                 8.78
##  5             1 15 to 30                 7.72
##  6             1 0 to 15                 10.1 
##  7             2 30 to 45                 9.45
##  8             2 15 to 30                 8.58
##  9             2 0 to 15                 10.9 
## 10             3 30 to 45                10.1 
## # ℹ 23 more rows</code></pre>
</div>
</div>
<div id="simpsons-paradox" class="section level3 hasAnchor" number="15.2.4">
<h3><span class="header-section-number">15.2.4</span> Simpson’s Paradox<a href="intermediate-regression.html#simpsons-paradox" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simpson’s Paradox occurs when the trend (trend = slope coefficient) of a model on the whole dataset is very different from the trends shown by models on subsets of the dataset.</p>
<p><img src="image/Simpson&#39;s%20Paradox%20example.png" width="653" /></p>
<ul>
<li><p>You can’t choose the best model in general — it depends on the dataset and the question you are trying to answer.</p></li>
<li><p>Usually (but not always) the grouped model contains more insight.</p></li>
</ul>
<div id="modeling-1" class="section level4 hasAnchor" number="15.2.4.1">
<h4><span class="header-section-number">15.2.4.1</span> Modeling<a href="intermediate-regression.html#modeling-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes modeling a whole dataset suggests trends that disagree with models on separate parts of that dataset. This is known as Simpson’s paradox.</p>
<p>In the most extreme case, you may see a positive slope on the whole dataset, and negative slopes on every subset of that dataset (or the other way around).</p>
<p>You’ll look at eBay auctions of Palm Pilot M515 PDA models.</p>
<ul>
<li><p><code>price</code> : Final sale price, USD</p></li>
<li><p><code>openbid</code> : The opening bid, USD</p></li>
<li><p><code>auction_type</code> : How long did the auction last?</p></li>
</ul>
<div class="sourceCode" id="cb2027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2027-1"><a href="intermediate-regression.html#cb2027-1" aria-hidden="true" tabindex="-1"></a>auctions <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;data/auctions.txt&quot;</span>)</span>
<span id="cb2027-2"><a href="intermediate-regression.html#cb2027-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-3"><a href="intermediate-regression.html#cb2027-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a glimpse at the dataset</span></span>
<span id="cb2027-4"><a href="intermediate-regression.html#cb2027-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(auctions)</span></code></pre></div>
<pre><code>## Rows: 343
## Columns: 3
## $ price        &lt;dbl&gt; 260, 257, 260, 238, 232, 251, 248, 238, 232, 242, 250, 24…
## $ openbid      &lt;dbl&gt; 0.01, 0.01, 0.01, 0.01, 1.00, 9.99, 215.00, 155.00, 50.00…
## $ auction_type &lt;chr&gt; &quot;7 day auction&quot;, &quot;3 day auction&quot;, &quot;5 day auction&quot;, &quot;7 day…</code></pre>
<p>Fit a linear regression model of <code>price</code> versus <code>openbid</code>. Look at the coefficients.</p>
<div class="sourceCode" id="cb2029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2029-1"><a href="intermediate-regression.html#cb2029-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. opening bid using auctions</span></span>
<span id="cb2029-2"><a href="intermediate-regression.html#cb2029-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_openbid <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> openbid, auctions)</span>
<span id="cb2029-3"><a href="intermediate-regression.html#cb2029-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2029-4"><a href="intermediate-regression.html#cb2029-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2029-5"><a href="intermediate-regression.html#cb2029-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_openbid</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ openbid, data = auctions)
## 
## Coefficients:
## (Intercept)      openbid  
##    229.2457      -0.0021</code></pre>
<p>Plot <code>price</code> versus <code>openbid</code> as a scatter plot with linear regression trend lines (no ribbon). Look at the trend line.</p>
<div class="sourceCode" id="cb2031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2031-1"><a href="intermediate-regression.html#cb2031-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using auctions, plot price vs. opening bid as a scatter plot with linear regression trend lines</span></span>
<span id="cb2031-2"><a href="intermediate-regression.html#cb2031-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(auctions, <span class="fu">aes</span>(openbid, price)) <span class="sc">+</span></span>
<span id="cb2031-3"><a href="intermediate-regression.html#cb2031-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2031-4"><a href="intermediate-regression.html#cb2031-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-727-1.png" width="672" /></p>
<p>The slope coefficient is small enough that it might as well be zero. That is, opening bid appears to have no effect on the final sale price for Palm Pilots.</p>
</div>
<div id="modeling-each-category-type" class="section level4 hasAnchor" number="15.2.4.2">
<h4><span class="header-section-number">15.2.4.2</span> Modeling each category type<a href="intermediate-regression.html#modeling-each-category-type" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now let’s look at what happens when you model the three auction types (3 day, 5 day, and 7 day) separately.</p>
<div class="sourceCode" id="cb2033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2033-1"><a href="intermediate-regression.html#cb2033-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear regression of price vs. opening bid and auction type, with an interaction.</span></span>
<span id="cb2033-2"><a href="intermediate-regression.html#cb2033-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> openbid <span class="sc">+</span> auction_type <span class="sc">+</span> auction_type<span class="sc">:</span>openbid, auctions)</span>
<span id="cb2033-3"><a href="intermediate-regression.html#cb2033-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2033-4"><a href="intermediate-regression.html#cb2033-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2033-5"><a href="intermediate-regression.html#cb2033-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_both</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ openbid + auction_type + auction_type:openbid, 
##     data = auctions)
## 
## Coefficients:
##                       (Intercept)                            openbid  
##                          226.3690                            -0.0290  
##         auction_type5 day auction          auction_type7 day auction  
##                           -4.7697                             5.2339  
## openbid:auction_type5 day auction  openbid:auction_type7 day auction  
##                            0.1130                             0.0327</code></pre>
<div class="sourceCode" id="cb2035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2035-1"><a href="intermediate-regression.html#cb2035-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using auctions, plot price vs. opening bid colored by auction type as a scatter plot with linear regr&#39;n trend lines</span></span>
<span id="cb2035-2"><a href="intermediate-regression.html#cb2035-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(auctions, <span class="fu">aes</span>(openbid, price, <span class="at">color =</span> auction_type)) <span class="sc">+</span></span>
<span id="cb2035-3"><a href="intermediate-regression.html#cb2035-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2035-4"><a href="intermediate-regression.html#cb2035-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-729-1.png" width="672" /></p>
<p>Interpreting models is a subtle art, and your conclusions need to be based on the question you are trying to answer.</p>
<p>Here, the answer to ‘Does opening bid affect final sale price?’ is no overall.</p>
<p>But the answer to ‘Does opening bid price affect final sale price for any type of auction?’ is yes, for 5 day auctions.</p>
</div>
</div>
</div>
<div id="multiple-linear-regression" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Multiple Linear Regression<a href="intermediate-regression.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="two-numeric-ivs" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Two numeric IVs<a href="intermediate-regression.html#two-numeric-ivs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Visualizing 3 numeric variables</strong></p>
<ul>
<li><p>3D scatter plot</p></li>
<li><p>2D scatter plot with response as color</p></li>
</ul>
<div id="d-visualizations" class="section level4 hasAnchor" number="15.3.1.1">
<h4><span class="header-section-number">15.3.1.1</span> 3D visualizations<a href="intermediate-regression.html#d-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the case of three continuous variables, you can draw a 3D scatter plot, but perspective problems usually make it difficult to interpret.</p>
<p>There are some “flat” alternatives that provide easier interpretation, though they require a little thinking about to make.</p>
<div class="sourceCode" id="cb2037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2037-1"><a href="intermediate-regression.html#cb2037-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3D scatter plot</span></span>
<span id="cb2037-2"><a href="intermediate-regression.html#cb2037-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb2037-3"><a href="intermediate-regression.html#cb2037-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2037-4"><a href="intermediate-regression.html#cb2037-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(fish<span class="sc">$</span>length_cm, fish<span class="sc">$</span>height_cm, fish<span class="sc">$</span>mass_g)</span>
<span id="cb2037-5"><a href="intermediate-regression.html#cb2037-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2037-6"><a href="intermediate-regression.html#cb2037-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cleaner code</span></span>
<span id="cb2037-7"><a href="intermediate-regression.html#cb2037-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb2037-8"><a href="intermediate-regression.html#cb2037-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb2037-9"><a href="intermediate-regression.html#cb2037-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2037-10"><a href="intermediate-regression.html#cb2037-10" aria-hidden="true" tabindex="-1"></a>fish <span class="sc">%$%</span></span>
<span id="cb2037-11"><a href="intermediate-regression.html#cb2037-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scatter3D</span>(length_cm, height_cm, mass_g)</span></code></pre></div>
<p>With the <code>taiwan_real_estate</code> dataset, draw a 3D scatter plot of the number of nearby convenience stores on the x-axis, the <em>square-root</em> of the distance to the nearest MRT stop on the y-axis, and the house price on the z-axis.</p>
<div class="sourceCode" id="cb2038"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2038-1"><a href="intermediate-regression.html#cb2038-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb2038-2"><a href="intermediate-regression.html#cb2038-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span></code></pre></div>
<pre><code>## Warning: package &#39;plot3D&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb2040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2040-1"><a href="intermediate-regression.html#cb2040-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With taiwan_real_estate, draw a 3D scatter plot of no. of conv. stores, sqrt dist to MRT, and price</span></span>
<span id="cb2040-2"><a href="intermediate-regression.html#cb2040-2" aria-hidden="true" tabindex="-1"></a>taiwan_real_estate <span class="sc">%$%</span></span>
<span id="cb2040-3"><a href="intermediate-regression.html#cb2040-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scatter3D</span>(n_convenience, <span class="fu">sqrt</span>(dist_to_mrt_m), price_twd_msq)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-730-1.png" width="672" /></p>
<p>Use the continuous viridis color scale with scatter plot, using the <code>"plasma"</code> option.</p>
<div class="sourceCode" id="cb2041"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2041-1"><a href="intermediate-regression.html#cb2041-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using taiwan_real_estate, plot sqrt dist to MRT vs. no. of conv stores, colored by price</span></span>
<span id="cb2041-2"><a href="intermediate-regression.html#cb2041-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, <span class="fu">aes</span>(n_convenience, <span class="fu">sqrt</span>(dist_to_mrt_m), <span class="at">color =</span> price_twd_msq)) <span class="sc">+</span> </span>
<span id="cb2041-3"><a href="intermediate-regression.html#cb2041-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make it a scatter plot</span></span>
<span id="cb2041-4"><a href="intermediate-regression.html#cb2041-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2041-5"><a href="intermediate-regression.html#cb2041-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the continuous viridis plasma color scale</span></span>
<span id="cb2041-6"><a href="intermediate-regression.html#cb2041-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-731-1.png" width="672" /></p>
<p>3D scatter plots are usually a pain to easily interpret due to problems with perspective. The best alternative for displaying a third variable involves using colors.</p>
</div>
<div id="modeling-2-numeric-ivs" class="section level4 hasAnchor" number="15.3.1.2">
<h4><span class="header-section-number">15.3.1.2</span> Modeling 2 numeric IVs<a href="intermediate-regression.html#modeling-2-numeric-ivs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The code for modeling and predicting with two numeric explanatory variables in the same, other than a slight difference in how to specify the explanatory variables to make predictions against.</p>
<p>Here you’ll model and predict the house prices against the number of nearby convenience stores and the square-root of the distance to the nearest MRT station.</p>
<div class="sourceCode" id="cb2042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2042-1"><a href="intermediate-regression.html#cb2042-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear regression of price vs. no. of conv. stores and sqrt dist. to nearest MRT, no interaction</span></span>
<span id="cb2042-2"><a href="intermediate-regression.html#cb2042-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv_dist <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience <span class="sc">+</span> <span class="fu">sqrt</span>(dist_to_mrt_m), taiwan_real_estate)</span>
<span id="cb2042-3"><a href="intermediate-regression.html#cb2042-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2042-4"><a href="intermediate-regression.html#cb2042-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2042-5"><a href="intermediate-regression.html#cb2042-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv_dist</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience + sqrt(dist_to_mrt_m), 
##     data = taiwan_real_estate)
## 
## Coefficients:
##         (Intercept)        n_convenience  sqrt(dist_to_mrt_m)  
##              15.104                0.214               -0.157</code></pre>
<p>Create expanded grid of explanatory variables with number of convenience stores from 0 to 10 and the distance to the nearest MRT station as a sequence from 0 to 80 in steps of 10, all squared (0, 100, 400, …, 6400).</p>
<div class="sourceCode" id="cb2044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2044-1"><a href="intermediate-regression.html#cb2044-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create expanded grid of explanatory variables with no. of conv. stores and  dist. to nearest MRT</span></span>
<span id="cb2044-2"><a href="intermediate-regression.html#cb2044-2" aria-hidden="true" tabindex="-1"></a>explanatory_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb2044-3"><a href="intermediate-regression.html#cb2044-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_convenience =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb2044-4"><a href="intermediate-regression.html#cb2044-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_to_mrt_m =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2044-5"><a href="intermediate-regression.html#cb2044-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2044-6"><a href="intermediate-regression.html#cb2044-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2044-7"><a href="intermediate-regression.html#cb2044-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions using mdl_price_vs_conv_dist and explanatory_data</span></span>
<span id="cb2044-8"><a href="intermediate-regression.html#cb2044-8" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span></span>
<span id="cb2044-9"><a href="intermediate-regression.html#cb2044-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_price_vs_conv_dist, explanatory_data))</span>
<span id="cb2044-10"><a href="intermediate-regression.html#cb2044-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2044-11"><a href="intermediate-regression.html#cb2044-11" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2044-12"><a href="intermediate-regression.html#cb2044-12" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 99 × 3
##    n_convenience dist_to_mrt_m price_twd_msq
##            &lt;int&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1             0             0         15.1 
##  2             0           100         13.5 
##  3             0           400         12.0 
##  4             0           900         10.4 
##  5             0          1600          8.81
##  6             0          2500          7.24
##  7             0          3600          5.67
##  8             0          4900          4.09
##  9             0          6400          2.52
## 10             1             0         15.3 
## # ℹ 89 more rows</code></pre>
<p>Extend the plot to add a layer of points using the prediction data.</p>
<div class="sourceCode" id="cb2046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2046-1"><a href="intermediate-regression.html#cb2046-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to plot</span></span>
<span id="cb2046-2"><a href="intermediate-regression.html#cb2046-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb2046-3"><a href="intermediate-regression.html#cb2046-3" aria-hidden="true" tabindex="-1"></a>  taiwan_real_estate, </span>
<span id="cb2046-4"><a href="intermediate-regression.html#cb2046-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(n_convenience, <span class="fu">sqrt</span>(dist_to_mrt_m), <span class="at">color =</span> price_twd_msq)</span>
<span id="cb2046-5"><a href="intermediate-regression.html#cb2046-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb2046-6"><a href="intermediate-regression.html#cb2046-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2046-7"><a href="intermediate-regression.html#cb2046-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>)<span class="sc">+</span></span>
<span id="cb2046-8"><a href="intermediate-regression.html#cb2046-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add prediction points colored yellow, size 3</span></span>
<span id="cb2046-9"><a href="intermediate-regression.html#cb2046-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data, <span class="at">color =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-734-1.png" width="672" /></p>
</div>
<div id="including-an-interaction" class="section level4 hasAnchor" number="15.3.1.3">
<h4><span class="header-section-number">15.3.1.3</span> Including an interaction<a href="intermediate-regression.html#including-an-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here you’ll run and predict the same model as in the previous exercise, but this time including an interaction between the explanatory variables.</p>
<div class="sourceCode" id="cb2047"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2047-1"><a href="intermediate-regression.html#cb2047-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear regression of price vs. no. of conv. stores and sqrt dist. to nearest MRT, with interaction</span></span>
<span id="cb2047-2"><a href="intermediate-regression.html#cb2047-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv_dist <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience <span class="sc">*</span> <span class="fu">sqrt</span>(dist_to_mrt_m), taiwan_real_estate)</span>
<span id="cb2047-3"><a href="intermediate-regression.html#cb2047-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2047-4"><a href="intermediate-regression.html#cb2047-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2047-5"><a href="intermediate-regression.html#cb2047-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_conv_dist</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience * sqrt(dist_to_mrt_m), 
##     data = taiwan_real_estate)
## 
## Coefficients:
##                       (Intercept)                      n_convenience  
##                           14.7373                             0.4243  
##               sqrt(dist_to_mrt_m)  n_convenience:sqrt(dist_to_mrt_m)  
##                           -0.1412                            -0.0112</code></pre>
<div class="sourceCode" id="cb2049"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2049-1"><a href="intermediate-regression.html#cb2049-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create expanded grid of explanatory variables with no. of conv. stores and  dist. to nearest MRT</span></span>
<span id="cb2049-2"><a href="intermediate-regression.html#cb2049-2" aria-hidden="true" tabindex="-1"></a>explanatory_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb2049-3"><a href="intermediate-regression.html#cb2049-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_convenience =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb2049-4"><a href="intermediate-regression.html#cb2049-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_to_mrt_m =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2049-5"><a href="intermediate-regression.html#cb2049-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2049-6"><a href="intermediate-regression.html#cb2049-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2049-7"><a href="intermediate-regression.html#cb2049-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2049-8"><a href="intermediate-regression.html#cb2049-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions using mdl_price_vs_conv_dist and explanatory_data</span></span>
<span id="cb2049-9"><a href="intermediate-regression.html#cb2049-9" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span></span>
<span id="cb2049-10"><a href="intermediate-regression.html#cb2049-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_price_vs_conv_dist, explanatory_data))</span>
<span id="cb2049-11"><a href="intermediate-regression.html#cb2049-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2049-12"><a href="intermediate-regression.html#cb2049-12" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2049-13"><a href="intermediate-regression.html#cb2049-13" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 99 × 3
##    n_convenience dist_to_mrt_m price_twd_msq
##            &lt;int&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1             0             0         14.7 
##  2             0           100         13.3 
##  3             0           400         11.9 
##  4             0           900         10.5 
##  5             0          1600          9.09
##  6             0          2500          7.68
##  7             0          3600          6.26
##  8             0          4900          4.85
##  9             0          6400          3.44
## 10             1             0         15.2 
## # ℹ 89 more rows</code></pre>
<div class="sourceCode" id="cb2051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2051-1"><a href="intermediate-regression.html#cb2051-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to plot</span></span>
<span id="cb2051-2"><a href="intermediate-regression.html#cb2051-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb2051-3"><a href="intermediate-regression.html#cb2051-3" aria-hidden="true" tabindex="-1"></a>  taiwan_real_estate, </span>
<span id="cb2051-4"><a href="intermediate-regression.html#cb2051-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(n_convenience, <span class="fu">sqrt</span>(dist_to_mrt_m), <span class="at">color =</span> price_twd_msq)</span>
<span id="cb2051-5"><a href="intermediate-regression.html#cb2051-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb2051-6"><a href="intermediate-regression.html#cb2051-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2051-7"><a href="intermediate-regression.html#cb2051-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2051-8"><a href="intermediate-regression.html#cb2051-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add prediction points colored yellow, size 3</span></span>
<span id="cb2051-9"><a href="intermediate-regression.html#cb2051-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data, <span class="at">color =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-737-1.png" width="672" /></p>
</div>
</div>
<div id="more-than-2-ivs" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> More than 2 IVs<a href="intermediate-regression.html#more-than-2-ivs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="visualizing-many-variables" class="section level4 hasAnchor" number="15.3.2.1">
<h4><span class="header-section-number">15.3.2.1</span> Visualizing many variables<a href="intermediate-regression.html#visualizing-many-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In addition to using x and y scales for two numeric variables, you can use color for a third numeric variable, and you can use faceting for categorical variables. And that’s about your limit before the plots become to difficult to interpret.</p>
<p>Here you’ll push the limits of the scatter plot by showing the house price, the distance to the MRT station, the number of nearby convenience stores, and the house age, all together in one plot.</p>
<div class="sourceCode" id="cb2052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2052-1"><a href="intermediate-regression.html#cb2052-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using taiwan_real_estate, no. of conv. stores vs. sqrt of dist. to MRT, colored by plot house price</span></span>
<span id="cb2052-2"><a href="intermediate-regression.html#cb2052-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(taiwan_real_estate, </span>
<span id="cb2052-3"><a href="intermediate-regression.html#cb2052-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="fu">sqrt</span>(dist_to_mrt_m), n_convenience, <span class="at">color =</span> price_twd_msq)) <span class="sc">+</span></span>
<span id="cb2052-4"><a href="intermediate-regression.html#cb2052-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make it a scatter plot</span></span>
<span id="cb2052-5"><a href="intermediate-regression.html#cb2052-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2052-6"><a href="intermediate-regression.html#cb2052-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the continuous viridis plasma color scale</span></span>
<span id="cb2052-7"><a href="intermediate-regression.html#cb2052-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2052-8"><a href="intermediate-regression.html#cb2052-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Facet, wrapped by house age</span></span>
<span id="cb2052-9"><a href="intermediate-regression.html#cb2052-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> house_age_years)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-738-1.png" width="672" /></p>
</div>
<div id="different-levels-of-interaction" class="section level4 hasAnchor" number="15.3.2.2">
<h4><span class="header-section-number">15.3.2.2</span> Different levels of interaction<a href="intermediate-regression.html#different-levels-of-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>No interactions</p>
<ul>
<li><code>response ~ explntry1 + explntry2 + explntry3</code></li>
</ul></li>
<li><p>2-way interactions between pairs of variables</p>
<ul>
<li><p><code>response ~ explntry1 + explntry2 + explntry3 + explntry1:explntry2 + explntry1:explntry3 + explntry2:explntry3</code></p></li>
<li><p>the same as <code>response ~ (explntry1 + explntry2 + explntry3) ^ 2</code></p></li>
</ul></li>
<li><p>3-way interaction between all three variables</p>
<ul>
<li><p><code>response ~ explntry1 + explntry2 + explntry3 + explntry1:explntry2 + explntry1:explntry3 + explntry2:explntry3 + explntry1:explntry2:explntry3</code></p></li>
<li><p>the same as <code>response ~ explntry1 * explntry2 * explntry3</code></p></li>
</ul></li>
</ul>
<p>Don’t include a global intercept, and any interactions.</p>
<div class="sourceCode" id="cb2053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2053-1"><a href="intermediate-regression.html#cb2053-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. no. of conv. stores, sqrt dist. to MRT station &amp; house age, no global intercept, no interactions</span></span>
<span id="cb2053-2"><a href="intermediate-regression.html#cb2053-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_all_no_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience <span class="sc">+</span> <span class="fu">sqrt</span>(dist_to_mrt_m) <span class="sc">+</span> house_age_years <span class="sc">+</span> <span class="dv">0</span>, taiwan_real_estate)</span>
<span id="cb2053-3"><a href="intermediate-regression.html#cb2053-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2053-4"><a href="intermediate-regression.html#cb2053-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2053-5"><a href="intermediate-regression.html#cb2053-5" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_all_no_inter</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience + sqrt(dist_to_mrt_m) + 
##     house_age_years + 0, data = taiwan_real_estate)
## 
## Coefficients:
##           n_convenience      sqrt(dist_to_mrt_m)   house_age_years0 to 15  
##                   0.258                   -0.148                   15.474  
## house_age_years15 to 30  house_age_years30 to 45  
##                  14.130                   13.765</code></pre>
<p>Don’t include a global intercept, but do include 2-way and 3-way interactions between the explanatory variables.</p>
<div class="sourceCode" id="cb2055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2055-1"><a href="intermediate-regression.html#cb2055-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. sqrt dist. to MRT station, no. of conv. stores &amp; house age, no global intercept, 3-way interactions</span></span>
<span id="cb2055-2"><a href="intermediate-regression.html#cb2055-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_all_3_way_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb2055-3"><a href="intermediate-regression.html#cb2055-3" aria-hidden="true" tabindex="-1"></a>    price_twd_msq <span class="sc">~</span> <span class="fu">sqrt</span>(dist_to_mrt_m) <span class="sc">*</span> n_convenience <span class="sc">*</span> house_age_years <span class="sc">+</span> <span class="dv">0</span>,</span>
<span id="cb2055-4"><a href="intermediate-regression.html#cb2055-4" aria-hidden="true" tabindex="-1"></a>    taiwan_real_estate)</span>
<span id="cb2055-5"><a href="intermediate-regression.html#cb2055-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2055-6"><a href="intermediate-regression.html#cb2055-6" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2055-7"><a href="intermediate-regression.html#cb2055-7" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_all_3_way_inter</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ sqrt(dist_to_mrt_m) * n_convenience * 
##     house_age_years + 0, data = taiwan_real_estate)
## 
## Coefficients:
##                                       sqrt(dist_to_mrt_m)  
##                                                  -0.16294  
##                                             n_convenience  
##                                                   0.37498  
##                                    house_age_years0 to 15  
##                                                  16.04685  
##                                   house_age_years15 to 30  
##                                                  13.76007  
##                                   house_age_years30 to 45  
##                                                  12.08877  
##                         sqrt(dist_to_mrt_m):n_convenience  
##                                                  -0.00839  
##               sqrt(dist_to_mrt_m):house_age_years15 to 30  
##                                                   0.03662  
##               sqrt(dist_to_mrt_m):house_age_years30 to 45  
##                                                   0.06128  
##                     n_convenience:house_age_years15 to 30  
##                                                   0.07837  
##                     n_convenience:house_age_years30 to 45  
##                                                   0.06672  
## sqrt(dist_to_mrt_m):n_convenience:house_age_years15 to 30  
##                                                  -0.00382  
## sqrt(dist_to_mrt_m):n_convenience:house_age_years30 to 45  
##                                                   0.00440</code></pre>
<p>Don’t include a global intercept, but do include 2-way (not 3-way) interactions between the explanatory variables.</p>
<div class="sourceCode" id="cb2057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2057-1"><a href="intermediate-regression.html#cb2057-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model price vs. sqrt dist. to MRT station, no. of conv. stores &amp; house age, no global intercept, 2-way interactions</span></span>
<span id="cb2057-2"><a href="intermediate-regression.html#cb2057-2" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_all_2_way_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb2057-3"><a href="intermediate-regression.html#cb2057-3" aria-hidden="true" tabindex="-1"></a>    price_twd_msq <span class="sc">~</span> (<span class="fu">sqrt</span>(dist_to_mrt_m) <span class="sc">+</span> n_convenience <span class="sc">+</span> house_age_years)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">0</span>, </span>
<span id="cb2057-4"><a href="intermediate-regression.html#cb2057-4" aria-hidden="true" tabindex="-1"></a>    taiwan_real_estate)</span>
<span id="cb2057-5"><a href="intermediate-regression.html#cb2057-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2057-6"><a href="intermediate-regression.html#cb2057-6" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2057-7"><a href="intermediate-regression.html#cb2057-7" aria-hidden="true" tabindex="-1"></a>mdl_price_vs_all_2_way_inter</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ (sqrt(dist_to_mrt_m) + n_convenience + 
##     house_age_years)^2 + 0, data = taiwan_real_estate)
## 
## Coefficients:
##                         sqrt(dist_to_mrt_m)  
##                                    -0.16202  
##                               n_convenience  
##                                     0.38491  
##                      house_age_years0 to 15  
##                                    16.02663  
##                     house_age_years15 to 30  
##                                    13.88079  
##                     house_age_years30 to 45  
##                                    11.92690  
##           sqrt(dist_to_mrt_m):n_convenience  
##                                    -0.00896  
## sqrt(dist_to_mrt_m):house_age_years15 to 30  
##                                     0.03160  
## sqrt(dist_to_mrt_m):house_age_years30 to 45  
##                                     0.06820  
##       n_convenience:house_age_years15 to 30  
##                                    -0.00689  
##       n_convenience:house_age_years30 to 45  
##                                     0.14342</code></pre>
</div>
<div id="predicting-1" class="section level4 hasAnchor" number="15.3.2.3">
<h4><span class="header-section-number">15.3.2.3</span> Predicting<a href="intermediate-regression.html#predicting-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb2059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2059-1"><a href="intermediate-regression.html#cb2059-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a grid of explanatory data</span></span>
<span id="cb2059-2"><a href="intermediate-regression.html#cb2059-2" aria-hidden="true" tabindex="-1"></a>explanatory_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb2059-3"><a href="intermediate-regression.html#cb2059-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set dist_to_mrt_m a seq from 0 to 80 by 10s, squared</span></span>
<span id="cb2059-4"><a href="intermediate-regression.html#cb2059-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist_to_mrt_m =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">10</span>) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb2059-5"><a href="intermediate-regression.html#cb2059-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set n_convenience to 0 to 10</span></span>
<span id="cb2059-6"><a href="intermediate-regression.html#cb2059-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_convenience =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb2059-7"><a href="intermediate-regression.html#cb2059-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set house_age_years to the unique values of that variable</span></span>
<span id="cb2059-8"><a href="intermediate-regression.html#cb2059-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">house_age_years =</span> <span class="fu">unique</span>(taiwan_real_estate<span class="sc">$</span>house_age_years)</span>
<span id="cb2059-9"><a href="intermediate-regression.html#cb2059-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2059-10"><a href="intermediate-regression.html#cb2059-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2059-11"><a href="intermediate-regression.html#cb2059-11" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2059-12"><a href="intermediate-regression.html#cb2059-12" aria-hidden="true" tabindex="-1"></a>explanatory_data</span></code></pre></div>
<pre><code>## # A tibble: 297 × 3
##    dist_to_mrt_m n_convenience house_age_years
##            &lt;dbl&gt;         &lt;int&gt; &lt;fct&gt;          
##  1             0             0 30 to 45       
##  2             0             0 15 to 30       
##  3             0             0 0 to 15        
##  4             0             1 30 to 45       
##  5             0             1 15 to 30       
##  6             0             1 0 to 15        
##  7             0             2 30 to 45       
##  8             0             2 15 to 30       
##  9             0             2 0 to 15        
## 10             0             3 30 to 45       
## # ℹ 287 more rows</code></pre>
<div class="sourceCode" id="cb2061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2061-1"><a href="intermediate-regression.html#cb2061-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions to the data frame</span></span>
<span id="cb2061-2"><a href="intermediate-regression.html#cb2061-2" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span></span>
<span id="cb2061-3"><a href="intermediate-regression.html#cb2061-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price_twd_msq =</span> <span class="fu">predict</span>(mdl_price_vs_all_3_way_inter, explanatory_data))</span>
<span id="cb2061-4"><a href="intermediate-regression.html#cb2061-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2061-5"><a href="intermediate-regression.html#cb2061-5" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2061-6"><a href="intermediate-regression.html#cb2061-6" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 297 × 4
##    dist_to_mrt_m n_convenience house_age_years price_twd_msq
##            &lt;dbl&gt;         &lt;int&gt; &lt;fct&gt;                   &lt;dbl&gt;
##  1             0             0 30 to 45                 12.1
##  2             0             0 15 to 30                 13.8
##  3             0             0 0 to 15                  16.0
##  4             0             1 30 to 45                 12.5
##  5             0             1 15 to 30                 14.2
##  6             0             1 0 to 15                  16.4
##  7             0             2 30 to 45                 13.0
##  8             0             2 15 to 30                 14.7
##  9             0             2 0 to 15                  16.8
## 10             0             3 30 to 45                 13.4
## # ℹ 287 more rows</code></pre>
<div class="sourceCode" id="cb2063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2063-1"><a href="intermediate-regression.html#cb2063-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extend the plot</span></span>
<span id="cb2063-2"><a href="intermediate-regression.html#cb2063-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb2063-3"><a href="intermediate-regression.html#cb2063-3" aria-hidden="true" tabindex="-1"></a>  taiwan_real_estate, </span>
<span id="cb2063-4"><a href="intermediate-regression.html#cb2063-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="fu">sqrt</span>(dist_to_mrt_m), n_convenience, <span class="at">color =</span> price_twd_msq)) <span class="sc">+</span></span>
<span id="cb2063-5"><a href="intermediate-regression.html#cb2063-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2063-6"><a href="intermediate-regression.html#cb2063-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2063-7"><a href="intermediate-regression.html#cb2063-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(house_age_years)) <span class="sc">+</span></span>
<span id="cb2063-8"><a href="intermediate-regression.html#cb2063-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points from prediction data, size 3, shape 15</span></span>
<span id="cb2063-9"><a href="intermediate-regression.html#cb2063-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-744-1.png" width="672" /></p>
<p>The plot nicely shows that the house price decreases as the square-root of the distance to the nearest MRT station increases, and increases as the number of nearby convenience stores increases, and is higher for houses under 15 years old.</p>
</div>
</div>
<div id="model-performance" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> Model performance<a href="intermediate-regression.html#model-performance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sum-of-squares" class="section level4 hasAnchor" number="15.3.3.1">
<h4><span class="header-section-number">15.3.3.1</span> Sum of squares<a href="intermediate-regression.html#sum-of-squares" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In order to choose the “best” line to fit the data, regression models need to optimize some metric. For linear regression, this metric is called the sum of squares.</p>
<p>It takes the square of each residual, and add up those squares. So a smaller number is better.</p>
</div>
<div id="linear-regression-algorithm" class="section level4 hasAnchor" number="15.3.3.2">
<h4><span class="header-section-number">15.3.3.2</span> Linear regression algorithm<a href="intermediate-regression.html#linear-regression-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The workflow is</p>
<ol style="list-style-type: decimal">
<li><p>Write a script to calculate the sum of squares.</p></li>
<li><p>Turn this into a function.</p></li>
<li><p>Use R’s general purpose optimization function find the coefficients that minimize this.</p>
<ul>
<li><code>optim(par = c(var1 = int1, var2 = int2...), fn = function)</code></li>
</ul></li>
</ol>
<div class="sourceCode" id="cb2064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2064-1"><a href="intermediate-regression.html#cb2064-1" aria-hidden="true" tabindex="-1"></a>x_actual <span class="ot">&lt;-</span> taiwan_real_estate<span class="sc">$</span>n_convenience</span>
<span id="cb2064-2"><a href="intermediate-regression.html#cb2064-2" aria-hidden="true" tabindex="-1"></a>y_actual <span class="ot">&lt;-</span> taiwan_real_estate<span class="sc">$</span>price_twd_msq</span></code></pre></div>
<p>Calculate the sum of squares.</p>
<div class="sourceCode" id="cb2065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2065-1"><a href="intermediate-regression.html#cb2065-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the intercept to 10</span></span>
<span id="cb2065-2"><a href="intermediate-regression.html#cb2065-2" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2065-3"><a href="intermediate-regression.html#cb2065-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2065-4"><a href="intermediate-regression.html#cb2065-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the slope to 1</span></span>
<span id="cb2065-5"><a href="intermediate-regression.html#cb2065-5" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2065-6"><a href="intermediate-regression.html#cb2065-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2065-7"><a href="intermediate-regression.html#cb2065-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the predicted y values</span></span>
<span id="cb2065-8"><a href="intermediate-regression.html#cb2065-8" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> intercept <span class="sc">+</span> slope <span class="sc">*</span> x_actual</span>
<span id="cb2065-9"><a href="intermediate-regression.html#cb2065-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2065-10"><a href="intermediate-regression.html#cb2065-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the differences between actual and predicted</span></span>
<span id="cb2065-11"><a href="intermediate-regression.html#cb2065-11" aria-hidden="true" tabindex="-1"></a>y_diff <span class="ot">&lt;-</span> y_pred <span class="sc">-</span> y_actual</span>
<span id="cb2065-12"><a href="intermediate-regression.html#cb2065-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2065-13"><a href="intermediate-regression.html#cb2065-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squares</span></span>
<span id="cb2065-14"><a href="intermediate-regression.html#cb2065-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(y_diff <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 7668</code></pre>
<p>Complete the function body.</p>
<div class="sourceCode" id="cb2067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2067-1"><a href="intermediate-regression.html#cb2067-1" aria-hidden="true" tabindex="-1"></a>calc_sum_of_squares <span class="ot">&lt;-</span> <span class="cf">function</span>(coeffs) {</span>
<span id="cb2067-2"><a href="intermediate-regression.html#cb2067-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the intercept coeff</span></span>
<span id="cb2067-3"><a href="intermediate-regression.html#cb2067-3" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> coeffs[<span class="dv">1</span>]</span>
<span id="cb2067-4"><a href="intermediate-regression.html#cb2067-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2067-5"><a href="intermediate-regression.html#cb2067-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the slope coeff</span></span>
<span id="cb2067-6"><a href="intermediate-regression.html#cb2067-6" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> coeffs[<span class="dv">2</span>]</span>
<span id="cb2067-7"><a href="intermediate-regression.html#cb2067-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2067-8"><a href="intermediate-regression.html#cb2067-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the predicted y values</span></span>
<span id="cb2067-9"><a href="intermediate-regression.html#cb2067-9" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> intercept <span class="sc">+</span> slope <span class="sc">*</span> x_actual</span>
<span id="cb2067-10"><a href="intermediate-regression.html#cb2067-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2067-11"><a href="intermediate-regression.html#cb2067-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the differences between actual and predicted</span></span>
<span id="cb2067-12"><a href="intermediate-regression.html#cb2067-12" aria-hidden="true" tabindex="-1"></a>  y_diff <span class="ot">&lt;-</span> y_pred <span class="sc">-</span> y_actual</span>
<span id="cb2067-13"><a href="intermediate-regression.html#cb2067-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2067-14"><a href="intermediate-regression.html#cb2067-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the sum of squares</span></span>
<span id="cb2067-15"><a href="intermediate-regression.html#cb2067-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(y_diff <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb2067-16"><a href="intermediate-regression.html#cb2067-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Optimize the sum of squares metric.</p>
<div class="sourceCode" id="cb2068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2068-1"><a href="intermediate-regression.html#cb2068-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimize the metric</span></span>
<span id="cb2068-2"><a href="intermediate-regression.html#cb2068-2" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(</span>
<span id="cb2068-3"><a href="intermediate-regression.html#cb2068-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initially guess 0 intercept and 0 slope</span></span>
<span id="cb2068-4"><a href="intermediate-regression.html#cb2068-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">c</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>), </span>
<span id="cb2068-5"><a href="intermediate-regression.html#cb2068-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use calc_sum_of_squares as the optimization fn</span></span>
<span id="cb2068-6"><a href="intermediate-regression.html#cb2068-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> calc_sum_of_squares</span>
<span id="cb2068-7"><a href="intermediate-regression.html#cb2068-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $par
## intercept     slope 
##     8.226     0.798 
## 
## $value
## [1] 4718
## 
## $counts
## function gradient 
##       87       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<div class="sourceCode" id="cb2070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2070-1"><a href="intermediate-regression.html#cb2070-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the coefficients to those calculated by lm()</span></span>
<span id="cb2070-2"><a href="intermediate-regression.html#cb2070-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(price_twd_msq <span class="sc">~</span> n_convenience, <span class="at">data =</span> taiwan_real_estate)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ n_convenience, data = taiwan_real_estate)
## 
## Coefficients:
##   (Intercept)  n_convenience  
##         8.224          0.798</code></pre>
<p>The sum of square is 4717.687</p>
</div>
</div>
</div>
<div id="multiple-logistic-regression" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Multiple Logistic Regression<a href="intermediate-regression.html#multiple-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="multiple-logistic-regression-1" class="section level3 hasAnchor" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Multiple Logistic Regression<a href="intermediate-regression.html#multiple-logistic-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="visualizing" class="section level4 hasAnchor" number="15.4.1.1">
<h4><span class="header-section-number">15.4.1.1</span> Visualizing<a href="intermediate-regression.html#visualizing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Use faceting for categorical variables.</p></li>
<li><p>For 2 numeric explanatory variables, use color for response.</p>
<ul>
<li><p>Give responses below <code>0.5</code> one color; responses above <code>0.5</code> another color.</p></li>
<li><p><code>scale_color_gradient2(midpoint = 0.5)</code></p></li>
</ul></li>
</ul>
<p>Here we’ll look at the case of two numeric explanatory variables, and the solution is basically the same as before: use color to denote the response.</p>
<div class="sourceCode" id="cb2072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2072-1"><a href="intermediate-regression.html#cb2072-1" aria-hidden="true" tabindex="-1"></a>churn <span class="ot">&lt;-</span> <span class="fu">read_fst</span>(<span class="st">&quot;data/churn.fst&quot;</span>)</span>
<span id="cb2072-2"><a href="intermediate-regression.html#cb2072-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2072-3"><a href="intermediate-regression.html#cb2072-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using churn, plot recency vs. length of relationship colored by churn status</span></span>
<span id="cb2072-4"><a href="intermediate-regression.html#cb2072-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, </span>
<span id="cb2072-5"><a href="intermediate-regression.html#cb2072-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_since_first_purchase, time_since_last_purchase, </span>
<span id="cb2072-6"><a href="intermediate-regression.html#cb2072-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> has_churned)) <span class="sc">+</span></span>
<span id="cb2072-7"><a href="intermediate-regression.html#cb2072-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make it a scatter plot, with transparency 0.5</span></span>
<span id="cb2072-8"><a href="intermediate-regression.html#cb2072-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2072-9"><a href="intermediate-regression.html#cb2072-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use a 2-color gradient split at 0.5</span></span>
<span id="cb2072-10"><a href="intermediate-regression.html#cb2072-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">midpoint =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2072-11"><a href="intermediate-regression.html#cb2072-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the black and white theme</span></span>
<span id="cb2072-12"><a href="intermediate-regression.html#cb2072-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-749-1.png" width="672" /></p>
<p>The 2-color gradient is excellent for distinguishing the two cases of a positive and negative response.</p>
</div>
<div id="with-2-ivs" class="section level4 hasAnchor" number="15.4.1.2">
<h4><span class="header-section-number">15.4.1.2</span> With 2 IVs<a href="intermediate-regression.html#with-2-ivs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>With interaction:</p>
<p><code>glm(response ~ explanatory1 * explanatory2, data = dataset, family = binomial)</code></p>
<p>Here you’ll fit a model of churn status with both of the explanatory variables from the dataset: the length of customer relationship and the recency of purchase.</p>
<div class="sourceCode" id="cb2073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2073-1"><a href="intermediate-regression.html#cb2073-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a logistic regression of churn status vs. length of relationship, recency, and an interaction</span></span>
<span id="cb2073-2"><a href="intermediate-regression.html#cb2073-2" aria-hidden="true" tabindex="-1"></a>mdl_churn_vs_both_inter <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb2073-3"><a href="intermediate-regression.html#cb2073-3" aria-hidden="true" tabindex="-1"></a>    has_churned <span class="sc">~</span> time_since_first_purchase <span class="sc">*</span> time_since_last_purchase, </span>
<span id="cb2073-4"><a href="intermediate-regression.html#cb2073-4" aria-hidden="true" tabindex="-1"></a>    churn, </span>
<span id="cb2073-5"><a href="intermediate-regression.html#cb2073-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb2073-6"><a href="intermediate-regression.html#cb2073-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2073-7"><a href="intermediate-regression.html#cb2073-7" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2073-8"><a href="intermediate-regression.html#cb2073-8" aria-hidden="true" tabindex="-1"></a>mdl_churn_vs_both_inter</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = has_churned ~ time_since_first_purchase * time_since_last_purchase, 
##     family = &quot;binomial&quot;, data = churn)
## 
## Coefficients:
##                                        (Intercept)  
##                                             -0.151  
##                          time_since_first_purchase  
##                                             -0.638  
##                           time_since_last_purchase  
##                                              0.423  
## time_since_first_purchase:time_since_last_purchase  
##                                              0.112  
## 
## Degrees of Freedom: 399 Total (i.e. Null);  396 Residual
## Null Deviance:       555 
## Residual Deviance: 520   AIC: 528</code></pre>
</div>
<div id="predicting-2" class="section level4 hasAnchor" number="15.4.1.3">
<h4><span class="header-section-number">15.4.1.3</span> Predicting<a href="intermediate-regression.html#predicting-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The only thing to remember here is to set the prediction type to <code>"response"</code>.</p>
<div class="sourceCode" id="cb2075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2075-1"><a href="intermediate-regression.html#cb2075-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a grid of explanatory data</span></span>
<span id="cb2075-2"><a href="intermediate-regression.html#cb2075-2" aria-hidden="true" tabindex="-1"></a>explanatory_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb2075-3"><a href="intermediate-regression.html#cb2075-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set len. relationship to seq from -2 to 4 in steps of 0.1</span></span>
<span id="cb2075-4"><a href="intermediate-regression.html#cb2075-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_since_first_purchase =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="fl">0.1</span>),</span>
<span id="cb2075-5"><a href="intermediate-regression.html#cb2075-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set recency to seq from -1 to 6 in steps of 0.1</span></span>
<span id="cb2075-6"><a href="intermediate-regression.html#cb2075-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_since_last_purchase =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="fl">0.1</span>)</span>
<span id="cb2075-7"><a href="intermediate-regression.html#cb2075-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2075-8"><a href="intermediate-regression.html#cb2075-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2075-9"><a href="intermediate-regression.html#cb2075-9" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2075-10"><a href="intermediate-regression.html#cb2075-10" aria-hidden="true" tabindex="-1"></a>explanatory_data</span></code></pre></div>
<pre><code>## # A tibble: 4,331 × 2
##    time_since_first_purchase time_since_last_purchase
##                        &lt;dbl&gt;                    &lt;dbl&gt;
##  1                        -2                     -1  
##  2                        -2                     -0.9
##  3                        -2                     -0.8
##  4                        -2                     -0.7
##  5                        -2                     -0.6
##  6                        -2                     -0.5
##  7                        -2                     -0.4
##  8                        -2                     -0.3
##  9                        -2                     -0.2
## 10                        -2                     -0.1
## # ℹ 4,321 more rows</code></pre>
<div class="sourceCode" id="cb2077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2077-1"><a href="intermediate-regression.html#cb2077-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column of predictions using mdl_churn_vs_both_inter and explanatory_data with type response</span></span>
<span id="cb2077-2"><a href="intermediate-regression.html#cb2077-2" aria-hidden="true" tabindex="-1"></a>prediction_data <span class="ot">&lt;-</span> explanatory_data <span class="sc">%&gt;%</span></span>
<span id="cb2077-3"><a href="intermediate-regression.html#cb2077-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">has_churned =</span> <span class="fu">predict</span>(mdl_churn_vs_both_inter, </span>
<span id="cb2077-4"><a href="intermediate-regression.html#cb2077-4" aria-hidden="true" tabindex="-1"></a>                               explanatory_data, </span>
<span id="cb2077-5"><a href="intermediate-regression.html#cb2077-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb2077-6"><a href="intermediate-regression.html#cb2077-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2077-7"><a href="intermediate-regression.html#cb2077-7" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2077-8"><a href="intermediate-regression.html#cb2077-8" aria-hidden="true" tabindex="-1"></a>prediction_data</span></code></pre></div>
<pre><code>## # A tibble: 4,331 × 3
##    time_since_first_purchase time_since_last_purchase has_churned
##                        &lt;dbl&gt;                    &lt;dbl&gt;       &lt;dbl&gt;
##  1                        -2                     -1         0.716
##  2                        -2                     -0.9       0.720
##  3                        -2                     -0.8       0.724
##  4                        -2                     -0.7       0.728
##  5                        -2                     -0.6       0.732
##  6                        -2                     -0.5       0.736
##  7                        -2                     -0.4       0.740
##  8                        -2                     -0.3       0.744
##  9                        -2                     -0.2       0.747
## 10                        -2                     -0.1       0.751
## # ℹ 4,321 more rows</code></pre>
<div class="sourceCode" id="cb2079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2079-1"><a href="intermediate-regression.html#cb2079-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extend the plot</span></span>
<span id="cb2079-2"><a href="intermediate-regression.html#cb2079-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(churn, </span>
<span id="cb2079-3"><a href="intermediate-regression.html#cb2079-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_since_first_purchase, </span>
<span id="cb2079-4"><a href="intermediate-regression.html#cb2079-4" aria-hidden="true" tabindex="-1"></a>           time_since_last_purchase, </span>
<span id="cb2079-5"><a href="intermediate-regression.html#cb2079-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> has_churned)) <span class="sc">+</span></span>
<span id="cb2079-6"><a href="intermediate-regression.html#cb2079-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2079-7"><a href="intermediate-regression.html#cb2079-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">midpoint =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2079-8"><a href="intermediate-regression.html#cb2079-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2079-9"><a href="intermediate-regression.html#cb2079-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points from prediction_data with size 3 and shape 15</span></span>
<span id="cb2079-10"><a href="intermediate-regression.html#cb2079-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_data, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-753-1.png" width="672" /></p>
</div>
<div id="confusion-matrix" class="section level4 hasAnchor" number="15.4.1.4">
<h4><span class="header-section-number">15.4.1.4</span> Confusion matrix<a href="intermediate-regression.html#confusion-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Generating a confusion matrix and calculating metrics like accuracy, sensitivity, and specificity is the standard way to measure how well a logistic model fits.</p>
<p>Get the predicted responses from the <em>rounded</em>, <em>fitted</em> values of <code>mdl_churn_vs_both_inter</code>.</p>
<div class="sourceCode" id="cb2080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2080-1"><a href="intermediate-regression.html#cb2080-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span></code></pre></div>
<pre><code>## Warning: package &#39;yardstick&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb2082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2082-1"><a href="intermediate-regression.html#cb2082-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the actual responses from churn</span></span>
<span id="cb2082-2"><a href="intermediate-regression.html#cb2082-2" aria-hidden="true" tabindex="-1"></a>actual_response <span class="ot">&lt;-</span> churn<span class="sc">$</span>has_churned</span>
<span id="cb2082-3"><a href="intermediate-regression.html#cb2082-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2082-4"><a href="intermediate-regression.html#cb2082-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the predicted responses from the model</span></span>
<span id="cb2082-5"><a href="intermediate-regression.html#cb2082-5" aria-hidden="true" tabindex="-1"></a>predicted_response <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">fitted</span>(mdl_churn_vs_both_inter))</span>
<span id="cb2082-6"><a href="intermediate-regression.html#cb2082-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2082-7"><a href="intermediate-regression.html#cb2082-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a table of these values</span></span>
<span id="cb2082-8"><a href="intermediate-regression.html#cb2082-8" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">table</span>(predicted_response, actual_response)</span>
<span id="cb2082-9"><a href="intermediate-regression.html#cb2082-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2082-10"><a href="intermediate-regression.html#cb2082-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a conf_mat object</span></span>
<span id="cb2082-11"><a href="intermediate-regression.html#cb2082-11" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(outcomes)</span>
<span id="cb2082-12"><a href="intermediate-regression.html#cb2082-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2082-13"><a href="intermediate-regression.html#cb2082-13" aria-hidden="true" tabindex="-1"></a><span class="co"># See the result</span></span>
<span id="cb2082-14"><a href="intermediate-regression.html#cb2082-14" aria-hidden="true" tabindex="-1"></a>confusion</span></code></pre></div>
<pre><code>##                   actual_response
## predicted_response   0   1
##                  0 102  53
##                  1  98 147</code></pre>
<p>Remember that the churn event is in the second row/column of the matrix.</p>
<div class="sourceCode" id="cb2084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2084-1"><a href="intermediate-regression.html#cb2084-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;Automatically&quot; plot the confusion matrix</span></span>
<span id="cb2084-2"><a href="intermediate-regression.html#cb2084-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(confusion)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-755-1.png" width="672" /></p>
<div class="sourceCode" id="cb2085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2085-1"><a href="intermediate-regression.html#cb2085-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get summary metrics</span></span>
<span id="cb2085-2"><a href="intermediate-regression.html#cb2085-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(confusion, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 13 × 3
##    .metric              .estimator .estimate
##    &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;
##  1 accuracy             binary         0.622
##  2 kap                  binary         0.245
##  3 sens                 binary         0.735
##  4 spec                 binary         0.51 
##  5 ppv                  binary         0.6  
##  6 npv                  binary         0.658
##  7 mcc                  binary         0.251
##  8 j_index              binary         0.245
##  9 bal_accuracy         binary         0.622
## 10 detection_prevalence binary         0.612
## 11 precision            binary         0.6  
## 12 recall               binary         0.735
## 13 f_meas               binary         0.661</code></pre>
</div>
</div>
<div id="logistic-distribution" class="section level3 hasAnchor" number="15.4.2">
<h3><span class="header-section-number">15.4.2</span> Logistic distribution<a href="intermediate-regression.html#logistic-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Distribution function names</strong></p>
<table>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th>curve</th>
<th>prefix</th>
<th>normal</th>
<th>logistic</th>
<th>nmemonic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Probability density function (PDF)</td>
<td>d</td>
<td><code>dnorm()</code></td>
<td><code>dlogis()</code></td>
<td>“d” for differentiate - you differentiate the CDF to get the PDF</td>
</tr>
<tr class="even">
<td>Cumulative distribution function (CDF)</td>
<td>p</td>
<td><code>pnorm()</code></td>
<td><code>plogis()</code></td>
<td>“p” is backwards “q” so it’s the inverse of the inverse CDF</td>
</tr>
<tr class="odd">
<td>Inverse CDF</td>
<td>q</td>
<td><code>qnorm()</code></td>
<td><code>qlogis()</code></td>
<td>“q” for quantile</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><code>family = gaussian</code></td>
<td><code>family = binomial</code></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div id="cdf-inverse-cdf" class="section level4 hasAnchor" number="15.4.2.1">
<h4><span class="header-section-number">15.4.2.1</span> CDF &amp; Inverse CDF<a href="intermediate-regression.html#cdf-inverse-cdf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Logistic distribution CDF is also called the <strong>logistic function</strong>.</p>
<ul>
<li><p><span class="math inline">\(cdf(x) = 1 / (1 + exp(-x))\)</span></p></li>
<li><p>The plot of this has an <em>S-shape</em>, known as a <u><em>sigmoid curve</em></u>.</p></li>
<li><p>This function takes an input that can be any number from minus infinity to infinity, and returns a value between zero and one.</p></li>
<li><p>Each x input value is transformed to a unique value. That means that the transformation can be reversed.</p></li>
</ul></li>
<li><p>Logistic distribution inverse CDF is also called the <strong>logit function</strong>.</p>
<ul>
<li><span class="math inline">\(inverse\_cdf(p) = log(p / (1 - p))\)</span></li>
</ul></li>
</ul>
<p><strong>Cumulative distribution function</strong></p>
<p>Like the normal (Gaussian) distribution, it is a probability distribution of a single continuous variable. Here you’ll visualize the cumulative distribution function (CDF) for the logistic distribution.</p>
<div class="sourceCode" id="cb2087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2087-1"><a href="intermediate-regression.html#cb2087-1" aria-hidden="true" tabindex="-1"></a>logistic_distn_cdf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2087-2"><a href="intermediate-regression.html#cb2087-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a seq from -10 to 10 in steps of 0.1</span></span>
<span id="cb2087-3"><a href="intermediate-regression.html#cb2087-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>),</span>
<span id="cb2087-4"><a href="intermediate-regression.html#cb2087-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform x with built-in logistic CDF</span></span>
<span id="cb2087-5"><a href="intermediate-regression.html#cb2087-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">logistic_x =</span> <span class="fu">plogis</span>(x),</span>
<span id="cb2087-6"><a href="intermediate-regression.html#cb2087-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform x with manual logistic</span></span>
<span id="cb2087-7"><a href="intermediate-regression.html#cb2087-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">logistic_x_man =</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb2087-8"><a href="intermediate-regression.html#cb2087-8" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb2087-9"><a href="intermediate-regression.html#cb2087-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2087-10"><a href="intermediate-regression.html#cb2087-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that each logistic function gives the same results</span></span>
<span id="cb2087-11"><a href="intermediate-regression.html#cb2087-11" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(</span>
<span id="cb2087-12"><a href="intermediate-regression.html#cb2087-12" aria-hidden="true" tabindex="-1"></a>  logistic_distn_cdf<span class="sc">$</span>logistic_x, </span>
<span id="cb2087-13"><a href="intermediate-regression.html#cb2087-13" aria-hidden="true" tabindex="-1"></a>  logistic_distn_cdf<span class="sc">$</span>logistic_x_man</span>
<span id="cb2087-14"><a href="intermediate-regression.html#cb2087-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The logistic distribution’s cumulative distribution function is a sigmoid curve.</p>
<div class="sourceCode" id="cb2089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2089-1"><a href="intermediate-regression.html#cb2089-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using logistic_distn_cdf, plot logistic_x vs. x</span></span>
<span id="cb2089-2"><a href="intermediate-regression.html#cb2089-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(logistic_distn_cdf, <span class="fu">aes</span>(x, logistic_x)) <span class="sc">+</span></span>
<span id="cb2089-3"><a href="intermediate-regression.html#cb2089-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make it a line plot</span></span>
<span id="cb2089-4"><a href="intermediate-regression.html#cb2089-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-757-1.png" width="672" /></p>
<p><strong>Inverse cumulative distribution function</strong></p>
<div class="sourceCode" id="cb2090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2090-1"><a href="intermediate-regression.html#cb2090-1" aria-hidden="true" tabindex="-1"></a>logistic_distn_inv_cdf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2090-2"><a href="intermediate-regression.html#cb2090-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a seq from 0.001 to 0.999 in steps of 0.001</span></span>
<span id="cb2090-3"><a href="intermediate-regression.html#cb2090-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.999</span>, <span class="fl">0.001</span>),</span>
<span id="cb2090-4"><a href="intermediate-regression.html#cb2090-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform with built-in logistic inverse CDF</span></span>
<span id="cb2090-5"><a href="intermediate-regression.html#cb2090-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">logit_p =</span> <span class="fu">qlogis</span>(p),</span>
<span id="cb2090-6"><a href="intermediate-regression.html#cb2090-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform with manual logit</span></span>
<span id="cb2090-7"><a href="intermediate-regression.html#cb2090-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">logit_p_man =</span> <span class="fu">log</span>(p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb2090-8"><a href="intermediate-regression.html#cb2090-8" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb2090-9"><a href="intermediate-regression.html#cb2090-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2090-10"><a href="intermediate-regression.html#cb2090-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that each logistic function gives the same results</span></span>
<span id="cb2090-11"><a href="intermediate-regression.html#cb2090-11" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(</span>
<span id="cb2090-12"><a href="intermediate-regression.html#cb2090-12" aria-hidden="true" tabindex="-1"></a>  logistic_distn_inv_cdf<span class="sc">$</span>logit_p,</span>
<span id="cb2090-13"><a href="intermediate-regression.html#cb2090-13" aria-hidden="true" tabindex="-1"></a>  logistic_distn_inv_cdf<span class="sc">$</span>logit_p_man</span>
<span id="cb2090-14"><a href="intermediate-regression.html#cb2090-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb2092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2092-1"><a href="intermediate-regression.html#cb2092-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using logistic_distn_inv_cdf, plot logit_p vs. p</span></span>
<span id="cb2092-2"><a href="intermediate-regression.html#cb2092-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(logistic_distn_inv_cdf, <span class="fu">aes</span>(p, logit_p)) <span class="sc">+</span></span>
<span id="cb2092-3"><a href="intermediate-regression.html#cb2092-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make it a line plot</span></span>
<span id="cb2092-4"><a href="intermediate-regression.html#cb2092-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-759-1.png" width="672" /></p>
<p>The inverse CDF is the “opposite” transformation to the CDF. If you flip the x and y axes on this plot, you get the same plot you saw in the previous exercise.</p>
</div>
<div id="binomial-family-argument" class="section level4 hasAnchor" number="15.4.2.2">
<h4><span class="header-section-number">15.4.2.2</span> binomial family argument<a href="intermediate-regression.html#binomial-family-argument" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>binomial()</code> is a function that returns a list of other functions that tell <code>glm()</code> how to perform calculations in the regression.</p>
<p>The two most interesting functions are <code>linkinv</code> and <code>linkfun</code>, which are used for transforming variables from the whole number line (minus infinity to infinity) to probabilities (zero to one) and back again. (Link function is a transformation of the response variable)</p>
<div class="sourceCode" id="cb2093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2093-1"><a href="intermediate-regression.html#cb2093-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.2</span>)</span>
<span id="cb2093-2"><a href="intermediate-regression.html#cb2093-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>)</span>
<span id="cb2093-3"><a href="intermediate-regression.html#cb2093-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2093-4"><a href="intermediate-regression.html#cb2093-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the structure of binomial() function</span></span>
<span id="cb2093-5"><a href="intermediate-regression.html#cb2093-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">binomial</span>())</span></code></pre></div>
<pre><code>## List of 13
##  $ family    : chr &quot;binomial&quot;
##  $ link      : chr &quot;logit&quot;
##  $ linkfun   :function (mu)  
##  $ linkinv   :function (eta)  
##  $ variance  :function (mu)  
##  $ dev.resids:function (y, mu, wt)  
##  $ aic       :function (y, n, mu, wt, dev)  
##  $ mu.eta    :function (eta)  
##  $ initialize: language {     if (NCOL(y) == 1) { ...
##  $ validmu   :function (mu)  
##  $ valideta  :function (eta)  
##  $ simulate  :function (object, nsim)  
##  $ dispersion: num 1
##  - attr(*, &quot;class&quot;)= chr &quot;family&quot;</code></pre>
<p><em>Notice that it contains two elements that are functions,</em> <code>binomial()$linkinv</code><em>, and</em> <code>binomial()$linkfun</code>.</p>
<p><code>binomial()$linkinv</code> = logistic distribution CDF, <code>plogis()</code></p>
<div class="sourceCode" id="cb2095"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2095-1"><a href="intermediate-regression.html#cb2095-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the link inverse on x</span></span>
<span id="cb2095-2"><a href="intermediate-regression.html#cb2095-2" aria-hidden="true" tabindex="-1"></a>linkinv_x <span class="ot">&lt;-</span> <span class="fu">binomial</span>()<span class="sc">$</span><span class="fu">linkinv</span>(x)</span>
<span id="cb2095-3"><a href="intermediate-regression.html#cb2095-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2095-4"><a href="intermediate-regression.html#cb2095-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check linkinv_x and plogis() of x give same results </span></span>
<span id="cb2095-5"><a href="intermediate-regression.html#cb2095-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(linkinv_x, <span class="fu">plogis</span>(x))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><code>binomial()$linkfun</code> = inverse CDF, <code>qlogis()</code></p>
<div class="sourceCode" id="cb2097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2097-1"><a href="intermediate-regression.html#cb2097-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the link fun on p</span></span>
<span id="cb2097-2"><a href="intermediate-regression.html#cb2097-2" aria-hidden="true" tabindex="-1"></a>linkfun_p <span class="ot">&lt;-</span> <span class="fu">binomial</span>()<span class="sc">$</span><span class="fu">linkfun</span>(p)</span>
<span id="cb2097-3"><a href="intermediate-regression.html#cb2097-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2097-4"><a href="intermediate-regression.html#cb2097-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check linkfun_p and qlogis() of p give same results  </span></span>
<span id="cb2097-5"><a href="intermediate-regression.html#cb2097-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(linkfun_p, <span class="fu">qlogis</span>(p))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>These are used to translate between numbers and probabilities.</p>
</div>
<div id="logistic-distribution-parameters" class="section level4 hasAnchor" number="15.4.2.3">
<h4><span class="header-section-number">15.4.2.3</span> Logistic distribution parameters<a href="intermediate-regression.html#logistic-distribution-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The normal distribution has mean and standard deviation parameters that affect the CDF curve. The logistic distribution has <em>location</em> and <em>scale</em> parameters.</p>
<p>These two parameters allows logistic model prediction curves to have different positions or steepnesses.</p>
<ul>
<li><p>location increases — logistic CDF curve moves rightwards</p></li>
<li><p>scale increases — the steepness of the slope deceases</p></li>
</ul>
</div>
</div>
<div id="model-performance-1" class="section level3 hasAnchor" number="15.4.3">
<h3><span class="header-section-number">15.4.3</span> Model performance<a href="intermediate-regression.html#model-performance-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Likelihood</strong></p>
<p><code>sum(y_pred * y_actual + (1 - y_pred) * (1 - y_actual))</code></p>
<ul>
<li><p>When <code>y_actual = 1</code></p>
<ul>
<li><code>y_pred * 1 + (1 - y_pred) * (1 - 1) = y_pred</code></li>
</ul></li>
<li><p>When <code>y_actual = 0</code></p>
<ul>
<li><code>y_pred * 0 + (1 - y_pred) * (1 - 0) = 1 - y_pred</code></li>
</ul></li>
</ul>
<p><strong>Log-likelihood</strong></p>
<ul>
<li><p>Computing likelihood involves adding many very small numbers, leading to numerical error.</p></li>
<li><p>Log-likelihood is easier to compute.</p></li>
<li><p><code>log(y_pred) * y_actual + log(1 - y_pred) * (1 - y_actual)</code></p></li>
</ul>
<p><strong>Negative log-likelihood</strong></p>
<ul>
<li><p>Maximizing log-likelihood is the same as minimizing negative log-likelihood.</p></li>
<li><p><code>-sum(log_likelihoods)</code></p></li>
</ul>
<div id="likelihood-log-likelihood" class="section level4 hasAnchor" number="15.4.3.1">
<h4><span class="header-section-number">15.4.3.1</span> Likelihood &amp; log-likelihood<a href="intermediate-regression.html#likelihood-log-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Logistic regression chooses the prediction line that gives you the maximum likelihood value. It also gives maximum log-likelihood.</p>
</div>
<div id="logistic-regression-algorithm" class="section level4 hasAnchor" number="15.4.3.2">
<h4><span class="header-section-number">15.4.3.2</span> Logistic regression algorithm<a href="intermediate-regression.html#logistic-regression-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Rather than using sum of squares as the metric, we want to use likelihood. However, log-likelihood is more computationally stable, so we’ll use that instead.</p>
<p>Actually, there is one more change: since we want to maximize log-likelihood, but <code>optim()</code> defaults to finding minimum values, it is easier to calculate the negative log-likelihood.</p>
<p>Calculate the predicted y-values as the intercept plus the slope times the actual x-values, all transformed with the logistic distribution CDF.</p>
<div class="sourceCode" id="cb2099"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2099-1"><a href="intermediate-regression.html#cb2099-1" aria-hidden="true" tabindex="-1"></a>x_actual <span class="ot">&lt;-</span> churn<span class="sc">$</span>time_since_last_purchase</span>
<span id="cb2099-2"><a href="intermediate-regression.html#cb2099-2" aria-hidden="true" tabindex="-1"></a>y_actual <span class="ot">&lt;-</span> churn<span class="sc">$</span>has_churned</span>
<span id="cb2099-3"><a href="intermediate-regression.html#cb2099-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2099-4"><a href="intermediate-regression.html#cb2099-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the intercept to 1</span></span>
<span id="cb2099-5"><a href="intermediate-regression.html#cb2099-5" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2099-6"><a href="intermediate-regression.html#cb2099-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2099-7"><a href="intermediate-regression.html#cb2099-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the slope to 0.5</span></span>
<span id="cb2099-8"><a href="intermediate-regression.html#cb2099-8" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2099-9"><a href="intermediate-regression.html#cb2099-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2099-10"><a href="intermediate-regression.html#cb2099-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the predicted y values</span></span>
<span id="cb2099-11"><a href="intermediate-regression.html#cb2099-11" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">plogis</span>(intercept <span class="sc">+</span> slope <span class="sc">*</span> x_actual)</span>
<span id="cb2099-12"><a href="intermediate-regression.html#cb2099-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2099-13"><a href="intermediate-regression.html#cb2099-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the log-likelihood for each term</span></span>
<span id="cb2099-14"><a href="intermediate-regression.html#cb2099-14" aria-hidden="true" tabindex="-1"></a>log_likelihoods <span class="ot">&lt;-</span> <span class="fu">log</span>(y_pred) <span class="sc">*</span> y_actual <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> y_pred) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y_actual)</span>
<span id="cb2099-15"><a href="intermediate-regression.html#cb2099-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2099-16"><a href="intermediate-regression.html#cb2099-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate minus the sum of the log-likelihoods for each term</span></span>
<span id="cb2099-17"><a href="intermediate-regression.html#cb2099-17" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fu">sum</span>(log_likelihoods)</span></code></pre></div>
<pre><code>## [1] 326</code></pre>
<p>Complete the function body.</p>
<div class="sourceCode" id="cb2101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2101-1"><a href="intermediate-regression.html#cb2101-1" aria-hidden="true" tabindex="-1"></a>calc_neg_log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(coeffs) {</span>
<span id="cb2101-2"><a href="intermediate-regression.html#cb2101-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the intercept coeff</span></span>
<span id="cb2101-3"><a href="intermediate-regression.html#cb2101-3" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> coeffs[<span class="dv">1</span>]</span>
<span id="cb2101-4"><a href="intermediate-regression.html#cb2101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2101-5"><a href="intermediate-regression.html#cb2101-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the slope coeff</span></span>
<span id="cb2101-6"><a href="intermediate-regression.html#cb2101-6" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> coeffs[<span class="dv">2</span>]</span>
<span id="cb2101-7"><a href="intermediate-regression.html#cb2101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2101-8"><a href="intermediate-regression.html#cb2101-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the predicted y values</span></span>
<span id="cb2101-9"><a href="intermediate-regression.html#cb2101-9" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> <span class="fu">plogis</span>(intercept <span class="sc">+</span> slope <span class="sc">*</span> x_actual)</span>
<span id="cb2101-10"><a href="intermediate-regression.html#cb2101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2101-11"><a href="intermediate-regression.html#cb2101-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the log-likelihood for each term</span></span>
<span id="cb2101-12"><a href="intermediate-regression.html#cb2101-12" aria-hidden="true" tabindex="-1"></a>  log_likelihoods <span class="ot">&lt;-</span> <span class="fu">log</span>(y_pred) <span class="sc">*</span> y_actual <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> y_pred) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y_actual)</span>
<span id="cb2101-13"><a href="intermediate-regression.html#cb2101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2101-14"><a href="intermediate-regression.html#cb2101-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate minus the sum of the log-likelihoods for each term</span></span>
<span id="cb2101-15"><a href="intermediate-regression.html#cb2101-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(log_likelihoods)</span>
<span id="cb2101-16"><a href="intermediate-regression.html#cb2101-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Optimize the maximize log-likelihood metric.</p>
<div class="sourceCode" id="cb2102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2102-1"><a href="intermediate-regression.html#cb2102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimize the metric</span></span>
<span id="cb2102-2"><a href="intermediate-regression.html#cb2102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(</span>
<span id="cb2102-3"><a href="intermediate-regression.html#cb2102-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initially guess 0 intercept and 1 slope</span></span>
<span id="cb2102-4"><a href="intermediate-regression.html#cb2102-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">c</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>),</span>
<span id="cb2102-5"><a href="intermediate-regression.html#cb2102-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use calc_neg_log_likelihood as the optimization fn </span></span>
<span id="cb2102-6"><a href="intermediate-regression.html#cb2102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> calc_neg_log_likelihood</span>
<span id="cb2102-7"><a href="intermediate-regression.html#cb2102-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $par
## intercept     slope 
##   -0.0348    0.2689 
## 
## $value
## [1] 273
## 
## $counts
## function gradient 
##       51       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<div class="sourceCode" id="cb2104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2104-1"><a href="intermediate-regression.html#cb2104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the coefficients to those calculated by glm()</span></span>
<span id="cb2104-2"><a href="intermediate-regression.html#cb2104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(has_churned <span class="sc">~</span> time_since_last_purchase, <span class="at">data =</span> churn, <span class="at">family =</span> binomial)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = has_churned ~ time_since_last_purchase, family = binomial, 
##     data = churn)
## 
## Coefficients:
##              (Intercept)  time_since_last_purchase  
##                   -0.035                     0.269  
## 
## Degrees of Freedom: 399 Total (i.e. Null);  398 Residual
## Null Deviance:       555 
## Residual Deviance: 546   AIC: 550</code></pre>
<p>The maximize log-likelihood is 273.2002</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sampling-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "github"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/15-Intermediate-Regression-in-R.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
